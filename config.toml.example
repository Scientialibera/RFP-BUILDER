# RFP Builder Configuration
# Copy this file to config.toml and fill in your values

[azure]
# Azure OpenAI endpoint - if provided, uses Azure DefaultAzureCredential for auth
endpoint = "https://your-resource.openai.azure.com/"
model = "gpt-4o"
# Optional: deployment name if different from model
deployment = ""
# API version for Azure OpenAI
api_version = "2024-02-15-preview"

[openai]
# Alternative: Direct OpenAI API (used if azure.endpoint is empty)
api_key = ""
model = "gpt-4o"
# Base URL override for OpenAI-compatible endpoints
base_url = ""

[app]
# Application settings
debug = false
host = "0.0.0.0"
port = 8000
# Maximum file size in MB
max_file_size_mb = 50
# Allowed file types
allowed_extensions = ["pdf"]
# Temp directory for uploads
upload_dir = "./uploads"
output_dir = "./outputs/runs"

[features]
# Enable image mode - converts PDFs to images for better LLM format understanding
enable_images = true
# Prioritize table-heavy pages when selecting images
enable_tables = true
# Image DPI for PDF conversion (higher = better quality but larger)
image_dpi = 150
# Max total images across all PDFs
max_images = 50
# Minimum table size for table detection
min_table_rows = 2
min_table_cols = 2
# Image budget ratios per PDF type (normalized if they don't sum to 1.0)
image_ratio_examples = 0.5
image_ratio_rfp = 0.25
image_ratio_context = 0.25
# Enable frontend authentication with MSAL
enable_auth = false
# Protect prompt read/write endpoints with an admin permission token.
# If false, prompt read/write is open to any frontend user.
front_end_auth = false
# Optional role required for prompt read/write when front_end_auth = true.
# Role value must match a role present in the MSAL token's roles claim.
front_end_required_role = ""
# Shared admin token required when front_end_auth = true
# Leave empty if you use role-based checks only.
admin_permission = ""
toggle_requirements_chunking = false
max_tokens_reqs_chunking = 12000
toggle_generation_chunking = false
max_tokens_generation_chunking = 12000
generator_intro_pages = 3
generation_page_overlap = 1
max_sections_per_chunk = 3

[msal]
# Microsoft Entra ID (Azure AD) settings for frontend authentication
# Only used if features.enable_auth = true
# App registration client ID (App ID)
client_id = ""
# Directory (tenant) ID
tenant_id = ""
# Redirect URI for authentication
redirect_uri = "http://localhost:3000"
# Scopes to request
scopes = ["User.Read"]

[api_auth]
# API authentication for RFP generation endpoints
enabled = false
# Header name to check for API token (default: X-API-Key)
header_name = "X-API-Key"
# Token type: "bearer", "jwt", or "custom"
token_type = "bearer"
# JWT secret for validating signed tokens (only for jwt type)
jwt_secret = ""
# List of required fields and values that tokens must contain
# Token can be plain JSON or base64-encoded JSON
# Example: required_fields = [
#   { field = "user_id", value = "admin123" },
#   { field = "org", value = "acme-corp" }
# ]
required_fields = []

[workflow]
# Agent Framework workflow settings
# Timeout for LLM calls in seconds
llm_timeout = 120
# Maximum retries for failed LLM calls
max_retries = 3
# Enable verbose logging
verbose = false
# Log all LLM interactions to llm_interactions/ folder in run directory
log_all_steps = true

# Proposal Planner: AI-driven planning before document generation
# When enabled, creates detailed section plans with requirement mapping and visualizations
enable_planner = false

# Proposal Critiquer: Automatic code quality review
# When enabled, reviews generated code and requests revisions if needed
enable_critiquer = false
# Maximum number of critique loops before accepting the code
max_critiques = 1

# Error Recovery: Automatic regeneration on execution errors
# Maximum number of error recovery attempts before giving up
max_error_loops = 2

[storage]
# Upload run artifacts to Azure Blob storage
use_blob_storage = true
# Keep local run artifacts as well (recommended for local testing/debugging)
use_local_storage = true
# Azure Storage account name (without .blob.core.windows.net)
blob_account_name = "azureaurablob"
# Container to hold RFP run artifacts
blob_container_name = "rfps"
# Prefix under container where run folders are uploaded
blob_runs_prefix = "runs"
