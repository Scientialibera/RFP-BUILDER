{
  "timestamp": "2026-02-05T16:58:54.169919",
  "step": "generate_with_plan",
  "function": "generate_rfp_response",
  "function_arguments": {
    "document_code": "from docx.enum.style import WD_STYLE_TYPE\nfrom docx.oxml.ns import qn\nfrom docx.oxml import OxmlElement\nimport matplotlib.patches as mpatches\nimport datetime as dt\n\nstyles = doc.styles\n\n# Configure Normal style\nnormal = styles['Normal']\nnormal.font.name = 'Calibri'\nnormal._element.rPr.rFonts.set(qn('w:eastAsia'), 'Calibri')\nnormal.font.size = Pt(11)\n\n# Caption style\nif 'Caption' not in [s.name for s in styles]:\n    cap = styles.add_style('Caption', WD_STYLE_TYPE.PARAGRAPH)\n    cap.font.name = 'Calibri'\n    cap.font.size = Pt(9)\n    cap.font.italic = True\n\n\ndef add_caption(text: str):\n    p = doc.add_paragraph(text, style='Caption')\n    p.alignment = WD_ALIGN_PARAGRAPH.CENTER\n    return p\n\n\n# Title Page\ntitle = doc.add_heading('Proposal for Phase 1 Sanitary Sewer Evaluation Survey (SSES)\\nLaSalle Area – Niagara Falls Water Board', level=0)\ntitle.alignment = WD_ALIGN_PARAGRAPH.CENTER\np_sub = doc.add_paragraph('Submitted by Aurelia Digital Systems', style='Normal')\np_sub.alignment = WD_ALIGN_PARAGRAPH.CENTER\np_date = doc.add_paragraph('November 2022', style='Normal')\np_date.alignment = WD_ALIGN_PARAGRAPH.CENTER\n\np_conf = doc.add_paragraph('Internal | Confidential – This proposal is submitted in response to the Niagara Falls Water Board Request for Proposals for Phase 1 SSES services. The proposal is firm and irrevocable for 90 days from the submission deadline.', style='Normal')\np_conf.paragraph_format.space_before = Pt(18)\n\n# Executive Summary / Cover Letter\ndoc.add_page_break()\n\nh1 = doc.add_heading('1. Cover Letter and Executive Summary', level=1)\nh1.paragraph_format.space_before = Pt(12)\n\npara = doc.add_paragraph('Niagara Falls Water Board\\nAttn: Authorized Representative\\nNiagara Falls, New York', style='Normal')\npara.paragraph_format.space_after = Pt(6)\n\npara = doc.add_paragraph('Aurelia Digital Systems (\"Aurelia\") is pleased to submit this proposal to provide professional engineering services for the Phase 1 Sanitary Sewer Evaluation Survey (SSES) in the LaSalle area, specifically the 91st and Luick and 81st and Frontier 1 sewersheds. We also provide optional pricing and schedules for Phase 2 (81st and Frontier 2 and 80th and Lindbergh) and Phase 3 (Mang and 88th), consistent with the Request for Proposals (RFP).', style='Normal')\npara.paragraph_format.space_after = Pt(6)\n\npara = doc.add_paragraph('We understand that this work is a critical component of Niagara Falls Water Board\\'s (NFWB) sanitary sewer overflow (SSO) abatement program under Order on Consent R9020080528-32 and is supported by a New York State Environmental Facilities Corporation (NYS EFC) Wastewater Infrastructure Engineering Planning Grant (EPG). Our approach is built around full alignment with the NYS Department of Environmental Conservation (NYSDEC) Engineering Report Outline for Wastewater Infrastructure Projects (October 1, 2022), the Order on Consent schedule, and all applicable Appendix E and Appendix F requirements.', style='Normal')\n\npara = doc.add_paragraph('Aurelia differentiates itself by combining traditional SSES field expertise with strong data, analytics, and governance capabilities. We integrate smoke testing, flow isolation, CCTV, manhole inspections, and focused investigations into a single, auditable data model that clearly traces each inflow and infiltration (I&I) source to a recommended corrective action and measured post-construction benefit. Our documentation and visualization practices—including GIS-compatible outputs and regulator-ready reporting—are designed to make complex findings understandable for NFWB, NYSDEC, and the Water Board, supporting timely approvals and funding decisions.', style='Normal')\n\npara = doc.add_paragraph('We acknowledge and will comply with all administrative requirements, including attending the mandatory pre-proposal information session on November 29, 2022, submitting a sealed proposal by December 5, 2022 at 2:00 p.m., directing all written questions to the authorized contact in accordance with NYS Finance Law 139-j and 139-k, acknowledging all addenda on Appendix E Form No. 1, and maintaining our offer as firm and irrevocable for 90 days. We will submit one clearly marked original, six copies, and one electronic copy of the proposal, and we accept NFWB’s reserved rights and contract terms as outlined in Appendix E and Appendix F, subject to any limited exceptions identified in the Exceptions Attachment.', style='Normal')\n\npara = doc.add_paragraph('On behalf of Aurelia, I am authorized to commit our firm to perform the Phase 1 SSES and, at NFWB’s option, the Phase 2 and Phase 3 SSES services. We look forward to the opportunity to partner with NFWB to deliver measurable I&I reductions, reduce SSOs, and advance long-term system reliability in the LaSalle area.', style='Normal')\n\npara = doc.add_paragraph('Sincerely,\\n\\nBusiness Development Office\\nAurelia Digital Systems\\nToronto, Ontario\\nEmail: proposals@aurelia-digital.example\\nPhone: +1 (416) 555-0199', style='Normal')\n\n# Executive Summary content\nh2 = doc.add_heading('1.1 Executive Summary', level=2)\n\npara = doc.add_paragraph('NFWB’s objective is to perform a comprehensive Phase 1 SSES in the LaSalle area that identifies and quantifies I&I sources, develops a cost-effective corrective action plan, and establishes a defensible basis for capital improvements and post-construction monitoring. The work must align with NYSDEC and NYS EFC expectations and support timely NYSDEC review so that construction can proceed in 2023–early 2024, followed by post-construction monitoring through June 2024.', style='Normal')\n\npara = doc.add_paragraph('Our proposed solution centers on four pillars:', style='Normal')\n\ndoc.add_paragraph('Regulatory alignment: We organize our scope, schedule, and deliverables around the Order on Consent, NYSDEC’s Engineering Report Outline, and EPG requirements, ensuring that all technical work products are directly mapped to regulatory expectations and consent order milestones.', style='List Bullet')\ndoc.add_paragraph('Data-driven SSES: We integrate smoke testing, flow isolation, CCTV, manhole data, and focused investigations into a unified geospatial data environment, enabling transparent prioritization of corrective actions based on I&I reduction potential, constructability, and cost-effectiveness.', style='List Bullet')\ndoc.add_paragraph('Strong governance and communication: We provide a single Project Manager, structured coordination with NFWB and NYSDEC, clear communication protocols with residents and emergency services, and disciplined project controls for schedule, budget, and risk.', style='List Bullet')\ndoc.add_paragraph('Safety, MWBE/SDVOB participation, and long-term partnership: We execute all field activities under a robust health and safety program, incorporate meaningful MWBE and SDVOB participation with transparent reporting, and provide a scalable roadmap through Phases 1–3.', style='List Bullet')\n\npara = doc.add_paragraph('The result is an SSES program that not only meets the RFP’s minimum requirements but also provides NFWB with a defensible, regulator-ready basis for investment decisions and a repeatable framework for subsequent phases.', style='Normal')\n\n# Mermaid diagram: linkage from Phase 1 to corrective actions to monitoring\nmermaid_code = '''\nflowchart LR\n  A[Phase 1 SSES tasks] --> B[I and I source identification]\n  B --> C[Corrective action plan]\n  C --> D[Design and construction]\n  D --> E[Post construction monitoring]\n  E --> F[NYSDEC compliance reporting]\n  F --> G[Order on Consent objectives]\n'''\ndiagram_path = render_mermaid(mermaid_code, 'phase1_to_compliance')\ndoc.add_picture(str(diagram_path), width=Inches(5.8))\nadd_caption('Figure 1: Linkage from Phase 1 SSES through corrective actions to Order on Consent compliance')\n\n# Table summarizing Phase 1, Phase 2, Phase 3 scope at a glance\ntable = doc.add_table(rows=4, cols=4)\ntable.style = 'Table Grid'\n table.alignment = WD_TABLE_ALIGNMENT.CENTER\n\nhdr = table.rows[0].cells\nhdr[0].text = 'Phase'\nhdr[1].text = 'Sewersheds'\nhdr[2].text = 'Key Tasks'\nhdr[3].text = 'Outfall assessments'\nfor cell in hdr:\n    for run in cell.paragraphs[0].runs:\n        run.bold = True\n\nrow = table.rows[1].cells\nrow[0].text = 'Phase 1 (Base)'\nrow[1].text = '91st and Luick; 81st and Frontier 1'\nrow[2].text = 'Tasks 1–8: project management, smoke testing, flow isolation, CCTV/manhole review, outfall assessment, focused SSES, SSES report, post-construction monitoring'\nrow[3].text = 'Two outfalls/SSOs'\n\nrow = table.rows[2].cells\nrow[0].text = 'Phase 2 (Option 1)'\nrow[1].text = '81st and Frontier 2; 80th and Lindbergh'\nrow[2].text = 'Tasks 1–4, 6–8 (Task 5 omitted per RFP)'\nrow[3].text = 'None (Task 5 omitted)'\n\nrow = table.rows[3].cells\nrow[0].text = 'Phase 3 (Option 2)'\nrow[1].text = 'Mang and 88th'\nrow[2].text = 'Tasks 1–8 scaled to Phase 3 scope'\nrow[3].text = 'One outfall/SSO'\n\n# 2. Administrative Compliance and Proposal Submission Plan\ndoc.add_page_break()\n\nh1 = doc.add_heading('2. Administrative Compliance and Proposal Submission Plan', level=1)\n\npara = doc.add_paragraph('Aurelia will comply with all administrative, submission, and communication requirements of the RFP. Our internal proposal management process is designed to ensure that mandatory conditions are satisfied and documented, and that all interactions with NFWB comply with NYS Finance Law 139-j and 139-k restricted communications rules.', style='Normal')\n\n# Mermaid timeline diagram of pre-award milestones\nmermaid_code = '''\nflowchart LR\n  A[Pre proposal meeting Nov 29] --> B[Questions deadline]\n  B --> C[Addenda issued]\n  C --> D[Proposal due Dec 5]\n  D --> E[Ninety day hold period]\n'''\nadmin_timeline_path = render_mermaid(mermaid_code, 'admin_timeline')\ndoc.add_picture(str(admin_timeline_path), width=Inches(5.5))\nadd_caption('Figure 2: Key pre-award administrative milestones')\n\n# Administrative requirements checklist table\ntable = doc.add_table(rows=1, cols=4)\ntable.style = 'Table Grid'\ntable.alignment = WD_TABLE_ALIGNMENT.CENTER\nhdr = table.rows[0].cells\nhdr[0].text = 'Administrative requirement'\nhdr[1].text = 'Reference (REQ)'\nhdr[2].text = 'Responsible party'\nhdr[3].text = 'Status at submission'\nfor cell in hdr:\n    for run in cell.paragraphs[0].runs:\n        run.bold = True\n\nrows = [\n    ('Attend mandatory pre-proposal information session at WWTP on November 29, 2022 at noon', 'REQ-001', 'Aurelia Proposal Manager', 'Will attend; documented in internal log'),\n    ('Submit sealed proposal by December 5, 2022 at 2:00 p.m. with required copies and electronic PDF', 'REQ-002, REQ-021', 'Aurelia Proposal Manager', 'Compliant at submission'),\n    ('Direct all written questions to authorized contact; comply with NYS Finance Law 139-j and 139-k', 'REQ-003', 'Aurelia Proposal Manager', 'Compliant; no unauthorized contacts'),\n    ('Email authorized contact to be added to distribution list; acknowledge all addenda on Appendix E Form 1', 'REQ-004, REQ-018', 'Aurelia Proposal Manager', 'Compliant; all addenda acknowledged'),\n    ('Maintain proposal as firm and irrevocable for 90 days from submission deadline', 'REQ-022', 'Aurelia Authorized Signatory', 'Explicitly accepted in cover letter'),\n    ('Submit one original, six copies, and one electronic copy on USB or CD in sealed, labeled envelope', 'REQ-021', 'Aurelia Proposal Coordinator', 'Compliant at submission')\n]\n\nfor req, ref, resp, status in rows:\n    row_cells = table.add_row().cells\n    row_cells[0].text = req\n    row_cells[1].text = ref\n    row_cells[2].text = resp\n    row_cells[3].text = status\n\n# 3. Understanding of NFWB Objectives, System, and Regulatory Context\n\ndoc.add_page_break()\n\nh1 = doc.add_heading('3. Understanding of NFWB Objectives, System, and Regulatory Context', level=1)\n\npara = doc.add_paragraph('NFWB is implementing a multi-phase SSO abatement program in the LaSalle area under Order on Consent R9020080528-32. The Phase 1 SSES in the 91st and Luick and 81st and Frontier 1 sewersheds is intended to identify and quantify I&I sources, support development of a cost-effective corrective action plan, and establish a baseline for post-construction monitoring. The work is funded in part by a NYS EFC Engineering Planning Grant, which requires adherence to NYSDEC’s Engineering Report Outline and EPG terms and conditions.', style='Normal')\n\npara = doc.add_paragraph('Based on our review of the RFP, Order on Consent, and typical LaSalle system characteristics, we understand the following key drivers:', style='Normal')\n\ndoc.add_paragraph('High wet-weather peaking factors and SSO events at LaSalle outfalls and regulators, driven by inflow from roof leaders, yard drains, and cross-connections, as well as groundwater infiltration through defective mains, laterals, and manholes.', style='List Bullet')\ndoc.add_paragraph('Regulatory pressure to demonstrate measurable I&I reductions, document the most effective corrective techniques, and align capital improvements with NYSDEC’s SSO abatement expectations and funding priorities.', style='List Bullet')\ndoc.add_paragraph('Need for a defensible, data-driven Engineering Report and Post-Construction I&I Assessment that can withstand regulatory review and support future grant and loan applications.', style='List Bullet')\ndoc.add_paragraph('Operational constraints related to resident communications, access to easements and backyards, coordination with NFWB operations and other contractors, and seasonal limitations for smoke testing and flow monitoring.', style='List Bullet')\n\n# Mermaid system context diagram\nmermaid_code = '''\nflowchart LR\n  A[LaSalle sewersheds] --> B[Collection system]\n  B --> C[Outfalls and SSOs]\n  B --> D[Monitoring points]\n  D --> E[NFWB data systems]\n  E --> F[Aurelia analysis]\n  F --> G[NYSDEC reports]\n'''\ncontext_path = render_mermaid(mermaid_code, 'system_context')\ndoc.add_picture(str(context_path), width=Inches(5.8))\nadd_caption('Figure 3: LaSalle sewershed and regulatory reporting context')\n\n# Seaborn bar chart: illustrative SSO/I&I drivers\nplt.figure(figsize=(6, 4))\nsns.set_style('whitegrid')\ndata = pd.DataFrame({\n    'Category': ['Smoke test defects', 'Inflow sources', 'Structural defects', 'Manhole defects', 'Unknown/other'],\n    'Relative contribution': [30, 25, 25, 15, 5]\n})\nax = sns.barplot(data=data, x='Category', y='Relative contribution', color='#4c72b0')\nax.set_ylabel('Relative contribution (percent)')\nax.set_xlabel('I and I driver category')\nax.set_title('Illustrative composition of I and I and SSO drivers')\nplt.xticks(rotation=20, ha='right')\nplt.tight_layout()\nchart_path = output_dir / 'iandi_drivers_bar.png'\nplt.savefig(chart_path, dpi=150, bbox_inches='tight', facecolor='white')\nplt.close()\n\ndoc.add_picture(str(chart_path), width=Inches(5.8))\nadd_caption('Figure 4: Illustrative distribution of I and I and SSO drivers by category')\n\n# Table mapping regulatory/Order on Consent requirements to deliverables\n\ntable = doc.add_table(rows=1, cols=4)\ntable.style = 'Table Grid'\ntable.alignment = WD_TABLE_ALIGNMENT.CENTER\nhdr = table.rows[0].cells\nhdr[0].text = 'Regulatory / consent requirement'\nhdr[1].text = 'Planned deliverable'\nhdr[2].text = 'Key checkpoint'\nhdr[3].text = 'Related REQ IDs'\nfor cell in hdr:\n    for run in cell.paragraphs[0].runs:\n        run.bold = True\n\nrows = [\n    ('Order on Consent R9020080528-32 SSO abatement schedule', 'Phase 1 SSES Engineering Report and corrective action plan', 'Draft and final SSES report submissions to NFWB and NYSDEC', 'REQ-005, REQ-007, REQ-014, REQ-030'),\n    ('NYSDEC Engineering Report Outline (Oct 1, 2022)', 'Engineering Report structured to NYSDEC outline with traceable appendices and calculations', 'Internal Aurelia QA review and NFWB technical review prior to NYSDEC submittal', 'REQ-006, REQ-014'),\n    ('EPG grant terms and conditions', 'Grant-compliant work plan, schedule, and documentation of eligible costs', 'Coordination with NFWB on EPG reporting and reimbursement packages', 'REQ-006'),\n    ('Post-construction I and I assessment requirement', 'Post-Construction I and I Assessment and Cost Analysis Report', 'Completion of 2024 monitoring period and joint review with NFWB', 'REQ-015, REQ-030')\n]\n\nfor reg, deliv, chk, refs in rows:\n    row_cells = table.add_row().cells\n    row_cells[0].text = reg\n    row_cells[1].text = deliv\n    row_cells[2].text = chk\n    row_cells[3].text = refs\n\n# 4. Detailed Technical Approach – Phase 1 SSES Tasks 1–8\n\ndoc.add_page_break()\n\nh1 = doc.add_heading('4. Detailed Technical Approach – Phase 1 SSES Tasks 1–8', level=1)\n\npara = doc.add_paragraph('Our technical approach executes all required Phase 1 SSES tasks (1–8) in the 91st and Luick and 81st and Frontier 1 sewersheds, meeting or exceeding the RFP’s minimum scope. We sequence tasks to maximize data value, de-risk schedule-critical activities, and maintain clear traceability from field observations to corrective actions and post-construction performance.', style='Normal')\n\n# Mermaid flowchart for end-to-end SSES workflow\nmermaid_code = '''\nflowchart TD\n  A[Task 1 data review] --> B[Task 2 smoke testing]\n  B --> C[Task 3 flow isolation]\n  C --> D[Task 4 CCTV and manholes]\n  D --> E[Task 5 outfall assessment]\n  E --> F[Task 6 focused SSES]\n  F --> G[Task 7 SSES report]\n  G --> H[Task 8 post construction monitoring]\n'''\nworkflow_path = render_mermaid(mermaid_code, 'sses_workflow')\ndoc.add_picture(str(workflow_path), width=Inches(5.8))\nadd_caption('Figure 5: End-to-end Phase 1 SSES workflow')\n\n# Mermaid sequence diagram for interactions during field activities\nmermaid_code = '''\nsequenceDiagram\n  participant Resident\n  participant NFWB\n  participant Aurelia\n  participant NYSDEC\n  NFWB->>Aurelia: Authorize smoke testing and flow isolation\n  Aurelia->>NFWB: Submit notifications and traffic control plans\n  NFWB->>Resident: Issue public notices\n  Aurelia->>Resident: Deliver door hangers and answer questions\n  Aurelia->>Aurelia: Perform smoke testing and flow isolation\n  Aurelia->>NFWB: Report interim findings\n  NFWB->>NYSDEC: Provide status updates as needed\n'''\nseq_path = render_mermaid(mermaid_code, 'field_sequence')\ndoc.add_picture(str(seq_path), width=Inches(5.8))\nadd_caption('Figure 6: Coordination among Aurelia, NFWB, NYSDEC, and residents during key field activities')\n\n# Gantt-style bar chart for Tasks 1–8 timeline\nschedule = pd.DataFrame({\n    'Task': [\n        'Task 1 Project management and data review',\n        'Task 2 Smoke testing',\n        'Task 3 Flow isolation and measurement',\n        'Task 4 CCTV and manhole analysis',\n        'Task 5 Outfall and SSO assessment',\n        'Task 6 Focused SSES',\n        'Task 7 SSES report and corrective plan',\n        'Task 8 Post construction monitoring'\n    ],\n    'Start': pd.to_datetime([\n        '2022-12-06', '2023-03-01', '2023-03-15', '2023-02-01',\n        '2023-04-01', '2023-04-15', '2023-05-01', '2024-01-01'\n    ]),\n    'End': pd.to_datetime([\n        '2023-01-31', '2023-03-31', '2023-04-30', '2023-04-15',\n        '2023-05-15', '2023-06-15', '2023-06-30', '2024-06-30'\n    ]),\n    'Phase': [\n        'Management', 'Field', 'Field', 'Analysis',\n        'Field', 'Field', 'Reporting', 'Monitoring'\n    ]\n})\n\nproject_start = schedule['Start'].min()\nschedule['days_to_start'] = (schedule['Start'] - project_start).dt.days\nschedule['duration'] = (schedule['End'] - schedule['Start']).dt.days + 1\n\nphase_colors = {\n    'Management': '#1f77b4',\n    'Field': '#2ca02c',\n    'Analysis': '#9467bd',\n    'Reporting': '#ff7f0e',\n    'Monitoring': '#8c564b'\n}\n\nfig, ax = plt.subplots(figsize=(9, 5))\nfor idx, row in schedule.iterrows():\n    ax.barh(y=row['Task'], width=row['duration'], left=row['days_to_start'],\n            color=phase_colors[row['Phase']], edgecolor='white', linewidth=0.5)\n\nax.invert_yaxis()\nmax_days = schedule['days_to_start'].max() + schedule['duration'].max()\nxticks = np.arange(0, max_days + 15, 30)\nxticklabels = pd.date_range(start=project_start, periods=len(xticks), freq='30D').strftime('%b %Y')\nax.set_xticks(xticks[:len(xticklabels)])\nax.set_xticklabels(xticklabels, fontsize=8, rotation=30, ha='right')\nax.set_xlabel('Timeline')\nax.set_title('Phase 1 SSES Tasks 1–8 Implementation Timeline')\nax.xaxis.grid(True, alpha=0.3, linestyle='--')\nax.set_axisbelow(True)\n\nunique_phases = schedule['Phase'].unique()\npatches = [mpatches.Patch(color=phase_colors[p], label=p) for p in unique_phases]\nax.legend(handles=patches, loc='lower right', fontsize=8, framealpha=0.9)\n\nplt.tight_layout()\ngantt_path = output_dir / 'phase1_tasks_gantt.png'\nplt.savefig(gantt_path, dpi=150, bbox_inches='tight', facecolor='white')\nplt.close()\n\ndoc.add_picture(str(gantt_path), width=Inches(6.0))\nadd_caption('Figure 7: Proposed schedule and overlap of Phase 1 SSES Tasks 1–8')\n\n# Task-by-task methodology summary table\n\ntable = doc.add_table(rows=1, cols=5)\ntable.style = 'Table Grid'\ntable.alignment = WD_TABLE_ALIGNMENT.CENTER\nhdr = table.rows[0].cells\nhdr[0].text = 'Task'\nhdr[1].text = 'Objectives'\nhdr[2].text = 'Key inputs'\nhdr[3].text = 'Methods and tools'\nhdr[4].text = 'Outputs and success criteria'\nfor cell in hdr:\n    for run in cell.paragraphs[0].runs:\n        run.bold = True\n\nrows = [\n    ('Task 1 – Project management and data review', 'Establish governance, review existing data, confirm scope and schedule', 'Order on Consent, prior studies, GIS, flow data', 'Structured data inventory, kickoff and coordination meetings, risk and issue logs', 'Approved project management plan, data gap list, agreed schedule'),\n    ('Task 2 – Smoke testing', 'Identify inflow sources and cross-connections', 'System maps, access constraints, weather forecasts', 'Standard smoke testing procedures, resident notifications, photo documentation', 'GIS-linked defect inventory with severity ratings and recommended follow-up'),\n    ('Task 3 – Flow isolation and measurement', 'Quantify groundwater infiltration by segment', 'Historical flow and rainfall data, system layout', 'Weir installation, confined space procedures, continuous flow logging, QA/QC checks', 'Segment-level infiltration rates (gpd per linear foot) with confidence intervals'),\n    ('Task 4 – CCTV and manhole analysis', 'Identify structural and O and M defects contributing to I and I', 'NFWB CCTV videos and logs, manhole inspection data', 'Standardized defect coding, integration into geospatial database', 'Prioritized defect list with recommended structural and O and M interventions'),\n    ('Task 5 – Outfall and SSO assessment', 'Characterize outfall performance and extraneous flows', 'Existing outfall data, field reconnaissance', 'Flow meters, rain gauges, dye testing, confined space entry where needed', 'GIS-compatible outfall assessment and recommendations to reduce extraneous flows'),\n    ('Task 6 – Focused SSES', 'Confirm and refine I and I source locations', 'Findings from Tasks 2–5', 'Targeted dye testing, house inspections, additional CCTV', 'Validated source locations and refined corrective actions within contingency budget'),\n    ('Task 7 – SSES report and corrective plan', 'Prepare NYSDEC-compliant Engineering Report and corrective action plan', 'All SSES data and analyses', 'Report drafting to NYSDEC outline, QA review, PE stamping', 'NYSDEC-acceptable SSES report enabling 2023–2024 construction'),\n    ('Task 8 – Post-construction monitoring', 'Measure I and I reductions and cost-effectiveness', 'Pre-construction flow and rainfall data, as-built information', 'Flow and rainfall monitoring, statistical comparison, cost-effectiveness analysis', 'Post-Construction I and I Assessment and Cost Analysis Report for NYSDEC')\n]\n\nfor task, obj, inp, meth, outp in rows:\n    row_cells = table.add_row().cells\n    row_cells[0].text = task\n    row_cells[1].text = obj\n    row_cells[2].text = inp\n    row_cells[3].text = meth\n    row_cells[4].text = outp\n\n# Risk and mitigation table for major tasks\n\ntable = doc.add_table(rows=1, cols=4)\ntable.style = 'Table Grid'\ntable.alignment = WD_TABLE_ALIGNMENT.CENTER\nhdr = table.rows[0].cells\nhdr[0].text = 'Task'\nhdr[1].text = 'Key risk'\nhdr[2].text = 'Potential impact'\nhdr[3].text = 'Mitigation and contingency'\nfor cell in hdr:\n    for run in cell.paragraphs[0].runs:\n        run.bold = True\n\nrows = [\n    ('Task 2 – Smoke testing', 'Adverse weather or frozen ground conditions', 'Delayed testing and incomplete coverage', 'Plan primary and backup testing windows; monitor forecasts; sequence areas to use best conditions first'),\n    ('Task 3 – Flow isolation and measurement', 'Limited access or traffic control constraints at weir locations', 'Reduced data quality or schedule delays', 'Early coordination with NFWB and local authorities; flexible site selection; use of off-peak work windows'),\n    ('Task 4 – CCTV and manhole analysis', 'Incomplete or inconsistent CCTV records', 'Data gaps and uncertainty in defect characterization', 'Early data quality review; targeted re-inspections with NFWB crews; standardized coding'),\n    ('Task 5 – Outfall assessment', 'Confined space entry and safety hazards', 'Safety incidents or restricted data collection', 'Strict confined space procedures; pre-entry hazard assessments; alternative non-entry methods where feasible'),\n    ('Task 7 – SSES report', 'Late data inputs or extended internal reviews', 'Risk to NYSDEC review timeline and 2023 construction', 'Interim technical memos; rolling data integration; early outline agreement with NFWB and NYSDEC'),\n]\n\nfor task, risk, impact, mit in rows:\n    row_cells = table.add_row().cells\n    row_cells[0].text = task\n    row_cells[1].text = risk\n    row_cells[2].text = impact\n    row_cells[3].text = mit\n\n# 4.1 Task 1 – Project Management, Data Review, and Coordination\n\ndoc.add_page_break()\n\nh2 = doc.add_heading('4.1 Task 1 – Project Management, Data Review, and Coordination', level=2)\n\npara = doc.add_paragraph('Aurelia will designate a single Project Manager as the primary point of contact for NFWB. The Project Manager will lead project initiation, data review, coordination with NFWB and NYSDEC, and ongoing consultation throughout the SSES. Project governance will align with Aurelia’s delivery model and NFWB’s expectations for transparency, documentation, and regulatory compliance.', style='Normal')\n\n# Mermaid RACI-style diagram\nmermaid_code = '''\nflowchart LR\n  PM[Project manager] --> Gov[Project governance]\n  Eng[Technical leads] --> Gov\n  NFWB[NFWB staff] --> Gov\n  NYSDEC[NYSDEC liaison] --> Gov\n  Gov --> Dec[Decisions and approvals]\n'''\nraci_path = render_mermaid(mermaid_code, 'task1_raci')\ndoc.add_picture(str(raci_path), width=Inches(5.5))\nadd_caption('Figure 8: Roles and responsibilities for project management and coordination')\n\n# Coordination meetings table\n\ntable = doc.add_table(rows=1, cols=3)\ntable.style = 'Table Grid'\ntable.alignment = WD_TABLE_ALIGNMENT.CENTER\nhdr = table.rows[0].cells\nhdr[0].text = 'Meeting'\nhdr[1].text = 'Objectives'\nhdr[2].text = 'Typical participants'\nfor cell in hdr:\n    for run in cell.paragraphs[0].runs:\n        run.bold = True\n\nrows = [\n    ('Project kickoff', 'Confirm scope, roles, communication protocols, safety expectations, and schedule', 'Aurelia Project Manager and leads, NFWB project manager and operations, key stakeholders'),\n    ('Data review workshop', 'Review existing GIS, flow data, CCTV, manhole records, and Order on Consent requirements; identify data gaps', 'Aurelia data and modeling leads, NFWB engineering and IT'),\n    ('Interim findings review', 'Share preliminary SSES findings, refine fieldwork focus, confirm priorities', 'Aurelia technical team, NFWB engineering and operations'),\n    ('Draft report review', 'Review draft Engineering Report and corrective action plan; align on priorities and phasing', 'Aurelia Project Manager and PE, NFWB leadership and technical staff'),\n    ('NYSDEC coordination session', 'Discuss key findings, proposed corrective actions, and schedule with regulator', 'Aurelia PE, NFWB leadership, NYSDEC staff as appropriate')\n]\n\nfor name, obj, part in rows:\n    row_cells = table.add_row().cells\n    row_cells[0].text = name\n    row_cells[1].text = obj\n    row_cells[2].text = part\n\n# 4.2 Task 2 – Smoke Testing Plan and Execution\n\nh2 = doc.add_heading('4.2 Task 2 – Smoke Testing Plan and Execution', level=2)\n\npara = doc.add_paragraph('We will perform smoke testing in the 91st and Luick and 81st and Frontier 1 sewersheds to identify inflow sources such as roof leaders, yard drains, cross-connections, and defective cleanouts. Our approach emphasizes safety, resident communication, and thorough documentation.', style='Normal')\n\n# Mermaid flowchart of smoke testing workflow\nmermaid_code = '''\nflowchart TD\n  A[Plan test areas] --> B[Coordinate with NFWB and authorities]\n  B --> C[Issue resident notifications]\n  C --> D[Deploy field crews]\n  D --> E[Conduct smoke testing]\n  E --> F[Document defects]\n  F --> G[Enter data into GIS]\n'''\nsmoke_path = render_mermaid(mermaid_code, 'smoke_workflow')\ndoc.add_picture(str(smoke_path), width=Inches(5.5))\nadd_caption('Figure 9: Smoke testing planning and execution workflow')\n\n# Notification and coordination steps table\n\ntable = doc.add_table(rows=1, cols=4)\ntable.style = 'Table Grid'\ntable.alignment = WD_TABLE_ALIGNMENT.CENTER\nhdr = table.rows[0].cells\nhdr[0].text = 'Step'\nhdr[1].text = 'Description'\nhdr[2].text = 'Lead time'\nhdr[3].text = 'Responsible party'\nfor cell in hdr:\n    for run in cell.paragraphs[0].runs:\n        run.bold = True\n\nrows = [\n    ('Door hangers', 'Deliver bilingual door hangers to all affected properties describing testing, timing, and contact information', '2–4 days before testing', 'Aurelia field team in coordination with NFWB'),\n    ('Press release', 'Draft and issue press release describing program and contact channels', 'At least 5 business days before first testing day', 'NFWB communications with input from Aurelia'),\n    ('Police and fire notice', 'Notify police and fire departments of testing schedule and locations', 'At least 3 days before each testing window', 'NFWB operations with Aurelia support'),\n    ('Weather check', 'Confirm acceptable weather (dry conditions, minimal wind)', 'Daily during testing window', 'Aurelia field supervisor'),\n    ('Post-test follow up', 'Respond to resident questions and document any special conditions', 'Within 2 business days of testing', 'Aurelia Project Manager with NFWB support')\n]\n\nfor step, desc, lead, resp in rows:\n    row_cells = table.add_row().cells\n    row_cells[0].text = step\n    row_cells[1].text = desc\n    row_cells[2].text = lead\n    row_cells[3].text = resp\n\n# 4.3 Task 3 – Flow Isolation and Measurement\n\nh2 = doc.add_heading('4.3 Task 3 – Flow Isolation and Measurement', level=2)\n\npara = doc.add_paragraph('We will design and implement a flow isolation and measurement program to quantify groundwater infiltration by weiring section. This includes reviewing prior flow data, selecting and confirming weir locations with NFWB, providing all equipment and traffic control, ensuring confined space safety, and performing robust QA/QC and data analysis.', style='Normal')\n\n# Mermaid diagram of flow isolation process\nmermaid_code = '''\nflowchart TD\n  A[Review prior flow data] --> B[Select candidate weir sites]\n  B --> C[Field verify and confirm locations]\n  C --> D[Install weirs and meters]\n  D --> E[Collect flow and rainfall data]\n  E --> F[QA QC and data validation]\n  F --> G[Compute infiltration rates]\n'''\nflow_iso_path = render_mermaid(mermaid_code, 'flow_isolation')\ndoc.add_picture(str(flow_iso_path), width=Inches(5.5))\nadd_caption('Figure 10: Flow isolation and measurement process')\n\n# Seaborn line chart: example diurnal flow patterns with rainfall overlay\n\ntime_index = pd.date_range(start='2023-03-15', periods=48, freq='H')\nflow = 0.3 + 0.1 * np.sin(np.linspace(0, 4 * np.pi, 48)) + 0.05 * np.random.rand(48)\nrain = np.zeros(48)\nrain[10:13] = [0.1, 0.25, 0.05]\n\nfig, ax1 = plt.subplots(figsize=(7, 4))\nax1.plot(time_index, flow, color='#1f77b4', label='Flow')\nax1.set_ylabel('Flow (mgd)', color='#1f77b4')\nax1.tick_params(axis='y', labelcolor='#1f77b4')\nax1.set_xlabel('Date and time')\n\nax2 = ax1.twinx()\nax2.bar(time_index, rain, width=0.03, color='#2ca02c', alpha=0.6, label='Rainfall')\nax2.set_ylabel('Rainfall (inches)', color='#2ca02c')\nax2.tick_params(axis='y', labelcolor='#2ca02c')\n\nfig.autofmt_xdate(rotation=30)\nplt.title('Illustrative diurnal flow pattern with rainfall event')\nfig.tight_layout()\nflow_chart_path = output_dir / 'flow_rain_line.png'\nplt.savefig(flow_chart_path, dpi=150, bbox_inches='tight', facecolor='white')\nplt.close()\n\ndoc.add_picture(str(flow_chart_path), width=Inches(5.8))\nadd_caption('Figure 11: Example of planned flow and rainfall analysis for infiltration assessment')\n\n# Seaborn bar chart template for infiltration rates by section\nsections = ['Section 1', 'Section 2', 'Section 3', 'Section 4']\nrates = [800, 1200, 600, 400]\nplt.figure(figsize=(6, 4))\nax = sns.barplot(x=sections, y=rates, color='#4c72b0')\nax.set_xlabel('Weiring section')\nax.set_ylabel('Infiltration rate (gpd per linear foot)')\nax.set_title('Illustrative infiltration rates by weiring section')\nplt.tight_layout()\ninf_chart_path = output_dir / 'infiltration_rates_bar.png'\nplt.savefig(inf_chart_path, dpi=150, bbox_inches='tight', facecolor='white')\nplt.close()\n\ndoc.add_picture(str(inf_chart_path), width=Inches(5.5))\nadd_caption('Figure 12: Illustrative infiltration rate comparison across weiring sections')\n\n# Table summarizing proposed measurement locations\n\ntable = doc.add_table(rows=1, cols=3)\ntable.style = 'Table Grid'\ntable.alignment = WD_TABLE_ALIGNMENT.CENTER\nhdr = table.rows[0].cells\nhdr[0].text = 'Location type'\nhdr[1].text = 'Selection rationale'\nhdr[2].text = 'Anticipated monitoring duration'\nfor cell in hdr:\n    for run in cell.paragraphs[0].runs:\n        run.bold = True\n\nrows = [\n    ('Upstream subcatchment manholes', 'Capture localized infiltration in priority basins with high wet-weather response', '2–4 weeks'),\n    ('Mid-sewershed trunk locations', 'Measure cumulative infiltration and support calibration of systemwide I and I estimates', '4–6 weeks'),\n    ('Downstream near outfalls', 'Support correlation of flow reductions with SSO performance and outfall conditions', '4–6 weeks')\n]\n\nfor loc, rat, dur in rows:\n    row_cells = table.add_row().cells\n    row_cells[0].text = loc\n    row_cells[1].text = rat\n    row_cells[2].text = dur\n\n# 4.4 Task 4 – CCTV and Manhole Data Analysis\n\nh2 = doc.add_heading('4.4 Task 4 – CCTV and Manhole Data Analysis', level=2)\n\npara = doc.add_paragraph('We will analyze NFWB-provided CCTV and manhole inspection data using standardized defect coding and integrate the results into the SSES data model. Where gaps or inconsistencies are identified, we will coordinate with NFWB to schedule supplemental CCTV or manhole inspections using NFWB crews.', style='Normal')\n\n# Mermaid data-flow diagram\nmermaid_code = '''\nflowchart LR\n  A[NFWB CCTV and manhole data] --> B[Aurelia data intake]\n  B --> C[Standardized coding]\n  C --> D[Geospatial database]\n  D --> E[Defect prioritization]\n  E --> F[SSES report and corrective actions]\n'''\nCCTV_path = render_mermaid(mermaid_code, 'cctv_data_flow')\ndoc.add_picture(str(CCTV_path), width=Inches(5.5))\nadd_caption('Figure 13: Data flow from NFWB CCTV and manhole systems into SSES analysis')\n\n# Defect classification table\n\ntable = doc.add_table(rows=1, cols=3)\ntable.style = 'Table Grid'\ntable.alignment = WD_TABLE_ALIGNMENT.CENTER\nhdr = table.rows[0].cells\nhdr[0].text = 'Defect category'\nhdr[1].text = 'Description'\nhdr[2].text = 'Typical recommended action'\nfor cell in hdr:\n    for run in cell.paragraphs[0].runs:\n        run.bold = True\n\nrows = [\n    ('Structural defects', 'Cracks, fractures, joint offsets, deformation, collapses', 'CIPP lining, segment replacement, spot repairs'),\n    ('O and M defects', 'Debris, roots, grease, deposits', 'Cleaning, root removal, ongoing maintenance program'),\n    ('I and I-related defects', 'Open joints, infiltration runners, defective laterals, leaking manhole walls', 'Sealing, grouting, lateral rehabilitation, manhole lining'),\n    ('Other observations', 'Non-sanitary connections, unusual conditions, access issues', 'Further investigation under Task 6, coordination with NFWB operations')\n]\n\nfor cat, desc, act in rows:\n    row_cells = table.add_row().cells\n    row_cells[0].text = cat\n    row_cells[1].text = desc\n    row_cells[2].text = act\n\n# 4.5 Task 5 – Outfall/SSO Condition Assessment\n\nh2 = doc.add_heading('4.5 Task 5 – Outfall and SSO Condition Assessment', level=2)\n\npara = doc.add_paragraph('For the two Phase 1 outfalls/SSOs, Aurelia will develop and implement a targeted assessment program to characterize hydraulic performance, extraneous flows, and structural condition. This will include desktop review, site visits, potential installation of flow meters and rain gauges, dye testing, confined space entry where required, and coordination with NFWB CCTV crews.', style='Normal')\n\n# Mermaid outfall assessment workflow\nmermaid_code = '''\nflowchart TD\n  A[Desktop review and mapping] --> B[Field reconnaissance]\n  B --> C[Assessment work plan]\n  C --> D[Instrumentation and dye testing]\n  D --> E[Data analysis]\n  E --> F[GIS documentation]\n  F --> G[Recommendations]\n'''\noutfall_path = render_mermaid(mermaid_code, 'outfall_workflow')\ndoc.add_picture(str(outfall_path), width=Inches(5.5))\nadd_caption('Figure 14: Outfall and SSO assessment workflow')\n\n# Seaborn before/after bar chart template for outfall flows\nlabels = ['Outfall 1', 'Outfall 2']\npre = [1.8, 1.2]\npost = [0.9, 0.6]\nx = np.arange(len(labels))\nwidth = 0.35\n\nfig, ax = plt.subplots(figsize=(6, 4))\nrects1 = ax.bar(x - width / 2, pre, width, label='Pre construction', color='#1f77b4')\nrects2 = ax.bar(x + width / 2, post, width, label='Post construction', color='#2ca02c')\nax.set_xticks(x)\nax.set_xticklabels(labels)\nax.set_ylabel('Average wet weather flow (mgd)')\nax.set_title('Illustrative pre and post construction outfall flows')\nax.legend()\nplt.tight_layout()\noutfall_chart_path = output_dir / 'outfall_before_after.png'\nplt.savefig(outfall_chart_path, dpi=150, bbox_inches='tight', facecolor='white')\nplt.close()\n\ndoc.add_picture(str(outfall_chart_path), width=Inches(5.5))\nadd_caption('Figure 15: Example of outfall flow reduction analysis for post-construction reporting')\n\n# Table listing outfalls and assessment methods\n\ntable = doc.add_table(rows=1, cols=4)\ntable.style = 'Table Grid'\ntable.alignment = WD_TABLE_ALIGNMENT.CENTER\nhdr = table.rows[0].cells\nhdr[0].text = 'Outfall'\nhdr[1].text = 'Assessment methods'\nhdr[2].text = 'Instrumentation'\nhdr[3].text = 'Expected data outputs'\nfor cell in hdr:\n    for run in cell.paragraphs[0].runs:\n        run.bold = True\n\nrows = [\n    ('Outfall A', 'Site inspection, flow monitoring, dye testing, CCTV coordination', 'Area velocity meter, rain gauge', 'Time series flow and level, observed surcharge, dye travel times, structural observations'),\n    ('Outfall B', 'Site inspection, spot flow measurements, dye testing', 'Portable flow meter, staff gauge', 'Event-based flow measurements, visual evidence of extraneous flows, condition rating')\n]\n\nfor name, meth, inst, outp in rows:\n    row_cells = table.add_row().cells\n    row_cells[0].text = name\n    row_cells[1].text = meth\n    row_cells[2].text = inst\n    row_cells[3].text = outp\n\n# 4.6 Task 6 – Focused SSES and Contingency Use\n\nh2 = doc.add_heading('4.6 Task 6 – Focused SSES and Contingency Use', level=2)\n\npara = doc.add_paragraph('Task 6 provides a focused SSES contingency to confirm and refine I&I source locations using dye testing, house inspections, and additional CCTV. Aurelia will manage the required $10,000 contingency as a controlled budget that can only be used with NFWB approval, supported by written work orders and clear documentation.', style='Normal')\n\n# Mermaid decision-tree diagram\nmermaid_code = '''\nflowchart TD\n  A[Findings from Tasks 2 to 5] --> B[Uncertain I and I source]\n  B --> C{Need focused investigation}\n  C -->|Yes| D[Develop Task 6 work order]\n  D --> E[NFWB approval]\n  E --> F[Perform dye testing or inspections]\n  F --> G[Update data and corrective actions]\n  C -->|No| H[Proceed with existing data]\n'''\nfocused_path = render_mermaid(mermaid_code, 'focused_sses_decision')\ndoc.add_picture(str(focused_path), width=Inches(5.5))\nadd_caption('Figure 16: Decision process for initiating focused SSES investigations')\n\n# Contingency management table\n\ntable = doc.add_table(rows=1, cols=4)\ntable.style = 'Table Grid'\ntable.alignment = WD_TABLE_ALIGNMENT.CENTER\nhdr = table.rows[0].cells\nhdr[0].text = 'Potential use of contingency'\nhdr[1].text = 'Approval workflow'\nhdr[2].text = 'Tracking fields'\nhdr[3].text = 'Control measures'\nfor cell in hdr:\n    for run in cell.paragraphs[0].runs:\n        run.bold = True\n\nrows = [\n    ('Additional dye testing in complex areas', 'Aurelia prepares brief scope and estimate; NFWB issues written authorization', 'Location, scope, estimated cost, actual cost, date, results summary', 'Monthly contingency status report; no work without written approval'),\n    ('House inspections to confirm private inflow', 'Coordinated with NFWB and residents; NFWB approves outreach plan', 'Number of properties, inspection findings, recommended actions', 'Use standardized forms and privacy protocols; integrate with MWBE/SDVOB participation where applicable'),\n    ('Supplemental CCTV or manhole inspections', 'NFWB schedules crews based on Aurelia request; Aurelia confirms need and expected value', 'Segments inspected, defect types, impact on corrective plan', 'Prioritize segments with greatest uncertainty or potential I and I reduction')\n]\n\nfor use, appr, track, ctrl in rows:\n    row_cells = table.add_row().cells\n    row_cells[0].text = use\n    row_cells[1].text = appr\n    row_cells[2].text = track\n    row_cells[3].text = ctrl\n\n# 4.7 Task 7 – SSES Engineering Report and Corrective Action Plan\n\nh2 = doc.add_heading('4.7 Task 7 – SSES Engineering Report and Corrective Action Plan', level=2)\n\npara = doc.add_paragraph('Aurelia will prepare an SSES Engineering Report that conforms to the NYSDEC Engineering Report Outline for Wastewater Infrastructure Projects and meets the requirements of the EPG and Order on Consent. The report will be prepared, stamped, and dated by a New York-licensed Professional Engineer and delivered in time to permit NYSDEC review early in 2023, enabling construction in 2023–early 2024.', style='Normal')\n\n# Mermaid diagram mapping report sections to NYSDEC outline and Order on Consent\nmermaid_code = '''\nflowchart LR\n  A[NYSDEC report outline] --> B[SSES report sections]\n  C[Order on Consent requirements] --> B\n  B --> D[Executive summary]\n  B --> E[Existing conditions]\n  B --> F[Alternatives and corrective actions]\n  B --> G[Implementation schedule]\n  B --> H[Post construction monitoring plan]\n'''\nreport_map_path = render_mermaid(mermaid_code, 'report_mapping')\ndoc.add_picture(str(report_map_path), width=Inches(5.8))\nadd_caption('Figure 17: Mapping of SSES report to NYSDEC outline and Order on Consent requirements')\n\n# Seaborn bar chart: corrective actions by category and I&I reduction\ncategories = ['Mainline rehab', 'Manhole rehab', 'Lateral rehab', 'Inflow disconnections']\nreduction = [35, 20, 25, 20]\nplt.figure(figsize=(6, 4))\nax = sns.barplot(x=categories, y=reduction, color='#4c72b0')\nax.set_xlabel('Corrective action category')\nax.set_ylabel('Estimated share of I and I reduction (percent)')\nax.set_title('Illustrative distribution of I and I reduction by corrective action type')\nplt.xticks(rotation=20, ha='right')\nplt.tight_layout()\naction_chart_path = output_dir / 'corrective_actions_bar.png'\nplt.savefig(action_chart_path, dpi=150, bbox_inches='tight', facecolor='white')\nplt.close()\n\ndoc.add_picture(str(action_chart_path), width=Inches(5.5))\nadd_caption('Figure 18: Example of prioritizing corrective actions by I and I reduction impact')\n\n# Seaborn stacked bar chart of implementation timeline\nphases = ['Short term', 'Medium term', 'Long term']\nmainline = [40, 10, 0]\nmanhole = [20, 10, 0]\nlateral = [10, 20, 5]\ninflow_disc = [10, 5, 0]\nind = np.arange(len(phases))\nwidth = 0.6\n\nfig, ax = plt.subplots(figsize=(6, 4))\np1 = ax.bar(ind, mainline, width, label='Mainline rehab')\np2 = ax.bar(ind, manhole, width, bottom=mainline, label='Manhole rehab')\nbottom3 = np.array(mainline) + np.array(manhole)\np3 = ax.bar(ind, lateral, width, bottom=bottom3, label='Lateral rehab')\nbottom4 = bottom3 + np.array(lateral)\np4 = ax.bar(ind, inflow_disc, width, bottom=bottom4, label='Inflow disconnections')\nax.set_xticks(ind)\nax.set_xticklabels(phases)\nax.set_ylabel('Relative investment level')\nax.set_title('Illustrative phasing of corrective actions')\nax.legend(fontsize=8)\nplt.tight_layout()\nphase_chart_path = output_dir / 'corrective_actions_phasing.png'\nplt.savefig(phase_chart_path, dpi=150, bbox_inches='tight', facecolor='white')\nplt.close()\n\ndoc.add_picture(str(phase_chart_path), width=Inches(5.5))\nadd_caption('Figure 19: Example phasing of corrective actions by implementation window')\n\n# Corrective action matrix table\n\ntable = doc.add_table(rows=1, cols=6)\ntable.style = 'Table Grid'\ntable.alignment = WD_TABLE_ALIGNMENT.CENTER\nhdr = table.rows[0].cells\nhdr[0].text = 'I and I source'\nhdr[1].text = 'Recommended action'\nhdr[2].text = 'Estimated cost range'\nhdr[3].text = 'Estimated I and I reduction'\nhdr[4].text = 'Priority level'\nhdr[5].text = 'Implementation window'\nfor cell in hdr:\n    for run in cell.paragraphs[0].runs:\n        run.bold = True\n\nrows = [\n    ('Defective mainline joints in 91st and Luick trunk', 'CIPP lining of trunk segments', '$500k–$750k', 'High', 'High', 'Short term (2023–2024)'),\n    ('Leaking manholes in low-lying areas', 'Manhole lining and frame adjustments', '$150k–$250k', 'Medium', 'Medium', 'Short term (2023–2024)'),\n    ('Private laterals with confirmed infiltration', 'Targeted lateral rehabilitation program', '$200k–$400k', 'Medium to high', 'High', 'Medium term (2024–2026)'),\n    ('Roof leaders connected to sanitary system', 'Disconnection and redirection to storm system', '$50k–$100k', 'Medium', 'Medium', 'Short to medium term')\n]\n\nfor src, act, cost, red, pri, win in rows:\n    row_cells = table.add_row().cells\n    row_cells[0].text = src\n    row_cells[1].text = act\n    row_cells[2].text = cost\n    row_cells[3].text = red\n    row_cells[4].text = pri\n    row_cells[5].text = win\n\n# 4.8 Task 8 – Post-Construction Monitoring and I&I Assessment\n\nh2 = doc.add_heading('4.8 Task 8 – Post-Construction Monitoring and I and I Assessment', level=2)\n\npara = doc.add_paragraph('Following construction of Phase 1 improvements (assumed 2023 through early 2024), Aurelia will perform post-construction monitoring to quantify I&I reductions and evaluate the cost-effectiveness of implemented measures. We will collect and analyze flow and rainfall data, compare pre- and post-construction conditions, and prepare a Post-Construction I and I Assessment and Cost Analysis Report for NYSDEC.', style='Normal')\n\n# Mermaid timeline diagram for pre vs post monitoring\nmermaid_code = '''\nflowchart LR\n  A[Pre construction baseline monitoring] --> B[Construction period]\n  B --> C[Stabilization period]\n  C --> D[Post construction monitoring]\n  D --> E[Post construction I and I report]\n'''\nmonitor_timeline_path = render_mermaid(mermaid_code, 'pre_post_timeline')\ndoc.add_picture(str(monitor_timeline_path), width=Inches(5.5))\nadd_caption('Figure 20: Pre and post construction monitoring and reporting timeline')\n\n# Line charts comparing pre and post flow vs rainfall\n\ntime_index = pd.date_range(start='2024-02-01', periods=30, freq='D')\npre_flow = 1.5 + 0.3 * np.sin(np.linspace(0, 2 * np.pi, 30)) + 0.2 * np.random.rand(30)\npost_flow = 1.0 + 0.2 * np.sin(np.linspace(0, 2 * np.pi, 30)) + 0.15 * np.random.rand(30)\nrain = np.zeros(30)\nrain[[5, 12, 20, 25]] = [0.3, 0.6, 0.4, 0.2]\n\nfig, ax1 = plt.subplots(figsize=(7, 4))\nax1.plot(time_index, pre_flow, label='Pre construction flow', color='#1f77b4')\nax1.plot(time_index, post_flow, label='Post construction flow', color='#2ca02c')\nax1.set_ylabel('Flow (mgd)')\nax1.set_xlabel('Date')\nax1.legend(loc='upper left', fontsize=8)\n\nax2 = ax1.twinx()\nax2.bar(time_index, rain, width=0.8, color='#8c564b', alpha=0.4, label='Rainfall')\nax2.set_ylabel('Rainfall (inches)')\n\nfig.autofmt_xdate(rotation=30)\nplt.title('Illustrative pre and post construction flow response to rainfall')\nfig.tight_layout()\npre_post_flow_path = output_dir / 'pre_post_flow_rain.png'\nplt.savefig(pre_post_flow_path, dpi=150, bbox_inches='tight', facecolor='white')\nplt.close()\n\ndoc.add_picture(str(pre_post_flow_path), width=Inches(5.8))\nadd_caption('Figure 21: Example comparison of pre and post construction flow response to rainfall')\n\n# Cost-effectiveness scatter plot template\n\nmeasures = ['Mainline rehab', 'Manhole rehab', 'Lateral rehab', 'Inflow disconnections']\ncosts = [700, 200, 300, 100]\nreductions = [0.8, 0.3, 0.4, 0.25]\n\nplt.figure(figsize=(6, 4))\nplt.scatter(costs, reductions, color='#4c72b0')\nfor i, label in enumerate(measures):\n    plt.text(costs[i] + 10, reductions[i], label, fontsize=8)\nplt.xlabel('Cost (thousand dollars)')\nplt.ylabel('Estimated I and I reduction (mgd)')\nplt.title('Illustrative cost effectiveness of implemented measures')\nplt.tight_layout()\nscatter_path = output_dir / 'cost_effectiveness_scatter.png'\nplt.savefig(scatter_path, dpi=150, bbox_inches='tight', facecolor='white')\nplt.close()\n\ndoc.add_picture(str(scatter_path), width=Inches(5.5))\nadd_caption('Figure 22: Example cost effectiveness analysis of corrective measures')\n\n# Monitoring locations and methods table\n\ntable = doc.add_table(rows=1, cols=3)\ntable.style = 'Table Grid'\ntable.alignment = WD_TABLE_ALIGNMENT.CENTER\nhdr = table.rows[0].cells\nhdr[0].text = 'Monitoring location type'\nhdr[1].text = 'Parameters'\nhdr[2].text = 'Statistical comparison methods'\nfor cell in hdr:\n    for run in cell.paragraphs[0].runs:\n        run.bold = True\n\nrows = [\n    ('Upstream subcatchments', 'Continuous flow and level, rainfall', 'Paired event analysis, pre/post regression of flow vs rainfall'),\n    ('Downstream near outfalls', 'Continuous flow, overflow occurrence', 'Frequency and volume comparison of SSO events'),\n    ('Representative basins', 'Flow, rainfall, groundwater levels where available', 'Non-parametric tests to compare central tendency and variability pre/post')\n]\n\nfor loc, param, meth in rows:\n    row_cells = table.add_row().cells\n    row_cells[0].text = loc\n    row_cells[1].text = param\n    row_cells[2].text = meth\n\n# 5. Optional Services Approach – Phase 2 and Phase 3 SSES\n\ndoc.add_page_break()\n\nh1 = doc.add_heading('5. Optional Services Approach – Phase 2 and Phase 3 SSES', level=1)\n\npara = doc.add_paragraph('Aurelia’s approach for Phase 2 (Option 1) and Phase 3 (Option 2) builds directly on the Phase 1 framework, enabling consistent methods, data structures, and reporting across all LaSalle sewersheds. This continuity reduces learning curve, improves comparability of I&I metrics, and simplifies regulatory coordination.', style='Normal')\n\n# Mermaid multi-phase roadmap\nmermaid_code = '''\nflowchart LR\n  A[Phase 1 SSES] --> B[Phase 2 SSES]\n  B --> C[Phase 3 SSES]\n  A --> D[Shared data model]\n  B --> D\n  C --> D\n  D --> E[Portfolio level I and I strategy]\n'''\nroadmap_path = render_mermaid(mermaid_code, 'multi_phase_roadmap')\ndoc.add_picture(str(roadmap_path), width=Inches(5.8))\nadd_caption('Figure 23: Multi phase roadmap across Phase 1, Phase 2, and Phase 3 SSES')\n\n# Seaborn bar chart comparing level of effort by task between phases\nphases = ['Phase 1', 'Phase 2', 'Phase 3']\nfield_hours = [2200, 1800, 1600]\nanalysis_hours = [900, 700, 650]\nreport_hours = [600, 450, 450]\n\nind = np.arange(len(phases))\nwidth = 0.25\n\nfig, ax = plt.subplots(figsize=(7, 4))\nax.bar(ind - width, field_hours, width, label='Field investigations')\nax.bar(ind, analysis_hours, width, label='Analysis and modeling')\nax.bar(ind + width, report_hours, width, label='Reporting and management')\nax.set_xticks(ind)\nax.set_xticklabels(phases)\nax.set_ylabel('Level of effort (hours, illustrative)')\nax.set_title('Illustrative level of effort by phase and activity')\nax.legend(fontsize=8)\nplt.tight_layout()\nloe_path = output_dir / 'phase_loe_comparison.png'\nplt.savefig(loe_path, dpi=150, bbox_inches='tight', facecolor='white')\nplt.close()\n\ndoc.add_picture(str(loe_path), width=Inches(5.8))\nadd_caption('Figure 24: Illustrative comparison of level of effort across SSES phases')\n\n# Option comparison table (scope, schedule, fees)\n\ntable = doc.add_table(rows=1, cols=4)\ntable.style = 'Table Grid'\ntable.alignment = WD_TABLE_ALIGNMENT.CENTER\nhdr = table.rows[0].cells\nhdr[0].text = 'Option'\nhdr[1].text = 'Scope summary'\nhdr[2].text = 'Indicative schedule'\nhdr[3].text = 'Not to exceed fee structure'\nfor cell in hdr:\n    for run in cell.paragraphs[0].runs:\n        run.bold = True\n\nrows = [\n    ('Phase 2 – Option 1', 'Phase 2 SSES in 81st and Frontier 2 and 80th and Lindbergh; Tasks 1–4, 6–8 (Task 5 omitted)', 'Commence after Phase 1 fieldwork; complete within 9–12 months', 'Time and materials with not to exceed cap, structured by task and labor category'),\n    ('Phase 3 – Option 2', 'Phase 3 SSES in Mang and 88th including one outfall assessment', 'Commence after Phase 2 initiation; complete within 9–12 months', 'Time and materials with not to exceed cap, including outfall assessment budget')\n]\n\nfor opt, scope, sched, fee in rows:\n    row_cells = table.add_row().cells\n    row_cells[0].text = opt\n    row_cells[1].text = scope\n    row_cells[2].text = sched\n    row_cells[3].text = fee\n\n# 6. Project Organization, Key Personnel, and Subconsultants\n\ndoc.add_page_break()\n\nh1 = doc.add_heading('6. Project Organization, Key Personnel, and Subconsultants', level=1)\n\npara = doc.add_paragraph('Aurelia’s project organization is designed to provide clear accountability, strong technical leadership, and safe execution of all SSES tasks, including confined space work. We will deploy an integrated team of Aurelia staff and specialized subconsultants, including MWBE and SDVOB firms, to deliver the full scope.', style='Normal')\n\n# Mermaid org chart\nmermaid_code = '''\nflowchart TD\n  NFWB[NFWB project manager] --> PM[Aurelia project manager]\n  PM --> TL[Technical leads]\n  PM --> HSE[Health and safety lead]\n  TL --> Field[Field crews]\n  TL --> Data[Data and analytics team]\n  PM --> Subs[Subconsultants]\n'''\norg_path = render_mermaid(mermaid_code, 'project_org')\ndoc.add_picture(str(org_path), width=Inches(5.8))\nadd_caption('Figure 25: Project organization and reporting relationships')\n\n# Key personnel table\n\ntable = doc.add_table(rows=1, cols=5)\ntable.style = 'Table Grid'\ntable.alignment = WD_TABLE_ALIGNMENT.CENTER\nhdr = table.rows[0].cells\nhdr[0].text = 'Name and role'\nhdr[1].text = 'Licenses and training'\nhdr[2].text = 'Years of experience'\nhdr[3].text = 'Relevant SSES and utility experience'\nhdr[4].text = 'Key responsibilities'\nfor cell in hdr:\n    for run in cell.paragraphs[0].runs:\n        run.bold = True\n\nrows = [\n    ('Project Manager – Senior Engineer', 'NYS PE, OSHA 30, confined space supervisor', '15+', 'Lead for multiple SSES and I and I reduction programs for municipal utilities', 'Single point of contact, schedule and budget management, coordination with NFWB and NYSDEC'),\n    ('Field Operations Lead', 'NASSCO PACP/MACP, confined space entry, traffic control', '12', 'Managed smoke testing, flow isolation, and CCTV programs across several cities', 'Plan and supervise field activities, safety oversight, QA/QC of field data'),\n    ('Data and Analytics Lead', 'Professional engineer in another jurisdiction, GIS certification', '10', 'Developed I and I models, dashboards, and regulatory reports for utilities', 'Integrate and analyze SSES data, support Engineering Report and post-construction assessment'),\n    ('Health and Safety Coordinator', 'Certified safety professional, OSHA trainer', '18', 'Developed and implemented safety programs for field-intensive utility projects', 'Prepare site-specific health and safety plans, monitor compliance, incident response support')\n]\n\nfor name, lic, yrs, exp, resp in rows:\n    row_cells = table.add_row().cells\n    row_cells[0].text = name\n    row_cells[1].text = lic\n    row_cells[2].text = yrs\n    row_cells[3].text = exp\n    row_cells[4].text = resp\n\n# Subconsultant table\n\ntable = doc.add_table(rows=1, cols=4)\ntable.style = 'Table Grid'\ntable.alignment = WD_TABLE_ALIGNMENT.CENTER\nhdr = table.rows[0].cells\nhdr[0].text = 'Subconsultant firm (>10% scope)'\nhdr[1].text = 'Scope of services'\nhdr[2].text = 'Certifications (MWBE/SDVOB)'\nhdr[3].text = 'Role in project'\nfor cell in hdr:\n    for run in cell.paragraphs[0].runs:\n        run.bold = True\n\nrows = [\n    ('Specialized field services firm', 'Smoke testing, flow isolation support, confined space entry crews', 'MWBE (anticipated)', 'Provide experienced field crews and specialized equipment under Aurelia supervision'),\n    ('Local engineering partner', 'On-site coordination, resident outreach, supplemental design support', 'SDVOB (anticipated)', 'Support resident communications, local permitting, and design coordination')\n]\n\nfor firm, scope, cert, role in rows:\n    row_cells = table.add_row().cells\n    row_cells[0].text = firm\n    row_cells[1].text = scope\n    row_cells[2].text = cert\n    row_cells[3].text = role\n\n# 7. Relevant Experience and Past Performance\n\ndoc.add_page_break()\n\nh1 = doc.add_heading('7. Relevant Experience and Past Performance', level=1)\n\npara = doc.add_paragraph('Aurelia Digital Systems is a privately held engineering and technology firm founded in 2016, headquartered in Toronto, Ontario, with delivery teams across Canada and the United States. We specialize in data-rich, compliance-focused projects for public-sector and utility clients. Our team members bring decades of combined experience in SSES, I and I analysis, regulatory reporting, and complex data integration.', style='Normal')\n\n# Seaborn bar chart summarizing past projects by size and duration\nprojects = ['Utility A I and I program', 'Utility B sewer assessment', 'Regional SSO study', 'Municipal flow monitoring']\nvalues = [1.2, 0.8, 1.5, 0.6]\nduration = [24, 18, 30, 12]\n\nfig, ax1 = plt.subplots(figsize=(7, 4))\nax1.bar(projects, values, color='#4c72b0')\nax1.set_ylabel('Contract value (million dollars)')\nax1.set_xticklabels(projects, rotation=20, ha='right')\nax2 = ax1.twinx()\nax2.plot(projects, duration, color='#2ca02c', marker='o')\nax2.set_ylabel('Duration (months)')\nplt.title('Representative project scale and duration')\nfig.tight_layout()\nexp_chart_path = output_dir / 'experience_projects_bar.png'\nplt.savefig(exp_chart_path, dpi=150, bbox_inches='tight', facecolor='white')\nplt.close()\n\ndoc.add_picture(str(exp_chart_path), width=Inches(5.8))\nadd_caption('Figure 26: Representative Aurelia project size and duration')\n\n# Project experience matrix\n\ntable = doc.add_table(rows=1, cols=4)\ntable.style = 'Table Grid'\ntable.alignment = WD_TABLE_ALIGNMENT.CENTER\nhdr = table.rows[0].cells\nhdr[0].text = 'Project'\nhdr[1].text = 'Scope elements'\nhdr[2].text = 'Client type'\nhdr[3].text = 'Reference contact (available upon request)'\nfor cell in hdr:\n    for run in cell.paragraphs[0].runs:\n        run.bold = True\n\nrows = [\n    ('Utility A I and I reduction program', 'SSES, flow monitoring, I and I modeling, NYSDEC-style reporting', 'Public utility', 'Senior engineer at Utility A'),\n    ('Utility B sewer assessment', 'CCTV review, manhole inspections, corrective action planning', 'Municipal utility', 'Engineering manager at Utility B'),\n    ('Regional SSO study', 'SSO root cause analysis, outfall assessment, capital planning', 'Regional authority', 'Program manager at regional authority')\n]\n\nfor proj, scope, ctype, ref in rows:\n    row_cells = table.add_row().cells\n    row_cells[0].text = proj\n    row_cells[1].text = scope\n    row_cells[2].text = ctype\n    row_cells[3].text = ref\n\n# Disclosure table\ntable = doc.add_table(rows=1, cols=2)\ntable.style = 'Table Grid'\ntable.alignment = WD_TABLE_ALIGNMENT.CENTER\nhdr = table.rows[0].cells\nhdr[0].text = 'Disclosure item'\nhdr[1].text = 'Aurelia response'\nfor cell in hdr:\n    for run in cell.paragraphs[0].runs:\n        run.bold = True\n\nrows = [\n    ('Debarment or suspension', 'No debarments or suspensions.'),\n    ('Findings of non-responsibility', 'No findings of non-responsibility related to public contracts.'),\n    ('Defaults or liquidated damages', 'No contract terminations for default; no assessed liquidated damages on SSES or similar projects.'),\n    ('Bankruptcies', 'No bankruptcies.'),\n    ('Material legal actions or investigations', 'No pending legal actions or investigations that would impact our ability to perform this contract.'),\n    ('Conflicts of interest', 'No known conflicts of interest with NFWB, its Board, or staff.')\n]\n\nfor item, resp in rows:\n    row_cells = table.add_row().cells\n    row_cells[0].text = item\n    row_cells[1].text = resp\n\n# 8. Project Schedule and Work Plan\n\ndoc.add_page_break()\n\nh1 = doc.add_heading('8. Project Schedule and Work Plan', level=1)\n\npara = doc.add_paragraph('Our schedule is structured to meet NYSDEC review timelines and enable construction in 2023–early 2024, with post-construction monitoring completed by June 2024. We coordinate fieldwork windows with seasonal constraints, NFWB operations, and resident communication needs.', style='Normal')\n\n# Mermaid Gantt-style diagram (simplified)\nmermaid_code = '''\ngantt\n  title Phase 1 SSES schedule\n  dateFormat  YYYY-MM-DD\n  section Management and analysis\n  Task1 Project management and data review :a1, 2022-12-06, 2023-01-31\n  Task4 CCTV and manhole analysis         :a2, 2023-02-01, 2023-04-15\n  Task7 SSES report                       :a3, 2023-05-01, 2023-06-30\n  section Field investigations\n  Task2 Smoke testing                     :b1, 2023-03-01, 2023-03-31\n  Task3 Flow isolation and measurement    :b2, 2023-03-15, 2023-04-30\n  Task5 Outfall assessment                :b3, 2023-04-01, 2023-05-15\n  Task6 Focused SSES                      :b4, 2023-04-15, 2023-06-15\n  section Monitoring\n  Task8 Post construction monitoring      :c1, 2024-01-01, 2024-06-30\n'''\nphase1_gantt_mermaid_path = render_mermaid(mermaid_code, 'phase1_gantt_mermaid')\ndoc.add_picture(str(phase1_gantt_mermaid_path), width=Inches(6.0))\nadd_caption('Figure 27: High level Phase 1 SSES schedule')\n\n# Seaborn bar chart schedule by task and month\nschedule_summary = pd.DataFrame({\n    'Task': ['Task 1', 'Task 2', 'Task 3', 'Task 4', 'Task 5', 'Task 6', 'Task 7', 'Task 8'],\n    'Months': [2, 1, 2, 3, 2, 2, 2, 6]\n})\nplt.figure(figsize=(6, 4))\nax = sns.barplot(data=schedule_summary, x='Task', y='Months', color='#4c72b0')\nax.set_ylabel('Duration (months, approximate)')\nax.set_title('Approximate duration by Phase 1 task')\nplt.tight_layout()\nmonth_bar_path = output_dir / 'schedule_months_bar.png'\nplt.savefig(month_bar_path, dpi=150, bbox_inches='tight', facecolor='white')\nplt.close()\n\ndoc.add_picture(str(month_bar_path), width=Inches(5.5))\nadd_caption('Figure 28: Approximate duration of Phase 1 tasks')\n\n# Milestone table\n\ntable = doc.add_table(rows=1, cols=3)\ntable.style = 'Table Grid'\ntable.alignment = WD_TABLE_ALIGNMENT.CENTER\nhdr = table.rows[0].cells\nhdr[0].text = 'Milestone'\nhdr[1].text = 'Target date'\nhdr[2].text = 'Responsible role'\nfor cell in hdr:\n    for run in cell.paragraphs[0].runs:\n        run.bold = True\n\nrows = [\n    ('Notice to proceed and kickoff', 'Early December 2022', 'Aurelia Project Manager and NFWB project manager'),\n    ('Completion of data review and initial field plan', 'Late January 2023', 'Aurelia Project Manager and technical leads'),\n    ('Completion of smoke testing and flow isolation', 'End of April 2023', 'Field Operations Lead'),\n    ('Draft SSES report to NFWB', 'Late May 2023', 'Aurelia Project Manager and PE'),\n    ('Final SSES report for NYSDEC submittal', 'Late June 2023', 'Aurelia PE and NFWB'),\n    ('Completion of post-construction monitoring', 'June 2024', 'Aurelia Project Manager and Data Lead')\n]\n\nfor mil, date, resp in rows:\n    row_cells = table.add_row().cells\n    row_cells[0].text = mil\n    row_cells[1].text = date\n    row_cells[2].text = resp\n\n# Work window table for field activities\n\ntable = doc.add_table(rows=1, cols=4)\ntable.style = 'Table Grid'\ntable.alignment = WD_TABLE_ALIGNMENT.CENTER\nhdr = table.rows[0].cells\nhdr[0].text = 'Activity'\nhdr[1].text = 'Preferred window'\nhdr[2].text = 'Key constraints'\nhdr[3].text = 'Mitigation strategies'\nfor cell in hdr:\n    for run in cell.paragraphs[0].runs:\n        run.bold = True\n\nrows = [\n    ('Smoke testing', 'Early spring 2023', 'Dry weather, minimal snow and ice, wind conditions', 'Monitor forecast; maintain backup dates; prioritize areas with best conditions'),\n    ('Flow isolation and measurement', 'Spring 2023', 'Stable groundwater conditions, access for equipment', 'Coordinate with NFWB operations; plan traffic control in advance'),\n    ('Outfall assessment', 'Spring 2023', 'Safe access, water levels, environmental sensitivity', 'Conduct pre-site visits; adjust schedule for high flows or unsafe conditions')\n]\n\nfor act, win, cons, mit in rows:\n    row_cells = table.add_row().cells\n    row_cells[0].text = act\n    row_cells[1].text = win\n    row_cells[2].text = cons\n    row_cells[3].text = mit\n\n# 9. Management Approach, Governance, and Communication\n\ndoc.add_page_break()\n\nh1 = doc.add_heading('9. Management Approach, Governance, and Communication', level=1)\n\npara = doc.add_paragraph('Aurelia’s management approach combines disciplined project controls with clear governance and transparent communication. We align with NFWB’s administrative requirements, coordinate with other contractors, and maintain compliance with restricted communications under NYS Finance Law 139-j and 139-k.', style='Normal')\n\n# Mermaid governance diagram\nmermaid_code = '''\nflowchart TD\n  Steer[Steering group] --> PMO[Project management]\n  PMO --> Work[Working team]\n  Work --> Field[Field coordination]\n  Work --> Data[Data and reporting]\n  PMO --> Risk[Risk and issue review]\n  Risk --> Steer\n'''\ngov_path = render_mermaid(mermaid_code, 'governance_model')\ndoc.add_picture(str(gov_path), width=Inches(5.5))\nadd_caption('Figure 29: Governance structure and escalation paths')\n\n# Communication plan table\n\ntable = doc.add_table(rows=1, cols=4)\ntable.style = 'Table Grid'\ntable.alignment = WD_TABLE_ALIGNMENT.CENTER\nhdr = table.rows[0].cells\nhdr[0].text = 'Audience'\nhdr[1].text = 'Communication type'\nhdr[2].text = 'Frequency'\nhdr[3].text = 'Channel and owner'\nfor cell in hdr:\n    for run in cell.paragraphs[0].runs:\n        run.bold = True\n\nrows = [\n    ('NFWB project team', 'Status meetings, action logs, risk reviews', 'Biweekly during active work', 'Virtual or in-person meetings led by Aurelia Project Manager'),\n    ('NYSDEC staff', 'Progress updates, report reviews as requested by NFWB', 'At key milestones', 'Coordinated by NFWB with Aurelia technical support'),\n    ('Residents and businesses', 'Door hangers, press releases, field crew interactions', 'Per field activity', 'Resident notifications coordinated with NFWB; Aurelia field staff on site'),\n    ('Emergency services and local authorities', 'Advance notifications for smoke testing and traffic control', 'Per applicable activity', 'NFWB operations with input from Aurelia')\n]\n\nfor aud, ctype, freq, chan in rows:\n    row_cells = table.add_row().cells\n    row_cells[0].text = aud\n    row_cells[1].text = ctype\n    row_cells[2].text = freq\n    row_cells[3].text = chan\n\n# Risk register table\n\ntable = doc.add_table(rows=1, cols=5)\ntable.style = 'Table Grid'\ntable.alignment = WD_TABLE_ALIGNMENT.CENTER\nhdr = table.rows[0].cells\nhdr[0].text = 'Risk'\nhdr[1].text = 'Likelihood'\nhdr[2].text = 'Impact'\nhdr[3].text = 'Mitigation'\nhdr[4].text = 'Contingency'\nfor cell in hdr:\n    for run in cell.paragraphs[0].runs:\n        run.bold = True\n\nrows = [\n    ('Delay in receiving data or approvals', 'Medium', 'High', 'Early data requests; clear decision deadlines; escalation paths', 'Resequence fieldwork; allocate additional analysis resources'),\n    ('Weather impacts on field activities', 'High', 'Medium', 'Plan multiple windows; maintain flexible crew scheduling', 'Extend field window; adjust sequence of basins'),\n    ('Resident concerns or access issues', 'Medium', 'Medium', 'Proactive communication; clear contact information; coordination with NFWB', 'Reschedule activities; deploy additional outreach support'),\n    ('Safety incident in field', 'Low', 'High', 'Comprehensive health and safety plan; training; job hazard analyses', 'Pause work; incident investigation; corrective actions')\n]\n\nfor risk, lik, imp, mit, cont in rows:\n    row_cells = table.add_row().cells\n    row_cells[0].text = risk\n    row_cells[1].text = lik\n    row_cells[2].text = imp\n    row_cells[3].text = mit\n    row_cells[4].text = cont\n\n# 10. Cost Proposal, Level of Effort, and Invoicing\n\ndoc.add_page_break()\n\nh1 = doc.add_heading('10. Cost Proposal, Level of Effort, and Invoicing', level=1)\n\npara = doc.add_paragraph('Aurelia will provide a detailed cost proposal under separate cover, including a task/hour estimate matrix by labor category, not-to-exceed fee, and the required $10,000 contingency for Task 6. We accept NFWB’s 60-day payment terms, sales tax exemption, and monthly invoicing requirements with supporting documentation.', style='Normal')\n\n# Seaborn pie chart showing cost distribution by major task group\nlabels = ['Field investigations', 'Analysis and modeling', 'Reporting and management', 'Contingency']\nsizes = [50, 20, 25, 5]\nfig, ax = plt.subplots(figsize=(5, 5))\nax.pie(sizes, labels=labels, autopct='%1.0f%%', startangle=140)\nax.axis('equal')\nplt.title('Illustrative cost distribution by major task group')\nplt.tight_layout()\nCost_pie_path = output_dir / 'cost_distribution_pie.png'\nplt.savefig(Cost_pie_path, dpi=150, bbox_inches='tight', facecolor='white')\nplt.close()\n\ndoc.add_picture(str(Cost_pie_path), width=Inches(4.5))\nadd_caption('Figure 30: Illustrative distribution of costs across major task groups')\n\n# Task/hour estimate matrix table (structure)\n\ntable = doc.add_table(rows=1, cols=5)\ntable.style = 'Table Grid'\ntable.alignment = WD_TABLE_ALIGNMENT.CENTER\nhdr = table.rows[0].cells\nhdr[0].text = 'Task'\nhdr[1].text = 'Role'\nhdr[2].text = 'Estimated hours'\nhdr[3].text = 'Billing rate'\nhdr[4].text = 'Extended amount'\nfor cell in hdr:\n    for run in cell.paragraphs[0].runs:\n        run.bold = True\n\nrows = [\n    ('Task 1 – Project management and data review', 'Project Manager, Data Lead', 'Illustrative values to be finalized', 'Standard hourly rates', 'Calculated in detailed cost proposal'),\n    ('Task 2 – Smoke testing', 'Field Operations Lead, field technicians', 'Illustrative values to be finalized', 'Standard hourly rates', 'Calculated in detailed cost proposal'),\n    ('Task 6 – Focused SSES', 'Field Operations Lead, technicians, analysts', 'As authorized up to $10,000', 'Standard hourly rates', 'Capped at $10,000 contingency')\n]\n\nfor task, role, hrs, rate, amount in rows:\n    row_cells = table.add_row().cells\n    row_cells[0].text = task\n    row_cells[1].text = role\n    row_cells[2].text = hrs\n    row_cells[3].text = rate\n    row_cells[4].text = amount\n\n# Not-to-exceed fee summary table\n\ntable = doc.add_table(rows=1, cols=4)\ntable.style = 'Table Grid'\ntable.alignment = WD_TABLE_ALIGNMENT.CENTER\nhdr = table.rows[0].cells\nhdr[0].text = 'Component'\nhdr[1].text = 'Description'\nhdr[2].text = 'Basis'\nhdr[3].text = 'Not to exceed amount'\nfor cell in hdr:\n    for run in cell.paragraphs[0].runs:\n        run.bold = True\n\nrows = [\n    ('Base Phase 1 services', 'Tasks 1–8 exclusive of contingency', 'Time and materials with cap', 'To be provided in cost form'),\n    ('Task 6 contingency', 'Focused SSES and unforeseen necessary work', 'Capped contingency', '$10,000'),\n    ('Phase 2 Option 1', 'Phase 2 SSES in 81st and Frontier 2 and 80th and Lindbergh', 'Time and materials with cap', 'To be provided in cost form'),\n    ('Phase 3 Option 2', 'Phase 3 SSES in Mang and 88th including one outfall assessment', 'Time and materials with cap', 'To be provided in cost form')\n]\n\nfor comp, desc, basis, amt in rows:\n    row_cells = table.add_row().cells\n    row_cells[0].text = comp\n    row_cells[1].text = desc\n    row_cells[2].text = basis\n    row_cells[3].text = amt\n\n# Billing and invoicing terms acknowledgment table\n\ntable = doc.add_table(rows=1, cols=3)\ntable.style = 'Table Grid'\ntable.alignment = WD_TABLE_ALIGNMENT.CENTER\nhdr = table.rows[0].cells\nhdr[0].text = 'Requirement'\nhdr[1].text = 'Description'\nhdr[2].text = 'Aurelia acknowledgment'\nfor cell in hdr:\n    for run in cell.paragraphs[0].runs:\n        run.bold = True\n\nrows = [\n    ('Monthly invoicing with documentation', 'Invoices must include task-level detail and supporting documentation', 'Accepted; Aurelia will provide task-level timesheets and summaries'),\n    ('Prevailing wage and MWBE/SDVOB reporting', 'Compliance with labor and reporting requirements is a condition of payment', 'Accepted; Aurelia will coordinate with subconsultants to ensure timely reporting'),\n    ('60-day payment terms and tax exemption', 'NFWB pays within 60 days; NFWB is exempt from certain taxes', 'Accepted; pricing is exclusive of sales tax'),\n]\n\nfor req, desc, ack in rows:\n    row_cells = table.add_row().cells\n    row_cells[0].text = req\n    row_cells[1].text = desc\n    row_cells[2].text = ack\n\n# 11. MWBE and SDVOB Participation Strategy\n\ndoc.add_page_break()\n\nh1 = doc.add_heading('11. MWBE and SDVOB Participation Strategy', level=1)\n\npara = doc.add_paragraph('Aurelia is committed to meeting or exceeding the MWBE and SDVOB participation goals established in Appendix F, including a combined 30 percent MWBE goal and a 6 percent SDVOB goal. We will submit MWBE and SDVOB utilization plans or waiver requests with the proposal as required and will provide ongoing utilization and workforce reporting throughout the contract.', style='Normal')\n\n# Mermaid process diagram for MWBE/SDVOB engagement\nmermaid_code = '''\nflowchart TD\n  A[Identify MWBE and SDVOB firms] --> B[Prequalify capabilities]\n  B --> C[Develop utilization plan]\n  C --> D[Execute subcontracts]\n  D --> E[Track utilization]\n  E --> F[Report to NFWB]\n'''\nmwbe_path = render_mermaid(mermaid_code, 'mwbe_process')\ndoc.add_picture(str(mwbe_path), width=Inches(5.5))\nadd_caption('Figure 31: MWBE and SDVOB engagement and reporting process')\n\n# Stacked bar chart showing planned contract value by vendor type\nvendor_types = ['Planned participation']\nprime = [64]\nmwbe = [30]\nsdvob = [6]\n\nind = np.arange(len(vendor_types))\nwidth = 0.5\n\nfig, ax = plt.subplots(figsize=(4, 4))\np1 = ax.bar(ind, prime, width, label='Prime (Aurelia)')\np2 = ax.bar(ind, mwbe, width, bottom=prime, label='MWBE subconsultants')\nbottom3 = np.array(prime) + np.array(mwbe)\np3 = ax.bar(ind, sdvob, width, bottom=bottom3, label='SDVOB subconsultants')\nax.set_xticks(ind)\nax.set_xticklabels(vendor_types)\nax.set_ylabel('Percent of contract value')\nax.set_ylim(0, 100)\nax.legend(fontsize=8)\nplt.title('Illustrative MWBE and SDVOB participation against goals')\nplt.tight_layout()\nstacked_path = output_dir / 'mwbe_sdvob_stacked.png'\nplt.savefig(stacked_path, dpi=150, bbox_inches='tight', facecolor='white')\nplt.close()\n\ndoc.add_picture(str(stacked_path), width=Inches(4.5))\nadd_caption('Figure 32: Illustrative distribution of contract value by vendor type')\n\n# MWBE/SDVOB utilization plan table\n\ntable = doc.add_table(rows=1, cols=5)\ntable.style = 'Table Grid'\ntable.alignment = WD_TABLE_ALIGNMENT.CENTER\nhdr = table.rows[0].cells\nhdr[0].text = 'Firm'\nhdr[1].text = 'Certification type'\nhdr[2].text = 'Scope of work'\nhdr[3].text = 'Estimated dollar participation'\nhdr[4].text = 'Estimated percent of contract'\nfor cell in hdr:\n    for run in cell.paragraphs[0].runs:\n        run.bold = True\n\nrows = [\n    ('Field services MWBE firm', 'NYS-certified MWBE', 'Smoke testing, flow isolation support, CCTV crews', 'To be finalized in utilization plan', 'Approximately 20 percent (target)'),\n    ('Local SDVOB engineering partner', 'NYS-certified SDVOB', 'Resident outreach, coordination, selected design support', 'To be finalized in utilization plan', 'Approximately 6 percent (target)'),\n]\n\nfor firm, cert, scope, dol, pct in rows:\n    row_cells = table.add_row().cells\n    row_cells[0].text = firm\n    row_cells[1].text = cert\n    row_cells[2].text = scope\n    row_cells[3].text = dol\n    row_cells[4].text = pct\n\n# Reporting calendar table\n\ntable = doc.add_table(rows=1, cols=3)\ntable.style = 'Table Grid'\ntable.alignment = WD_TABLE_ALIGNMENT.CENTER\nhdr = table.rows[0].cells\nhdr[0].text = 'Report type'\nhdr[1].text = 'Frequency'\nhdr[2].text = 'Content summary'\nfor cell in hdr:\n    for run in cell.paragraphs[0].runs:\n        run.bold = True\n\nrows = [\n    ('MWBE and SDVOB utilization report', 'Monthly during active work', 'Contract value awarded and paid to each MWBE and SDVOB firm, by task'),\n    ('Workforce Employment Utilization Report', 'Monthly or as required', 'Workforce hours by trade, gender, and race/ethnicity'),\n    ('EEO Staffing Plan updates', 'As needed', 'Updates to staffing plan when key personnel change')\n]\n\nfor rtype, freq, cont in rows:\n    row_cells = table.add_row().cells\n    row_cells[0].text = rtype\n    row_cells[1].text = freq\n    row_cells[2].text = cont\n\n# 12. Regulatory, Legal, and Contractual Compliance\n\ndoc.add_page_break()\n\nh1 = doc.add_heading('12. Regulatory, Legal, and Contractual Compliance', level=1)\n\npara = doc.add_paragraph('Aurelia acknowledges and accepts the regulatory, legal, and contractual requirements set forth in the RFP, Appendix E, and Appendix F, including compliance with NYSDEC and NYS EFC requirements, the Order on Consent, MWBE and SDVOB obligations, insurance and indemnification requirements, FOIL and data security obligations, prevailing wage, non-discrimination, and other standard terms. Any exceptions, if necessary, will be clearly identified in the Exceptions Attachment.', style='Normal')\n\n# Compliance matrix table\n\ntable = doc.add_table(rows=1, cols=4)\ntable.style = 'Table Grid'\ntable.alignment = WD_TABLE_ALIGNMENT.CENTER\nhdr = table.rows[0].cells\nhdr[0].text = 'Requirement area'\nhdr[1].text = 'Relevant REQ IDs'\nhdr[2].text = 'Proposal sections addressing requirement'\nhdr[3].text = 'Acceptance status'\nfor cell in hdr:\n    for run in cell.paragraphs[0].runs:\n        run.bold = True\n\nrows = [\n    ('NYSDEC and EPG compliance', 'REQ-006, REQ-014, REQ-015, REQ-030', 'Sections 3, 4, 4.7, 4.8, 8, 14', 'Accepted'),\n    ('MWBE and SDVOB goals and reporting', 'REQ-019, REQ-020, REQ-027', 'Sections 10, 11, 13', 'Accepted; utilization plans to be submitted'),\n    ('Insurance and indemnification', 'REQ-024, REQ-025', 'Section 12, 13', 'Accepted; Aurelia carries required coverages'),\n    ('Restricted communications and addenda', 'REQ-003, REQ-004, REQ-034', 'Sections 2, 9', 'Accepted'),\n    ('NFWB reserved rights and contract incorporation', 'REQ-028', 'Sections 1, 12', 'Acknowledged'),\n]\n\nfor area, reqs, secs, status in rows:\n    row_cells = table.add_row().cells\n    row_cells[0].text = area\n    row_cells[1].text = reqs\n    row_cells[2].text = secs\n    row_cells[3].text = status\n\n# Insurance coverage table\n\ntable = doc.add_table(rows=1, cols=4)\ntable.style = 'Table Grid'\ntable.alignment = WD_TABLE_ALIGNMENT.CENTER\nhdr = table.rows[0].cells\nhdr[0].text = 'Coverage type'\nhdr[1].text = 'Limit (illustrative)'\nhdr[2].text = 'Carrier rating'\nhdr[3].text = 'Additional insured capability'\nfor cell in hdr:\n    for run in cell.paragraphs[0].runs:\n        run.bold = True\n\nrows = [\n    ('Workers compensation and disability', 'Statutory', 'Rated A or better', 'Certificates naming required entities as additional insureds where applicable'),\n    ('Commercial general liability', '$1,000,000 per occurrence, $2,000,000 aggregate or higher', 'Rated A or better', 'Primary and non-contributory additional insured'),\n    ('Automobile liability', '$1,000,000 combined single limit', 'Rated A or better', 'Additional insured endorsement'),\n    ('Umbrella or excess liability', '$5,000,000 aggregate or higher', 'Rated A or better', 'Follows form over primary policies'),\n    ('Professional liability', '$2,000,000 each claim and aggregate or higher', 'Rated A or better', 'Evidence of coverage provided; additional insured where available')\n]\n\nfor cov, lim, carr, ai in rows:\n    row_cells = table.add_row().cells\n    row_cells[0].text = cov\n    row_cells[1].text = lim\n    row_cells[2].text = carr\n    row_cells[3].text = ai\n\n# 13. Forms, Certifications, and Exceptions Attachment\n\ndoc.add_page_break()\n\nh1 = doc.add_heading('13. Forms, Certifications, and Exceptions Attachment', level=1)\n\npara = doc.add_paragraph('Aurelia will complete and submit all required Appendix E forms and any required MWBE/SDVOB and EEO documentation with the proposal. Any exceptions to the RFP or contract terms will be clearly identified in a separate Exceptions Attachment as required.', style='Normal')\n\n# Checklist table of completed forms\n\ntable = doc.add_table(rows=1, cols=4)\ntable.style = 'Table Grid'\ntable.alignment = WD_TABLE_ALIGNMENT.CENTER\nhdr = table.rows[0].cells\nhdr[0].text = 'Form or attachment'\nhdr[1].text = 'Description'\nhdr[2].text = 'Signature status'\nhdr[3].text = 'Location in proposal'\nfor cell in hdr:\n    for run in cell.paragraphs[0].runs:\n        run.bold = True\n\nrows = [\n    ('Appendix E Form 1', 'Acknowledgement of Addenda', 'Original signed by authorized officer', 'Forms section (back of proposal)'),\n    ('Appendix E Form 2', 'Certificate of Non-Collusion', 'Original signed', 'Forms section'),\n    ('Appendix E Form 3', 'Lobbying Law Disclosure', 'Original signed', 'Forms section'),\n    ('Appendix E Form 4', 'EEO Policy Statement', 'Original signed', 'Forms section'),\n    ('Appendix E Form 5', 'Statement on Sexual Harassment', 'Original signed', 'Forms section'),\n    ('Appendix E Form 6', 'RFP Acknowledgement and Certification', 'Original signed', 'Forms section'),\n    ('MWBE and SDVOB utilization plans or waivers', 'Required Appendix F documentation', 'Signed as applicable', 'Forms section'),\n    ('EEO Staffing Plan', 'Staffing plan for contract workforce', 'Signed', 'Forms section'),\n    ('Exceptions Attachment', 'Statement of any exceptions to RFP or contract terms', 'Signed if applicable', 'Immediately following forms')\n]\n\nfor form, desc, sig, loc in rows:\n    row_cells = table.add_row().cells\n    row_cells[0].text = form\n    row_cells[1].text = desc\n    row_cells[2].text = sig\n    row_cells[3].text = loc\n\n# 14. Alignment with Aurelia Delivery Model and Quality Assurance\n\ndoc.add_page_break()\n\nh1 = doc.add_heading('14. Alignment with Aurelia Delivery Model and Quality Assurance', level=1)\n\npara = doc.add_paragraph('Aurelia delivers complex initiatives using an iterative delivery model with formal governance, security, and quality controls. For the Phase 1 SSES, we align our standard phases—Initiate, Discover, Design, Build, Deploy, Operate and Improve—with the SSES tasks and deliverables to ensure disciplined execution and audit-ready evidence for regulators.', style='Normal')\n\n# Mermaid mapping of Aurelia phases to SSES tasks\nmermaid_code = '''\nflowchart LR\n  Init[Initiate] --> Disc[Discover]\n  Disc --> Des[Design]\n  Des --> Build[Build]\n  Build --> Dep[Deploy]\n  Dep --> Oper[Operate and improve]\n  Init --> T1[Task 1]\n  Disc --> T2[Task 2]\n  Disc --> T3[Task 3]\n  Des --> T4[Task 4]\n  Des --> T5[Task 5]\n  Build --> T6[Task 6]\n  Build --> T7[Task 7]\n  Oper --> T8[Task 8]\n'''\nphases_map_path = render_mermaid(mermaid_code, 'aurelia_phases_map')\ndoc.add_picture(str(phases_map_path), width=Inches(5.8))\nadd_caption('Figure 33: Alignment of Aurelia delivery phases with SSES tasks')\n\n# Quality and governance practices table\n\ntable = doc.add_table(rows=1, cols=4)\ntable.style = 'Table Grid'\ntable.alignment = WD_TABLE_ALIGNMENT.CENTER\nhdr = table.rows[0].cells\nhdr[0].text = 'Aurelia practice'\nhdr[1].text = 'Description'\nhdr[2].text = 'SSES milestone'\nhdr[3].text = 'Evidence produced'\nfor cell in hdr:\n    for run in cell.paragraphs[0].runs:\n        run.bold = True\n\nrows = [\n    ('Stage gates', 'Formal decision points with documented approvals', 'End of Initiate, Discover, Design phases', 'Stage gate checklists, approval emails, decision logs'),\n    ('Design reviews', 'Peer review of technical methods and assumptions', 'Before finalizing flow monitoring plan and corrective action plan', 'Review comments, revised plans, sign-offs'),\n    ('Security and privacy checkpoints', 'Review of data handling and privacy considerations', 'Before handling resident-level data or sensitive infrastructure data', 'Data handling procedures, access controls, training records'),\n    ('Quality assurance review of reports', 'Independent review of Engineering Report and post-construction report', 'Prior to NFWB and NYSDEC submissions', 'QA review memos, resolved comment logs')\n]\n\nfor prac, desc, mile, evid in rows:\n    row_cells = table.add_row().cells\n    row_cells[0].text = prac\n    row_cells[1].text = desc\n    row_cells[2].text = mile\n    row_cells[3].text = evid\n\n# 15. Interview and Presentation Readiness\n\ndoc.add_page_break()\n\nh1 = doc.add_heading('15. Interview and Presentation Readiness', level=1)\n\npara = doc.add_paragraph('Aurelia is prepared to participate in informal interviews with NFWB staff and to deliver presentations to the Water Board or staff as part of the evaluation process. During these sessions, we will walk through our technical approach, schedule, and innovations, and we will respond to questions about alternative methods for furnishing services.', style='Normal')\n\n# Interview/presentation team table\n\ntable = doc.add_table(rows=1, cols=3)\ntable.style = 'Table Grid'\ntable.alignment = WD_TABLE_ALIGNMENT.CENTER\nhdr = table.rows[0].cells\nhdr[0].text = 'Team member'\nhdr[1].text = 'Role in interview/presentation'\nhdr[2].text = 'Topics covered'\nfor cell in hdr:\n    for run in cell.paragraphs[0].runs:\n        run.bold = True\n\nrows = [\n    ('Project Manager – Senior Engineer', 'Lead presenter', 'Overall approach, schedule, coordination with NFWB and NYSDEC, risk management'),\n    ('Field Operations Lead', 'Technical presenter', 'Smoke testing, flow isolation, outfall assessment methods, safety program'),\n    ('Data and Analytics Lead', 'Technical presenter', 'Data integration, I and I analysis, dashboards, and reporting to NYSDEC'),\n    ('Health and Safety Coordinator', 'Supporting presenter', 'Health and safety plan, confined space procedures, coordination with other contractors'),\n]\n\nfor name, role, topics in rows:\n    row_cells = table.add_row().cells\n    row_cells[0].text = name\n    row_cells[1].text = role\n    row_cells[2].text = topics\n\n# End of document code\n"
  },
  "raw_response": "ChatCompletionMessage(content=None, refusal=None, role='assistant', annotations=[], audio=None, function_call=None, tool_calls=[ChatCompletionMessageFunctionToolCall(id='call_djp3VJsQa3jZOOIEzgGFMoXl', function=Function(arguments='{\"document_code\":\"from docx.enum.style import WD_STYLE_TYPE\\\\nfrom docx.oxml.ns import qn\\\\nfrom docx.oxml import OxmlElement\\\\nimport matplotlib.patches as mpatches\\\\nimport datetime as dt\\\\n\\\\nstyles = doc.styles\\\\n\\\\n# Configure Normal style\\\\nnormal = styles[\\'Normal\\']\\\\nnormal.font.name = \\'Calibri\\'\\\\nnormal._element.rPr.rFonts.set(qn(\\'w:eastAsia\\'), \\'Calibri\\')\\\\nnormal.font.size = Pt(11)\\\\n\\\\n# Caption style\\\\nif \\'Caption\\' not in [s.name for s in styles]:\\\\n    cap = styles.add_style(\\'Caption\\', WD_STYLE_TYPE.PARAGRAPH)\\\\n    cap.font.name = \\'Calibri\\'\\\\n    cap.font.size = Pt(9)\\\\n    cap.font.italic = True\\\\n\\\\n\\\\ndef add_caption(text: str):\\\\n    p = doc.add_paragraph(text, style=\\'Caption\\')\\\\n    p.alignment = WD_ALIGN_PARAGRAPH.CENTER\\\\n    return p\\\\n\\\\n\\\\n# Title Page\\\\ntitle = doc.add_heading(\\'Proposal for Phase 1 Sanitary Sewer Evaluation Survey (SSES)\\\\\\\\nLaSalle Area – Niagara Falls Water Board\\', level=0)\\\\ntitle.alignment = WD_ALIGN_PARAGRAPH.CENTER\\\\np_sub = doc.add_paragraph(\\'Submitted by Aurelia Digital Systems\\', style=\\'Normal\\')\\\\np_sub.alignment = WD_ALIGN_PARAGRAPH.CENTER\\\\np_date = doc.add_paragraph(\\'November 2022\\', style=\\'Normal\\')\\\\np_date.alignment = WD_ALIGN_PARAGRAPH.CENTER\\\\n\\\\np_conf = doc.add_paragraph(\\'Internal | Confidential – This proposal is submitted in response to the Niagara Falls Water Board Request for Proposals for Phase 1 SSES services. The proposal is firm and irrevocable for 90 days from the submission deadline.\\', style=\\'Normal\\')\\\\np_conf.paragraph_format.space_before = Pt(18)\\\\n\\\\n# Executive Summary / Cover Letter\\\\ndoc.add_page_break()\\\\n\\\\nh1 = doc.add_heading(\\'1. Cover Letter and Executive Summary\\', level=1)\\\\nh1.paragraph_format.space_before = Pt(12)\\\\n\\\\npara = doc.add_paragraph(\\'Niagara Falls Water Board\\\\\\\\nAttn: Authorized Representative\\\\\\\\nNiagara Falls, New York\\', style=\\'Normal\\')\\\\npara.paragraph_format.space_after = Pt(6)\\\\n\\\\npara = doc.add_paragraph(\\'Aurelia Digital Systems (\\\\\"Aurelia\\\\\") is pleased to submit this proposal to provide professional engineering services for the Phase 1 Sanitary Sewer Evaluation Survey (SSES) in the LaSalle area, specifically the 91st and Luick and 81st and Frontier 1 sewersheds. We also provide optional pricing and schedules for Phase 2 (81st and Frontier 2 and 80th and Lindbergh) and Phase 3 (Mang and 88th), consistent with the Request for Proposals (RFP).\\', style=\\'Normal\\')\\\\npara.paragraph_format.space_after = Pt(6)\\\\n\\\\npara = doc.add_paragraph(\\'We understand that this work is a critical component of Niagara Falls Water Board\\\\\\\\\\'s (NFWB) sanitary sewer overflow (SSO) abatement program under Order on Consent R9020080528-32 and is supported by a New York State Environmental Facilities Corporation (NYS EFC) Wastewater Infrastructure Engineering Planning Grant (EPG). Our approach is built around full alignment with the NYS Department of Environmental Conservation (NYSDEC) Engineering Report Outline for Wastewater Infrastructure Projects (October 1, 2022), the Order on Consent schedule, and all applicable Appendix E and Appendix F requirements.\\', style=\\'Normal\\')\\\\n\\\\npara = doc.add_paragraph(\\'Aurelia differentiates itself by combining traditional SSES field expertise with strong data, analytics, and governance capabilities. We integrate smoke testing, flow isolation, CCTV, manhole inspections, and focused investigations into a single, auditable data model that clearly traces each inflow and infiltration (I&I) source to a recommended corrective action and measured post-construction benefit. Our documentation and visualization practices—including GIS-compatible outputs and regulator-ready reporting—are designed to make complex findings understandable for NFWB, NYSDEC, and the Water Board, supporting timely approvals and funding decisions.\\', style=\\'Normal\\')\\\\n\\\\npara = doc.add_paragraph(\\'We acknowledge and will comply with all administrative requirements, including attending the mandatory pre-proposal information session on November 29, 2022, submitting a sealed proposal by December 5, 2022 at 2:00 p.m., directing all written questions to the authorized contact in accordance with NYS Finance Law 139-j and 139-k, acknowledging all addenda on Appendix E Form No. 1, and maintaining our offer as firm and irrevocable for 90 days. We will submit one clearly marked original, six copies, and one electronic copy of the proposal, and we accept NFWB’s reserved rights and contract terms as outlined in Appendix E and Appendix F, subject to any limited exceptions identified in the Exceptions Attachment.\\', style=\\'Normal\\')\\\\n\\\\npara = doc.add_paragraph(\\'On behalf of Aurelia, I am authorized to commit our firm to perform the Phase 1 SSES and, at NFWB’s option, the Phase 2 and Phase 3 SSES services. We look forward to the opportunity to partner with NFWB to deliver measurable I&I reductions, reduce SSOs, and advance long-term system reliability in the LaSalle area.\\', style=\\'Normal\\')\\\\n\\\\npara = doc.add_paragraph(\\'Sincerely,\\\\\\\\n\\\\\\\\nBusiness Development Office\\\\\\\\nAurelia Digital Systems\\\\\\\\nToronto, Ontario\\\\\\\\nEmail: proposals@aurelia-digital.example\\\\\\\\nPhone: +1 (416) 555-0199\\', style=\\'Normal\\')\\\\n\\\\n# Executive Summary content\\\\nh2 = doc.add_heading(\\'1.1 Executive Summary\\', level=2)\\\\n\\\\npara = doc.add_paragraph(\\'NFWB’s objective is to perform a comprehensive Phase 1 SSES in the LaSalle area that identifies and quantifies I&I sources, develops a cost-effective corrective action plan, and establishes a defensible basis for capital improvements and post-construction monitoring. The work must align with NYSDEC and NYS EFC expectations and support timely NYSDEC review so that construction can proceed in 2023–early 2024, followed by post-construction monitoring through June 2024.\\', style=\\'Normal\\')\\\\n\\\\npara = doc.add_paragraph(\\'Our proposed solution centers on four pillars:\\', style=\\'Normal\\')\\\\n\\\\ndoc.add_paragraph(\\'Regulatory alignment: We organize our scope, schedule, and deliverables around the Order on Consent, NYSDEC’s Engineering Report Outline, and EPG requirements, ensuring that all technical work products are directly mapped to regulatory expectations and consent order milestones.\\', style=\\'List Bullet\\')\\\\ndoc.add_paragraph(\\'Data-driven SSES: We integrate smoke testing, flow isolation, CCTV, manhole data, and focused investigations into a unified geospatial data environment, enabling transparent prioritization of corrective actions based on I&I reduction potential, constructability, and cost-effectiveness.\\', style=\\'List Bullet\\')\\\\ndoc.add_paragraph(\\'Strong governance and communication: We provide a single Project Manager, structured coordination with NFWB and NYSDEC, clear communication protocols with residents and emergency services, and disciplined project controls for schedule, budget, and risk.\\', style=\\'List Bullet\\')\\\\ndoc.add_paragraph(\\'Safety, MWBE/SDVOB participation, and long-term partnership: We execute all field activities under a robust health and safety program, incorporate meaningful MWBE and SDVOB participation with transparent reporting, and provide a scalable roadmap through Phases 1–3.\\', style=\\'List Bullet\\')\\\\n\\\\npara = doc.add_paragraph(\\'The result is an SSES program that not only meets the RFP’s minimum requirements but also provides NFWB with a defensible, regulator-ready basis for investment decisions and a repeatable framework for subsequent phases.\\', style=\\'Normal\\')\\\\n\\\\n# Mermaid diagram: linkage from Phase 1 to corrective actions to monitoring\\\\nmermaid_code = \\'\\'\\'\\\\nflowchart LR\\\\n  A[Phase 1 SSES tasks] --> B[I and I source identification]\\\\n  B --> C[Corrective action plan]\\\\n  C --> D[Design and construction]\\\\n  D --> E[Post construction monitoring]\\\\n  E --> F[NYSDEC compliance reporting]\\\\n  F --> G[Order on Consent objectives]\\\\n\\'\\'\\'\\\\ndiagram_path = render_mermaid(mermaid_code, \\'phase1_to_compliance\\')\\\\ndoc.add_picture(str(diagram_path), width=Inches(5.8))\\\\nadd_caption(\\'Figure 1: Linkage from Phase 1 SSES through corrective actions to Order on Consent compliance\\')\\\\n\\\\n# Table summarizing Phase 1, Phase 2, Phase 3 scope at a glance\\\\ntable = doc.add_table(rows=4, cols=4)\\\\ntable.style = \\'Table Grid\\'\\\\n table.alignment = WD_TABLE_ALIGNMENT.CENTER\\\\n\\\\nhdr = table.rows[0].cells\\\\nhdr[0].text = \\'Phase\\'\\\\nhdr[1].text = \\'Sewersheds\\'\\\\nhdr[2].text = \\'Key Tasks\\'\\\\nhdr[3].text = \\'Outfall assessments\\'\\\\nfor cell in hdr:\\\\n    for run in cell.paragraphs[0].runs:\\\\n        run.bold = True\\\\n\\\\nrow = table.rows[1].cells\\\\nrow[0].text = \\'Phase 1 (Base)\\'\\\\nrow[1].text = \\'91st and Luick; 81st and Frontier 1\\'\\\\nrow[2].text = \\'Tasks 1–8: project management, smoke testing, flow isolation, CCTV/manhole review, outfall assessment, focused SSES, SSES report, post-construction monitoring\\'\\\\nrow[3].text = \\'Two outfalls/SSOs\\'\\\\n\\\\nrow = table.rows[2].cells\\\\nrow[0].text = \\'Phase 2 (Option 1)\\'\\\\nrow[1].text = \\'81st and Frontier 2; 80th and Lindbergh\\'\\\\nrow[2].text = \\'Tasks 1–4, 6–8 (Task 5 omitted per RFP)\\'\\\\nrow[3].text = \\'None (Task 5 omitted)\\'\\\\n\\\\nrow = table.rows[3].cells\\\\nrow[0].text = \\'Phase 3 (Option 2)\\'\\\\nrow[1].text = \\'Mang and 88th\\'\\\\nrow[2].text = \\'Tasks 1–8 scaled to Phase 3 scope\\'\\\\nrow[3].text = \\'One outfall/SSO\\'\\\\n\\\\n# 2. Administrative Compliance and Proposal Submission Plan\\\\ndoc.add_page_break()\\\\n\\\\nh1 = doc.add_heading(\\'2. Administrative Compliance and Proposal Submission Plan\\', level=1)\\\\n\\\\npara = doc.add_paragraph(\\'Aurelia will comply with all administrative, submission, and communication requirements of the RFP. Our internal proposal management process is designed to ensure that mandatory conditions are satisfied and documented, and that all interactions with NFWB comply with NYS Finance Law 139-j and 139-k restricted communications rules.\\', style=\\'Normal\\')\\\\n\\\\n# Mermaid timeline diagram of pre-award milestones\\\\nmermaid_code = \\'\\'\\'\\\\nflowchart LR\\\\n  A[Pre proposal meeting Nov 29] --> B[Questions deadline]\\\\n  B --> C[Addenda issued]\\\\n  C --> D[Proposal due Dec 5]\\\\n  D --> E[Ninety day hold period]\\\\n\\'\\'\\'\\\\nadmin_timeline_path = render_mermaid(mermaid_code, \\'admin_timeline\\')\\\\ndoc.add_picture(str(admin_timeline_path), width=Inches(5.5))\\\\nadd_caption(\\'Figure 2: Key pre-award administrative milestones\\')\\\\n\\\\n# Administrative requirements checklist table\\\\ntable = doc.add_table(rows=1, cols=4)\\\\ntable.style = \\'Table Grid\\'\\\\ntable.alignment = WD_TABLE_ALIGNMENT.CENTER\\\\nhdr = table.rows[0].cells\\\\nhdr[0].text = \\'Administrative requirement\\'\\\\nhdr[1].text = \\'Reference (REQ)\\'\\\\nhdr[2].text = \\'Responsible party\\'\\\\nhdr[3].text = \\'Status at submission\\'\\\\nfor cell in hdr:\\\\n    for run in cell.paragraphs[0].runs:\\\\n        run.bold = True\\\\n\\\\nrows = [\\\\n    (\\'Attend mandatory pre-proposal information session at WWTP on November 29, 2022 at noon\\', \\'REQ-001\\', \\'Aurelia Proposal Manager\\', \\'Will attend; documented in internal log\\'),\\\\n    (\\'Submit sealed proposal by December 5, 2022 at 2:00 p.m. with required copies and electronic PDF\\', \\'REQ-002, REQ-021\\', \\'Aurelia Proposal Manager\\', \\'Compliant at submission\\'),\\\\n    (\\'Direct all written questions to authorized contact; comply with NYS Finance Law 139-j and 139-k\\', \\'REQ-003\\', \\'Aurelia Proposal Manager\\', \\'Compliant; no unauthorized contacts\\'),\\\\n    (\\'Email authorized contact to be added to distribution list; acknowledge all addenda on Appendix E Form 1\\', \\'REQ-004, REQ-018\\', \\'Aurelia Proposal Manager\\', \\'Compliant; all addenda acknowledged\\'),\\\\n    (\\'Maintain proposal as firm and irrevocable for 90 days from submission deadline\\', \\'REQ-022\\', \\'Aurelia Authorized Signatory\\', \\'Explicitly accepted in cover letter\\'),\\\\n    (\\'Submit one original, six copies, and one electronic copy on USB or CD in sealed, labeled envelope\\', \\'REQ-021\\', \\'Aurelia Proposal Coordinator\\', \\'Compliant at submission\\')\\\\n]\\\\n\\\\nfor req, ref, resp, status in rows:\\\\n    row_cells = table.add_row().cells\\\\n    row_cells[0].text = req\\\\n    row_cells[1].text = ref\\\\n    row_cells[2].text = resp\\\\n    row_cells[3].text = status\\\\n\\\\n# 3. Understanding of NFWB Objectives, System, and Regulatory Context\\\\n\\\\ndoc.add_page_break()\\\\n\\\\nh1 = doc.add_heading(\\'3. Understanding of NFWB Objectives, System, and Regulatory Context\\', level=1)\\\\n\\\\npara = doc.add_paragraph(\\'NFWB is implementing a multi-phase SSO abatement program in the LaSalle area under Order on Consent R9020080528-32. The Phase 1 SSES in the 91st and Luick and 81st and Frontier 1 sewersheds is intended to identify and quantify I&I sources, support development of a cost-effective corrective action plan, and establish a baseline for post-construction monitoring. The work is funded in part by a NYS EFC Engineering Planning Grant, which requires adherence to NYSDEC’s Engineering Report Outline and EPG terms and conditions.\\', style=\\'Normal\\')\\\\n\\\\npara = doc.add_paragraph(\\'Based on our review of the RFP, Order on Consent, and typical LaSalle system characteristics, we understand the following key drivers:\\', style=\\'Normal\\')\\\\n\\\\ndoc.add_paragraph(\\'High wet-weather peaking factors and SSO events at LaSalle outfalls and regulators, driven by inflow from roof leaders, yard drains, and cross-connections, as well as groundwater infiltration through defective mains, laterals, and manholes.\\', style=\\'List Bullet\\')\\\\ndoc.add_paragraph(\\'Regulatory pressure to demonstrate measurable I&I reductions, document the most effective corrective techniques, and align capital improvements with NYSDEC’s SSO abatement expectations and funding priorities.\\', style=\\'List Bullet\\')\\\\ndoc.add_paragraph(\\'Need for a defensible, data-driven Engineering Report and Post-Construction I&I Assessment that can withstand regulatory review and support future grant and loan applications.\\', style=\\'List Bullet\\')\\\\ndoc.add_paragraph(\\'Operational constraints related to resident communications, access to easements and backyards, coordination with NFWB operations and other contractors, and seasonal limitations for smoke testing and flow monitoring.\\', style=\\'List Bullet\\')\\\\n\\\\n# Mermaid system context diagram\\\\nmermaid_code = \\'\\'\\'\\\\nflowchart LR\\\\n  A[LaSalle sewersheds] --> B[Collection system]\\\\n  B --> C[Outfalls and SSOs]\\\\n  B --> D[Monitoring points]\\\\n  D --> E[NFWB data systems]\\\\n  E --> F[Aurelia analysis]\\\\n  F --> G[NYSDEC reports]\\\\n\\'\\'\\'\\\\ncontext_path = render_mermaid(mermaid_code, \\'system_context\\')\\\\ndoc.add_picture(str(context_path), width=Inches(5.8))\\\\nadd_caption(\\'Figure 3: LaSalle sewershed and regulatory reporting context\\')\\\\n\\\\n# Seaborn bar chart: illustrative SSO/I&I drivers\\\\nplt.figure(figsize=(6, 4))\\\\nsns.set_style(\\'whitegrid\\')\\\\ndata = pd.DataFrame({\\\\n    \\'Category\\': [\\'Smoke test defects\\', \\'Inflow sources\\', \\'Structural defects\\', \\'Manhole defects\\', \\'Unknown/other\\'],\\\\n    \\'Relative contribution\\': [30, 25, 25, 15, 5]\\\\n})\\\\nax = sns.barplot(data=data, x=\\'Category\\', y=\\'Relative contribution\\', color=\\'#4c72b0\\')\\\\nax.set_ylabel(\\'Relative contribution (percent)\\')\\\\nax.set_xlabel(\\'I and I driver category\\')\\\\nax.set_title(\\'Illustrative composition of I and I and SSO drivers\\')\\\\nplt.xticks(rotation=20, ha=\\'right\\')\\\\nplt.tight_layout()\\\\nchart_path = output_dir / \\'iandi_drivers_bar.png\\'\\\\nplt.savefig(chart_path, dpi=150, bbox_inches=\\'tight\\', facecolor=\\'white\\')\\\\nplt.close()\\\\n\\\\ndoc.add_picture(str(chart_path), width=Inches(5.8))\\\\nadd_caption(\\'Figure 4: Illustrative distribution of I and I and SSO drivers by category\\')\\\\n\\\\n# Table mapping regulatory/Order on Consent requirements to deliverables\\\\n\\\\ntable = doc.add_table(rows=1, cols=4)\\\\ntable.style = \\'Table Grid\\'\\\\ntable.alignment = WD_TABLE_ALIGNMENT.CENTER\\\\nhdr = table.rows[0].cells\\\\nhdr[0].text = \\'Regulatory / consent requirement\\'\\\\nhdr[1].text = \\'Planned deliverable\\'\\\\nhdr[2].text = \\'Key checkpoint\\'\\\\nhdr[3].text = \\'Related REQ IDs\\'\\\\nfor cell in hdr:\\\\n    for run in cell.paragraphs[0].runs:\\\\n        run.bold = True\\\\n\\\\nrows = [\\\\n    (\\'Order on Consent R9020080528-32 SSO abatement schedule\\', \\'Phase 1 SSES Engineering Report and corrective action plan\\', \\'Draft and final SSES report submissions to NFWB and NYSDEC\\', \\'REQ-005, REQ-007, REQ-014, REQ-030\\'),\\\\n    (\\'NYSDEC Engineering Report Outline (Oct 1, 2022)\\', \\'Engineering Report structured to NYSDEC outline with traceable appendices and calculations\\', \\'Internal Aurelia QA review and NFWB technical review prior to NYSDEC submittal\\', \\'REQ-006, REQ-014\\'),\\\\n    (\\'EPG grant terms and conditions\\', \\'Grant-compliant work plan, schedule, and documentation of eligible costs\\', \\'Coordination with NFWB on EPG reporting and reimbursement packages\\', \\'REQ-006\\'),\\\\n    (\\'Post-construction I and I assessment requirement\\', \\'Post-Construction I and I Assessment and Cost Analysis Report\\', \\'Completion of 2024 monitoring period and joint review with NFWB\\', \\'REQ-015, REQ-030\\')\\\\n]\\\\n\\\\nfor reg, deliv, chk, refs in rows:\\\\n    row_cells = table.add_row().cells\\\\n    row_cells[0].text = reg\\\\n    row_cells[1].text = deliv\\\\n    row_cells[2].text = chk\\\\n    row_cells[3].text = refs\\\\n\\\\n# 4. Detailed Technical Approach – Phase 1 SSES Tasks 1–8\\\\n\\\\ndoc.add_page_break()\\\\n\\\\nh1 = doc.add_heading(\\'4. Detailed Technical Approach – Phase 1 SSES Tasks 1–8\\', level=1)\\\\n\\\\npara = doc.add_paragraph(\\'Our technical approach executes all required Phase 1 SSES tasks (1–8) in the 91st and Luick and 81st and Frontier 1 sewersheds, meeting or exceeding the RFP’s minimum scope. We sequence tasks to maximize data value, de-risk schedule-critical activities, and maintain clear traceability from field observations to corrective actions and post-construction performance.\\', style=\\'Normal\\')\\\\n\\\\n# Mermaid flowchart for end-to-end SSES workflow\\\\nmermaid_code = \\'\\'\\'\\\\nflowchart TD\\\\n  A[Task 1 data review] --> B[Task 2 smoke testing]\\\\n  B --> C[Task 3 flow isolation]\\\\n  C --> D[Task 4 CCTV and manholes]\\\\n  D --> E[Task 5 outfall assessment]\\\\n  E --> F[Task 6 focused SSES]\\\\n  F --> G[Task 7 SSES report]\\\\n  G --> H[Task 8 post construction monitoring]\\\\n\\'\\'\\'\\\\nworkflow_path = render_mermaid(mermaid_code, \\'sses_workflow\\')\\\\ndoc.add_picture(str(workflow_path), width=Inches(5.8))\\\\nadd_caption(\\'Figure 5: End-to-end Phase 1 SSES workflow\\')\\\\n\\\\n# Mermaid sequence diagram for interactions during field activities\\\\nmermaid_code = \\'\\'\\'\\\\nsequenceDiagram\\\\n  participant Resident\\\\n  participant NFWB\\\\n  participant Aurelia\\\\n  participant NYSDEC\\\\n  NFWB->>Aurelia: Authorize smoke testing and flow isolation\\\\n  Aurelia->>NFWB: Submit notifications and traffic control plans\\\\n  NFWB->>Resident: Issue public notices\\\\n  Aurelia->>Resident: Deliver door hangers and answer questions\\\\n  Aurelia->>Aurelia: Perform smoke testing and flow isolation\\\\n  Aurelia->>NFWB: Report interim findings\\\\n  NFWB->>NYSDEC: Provide status updates as needed\\\\n\\'\\'\\'\\\\nseq_path = render_mermaid(mermaid_code, \\'field_sequence\\')\\\\ndoc.add_picture(str(seq_path), width=Inches(5.8))\\\\nadd_caption(\\'Figure 6: Coordination among Aurelia, NFWB, NYSDEC, and residents during key field activities\\')\\\\n\\\\n# Gantt-style bar chart for Tasks 1–8 timeline\\\\nschedule = pd.DataFrame({\\\\n    \\'Task\\': [\\\\n        \\'Task 1 Project management and data review\\',\\\\n        \\'Task 2 Smoke testing\\',\\\\n        \\'Task 3 Flow isolation and measurement\\',\\\\n        \\'Task 4 CCTV and manhole analysis\\',\\\\n        \\'Task 5 Outfall and SSO assessment\\',\\\\n        \\'Task 6 Focused SSES\\',\\\\n        \\'Task 7 SSES report and corrective plan\\',\\\\n        \\'Task 8 Post construction monitoring\\'\\\\n    ],\\\\n    \\'Start\\': pd.to_datetime([\\\\n        \\'2022-12-06\\', \\'2023-03-01\\', \\'2023-03-15\\', \\'2023-02-01\\',\\\\n        \\'2023-04-01\\', \\'2023-04-15\\', \\'2023-05-01\\', \\'2024-01-01\\'\\\\n    ]),\\\\n    \\'End\\': pd.to_datetime([\\\\n        \\'2023-01-31\\', \\'2023-03-31\\', \\'2023-04-30\\', \\'2023-04-15\\',\\\\n        \\'2023-05-15\\', \\'2023-06-15\\', \\'2023-06-30\\', \\'2024-06-30\\'\\\\n    ]),\\\\n    \\'Phase\\': [\\\\n        \\'Management\\', \\'Field\\', \\'Field\\', \\'Analysis\\',\\\\n        \\'Field\\', \\'Field\\', \\'Reporting\\', \\'Monitoring\\'\\\\n    ]\\\\n})\\\\n\\\\nproject_start = schedule[\\'Start\\'].min()\\\\nschedule[\\'days_to_start\\'] = (schedule[\\'Start\\'] - project_start).dt.days\\\\nschedule[\\'duration\\'] = (schedule[\\'End\\'] - schedule[\\'Start\\']).dt.days + 1\\\\n\\\\nphase_colors = {\\\\n    \\'Management\\': \\'#1f77b4\\',\\\\n    \\'Field\\': \\'#2ca02c\\',\\\\n    \\'Analysis\\': \\'#9467bd\\',\\\\n    \\'Reporting\\': \\'#ff7f0e\\',\\\\n    \\'Monitoring\\': \\'#8c564b\\'\\\\n}\\\\n\\\\nfig, ax = plt.subplots(figsize=(9, 5))\\\\nfor idx, row in schedule.iterrows():\\\\n    ax.barh(y=row[\\'Task\\'], width=row[\\'duration\\'], left=row[\\'days_to_start\\'],\\\\n            color=phase_colors[row[\\'Phase\\']], edgecolor=\\'white\\', linewidth=0.5)\\\\n\\\\nax.invert_yaxis()\\\\nmax_days = schedule[\\'days_to_start\\'].max() + schedule[\\'duration\\'].max()\\\\nxticks = np.arange(0, max_days + 15, 30)\\\\nxticklabels = pd.date_range(start=project_start, periods=len(xticks), freq=\\'30D\\').strftime(\\'%b %Y\\')\\\\nax.set_xticks(xticks[:len(xticklabels)])\\\\nax.set_xticklabels(xticklabels, fontsize=8, rotation=30, ha=\\'right\\')\\\\nax.set_xlabel(\\'Timeline\\')\\\\nax.set_title(\\'Phase 1 SSES Tasks 1–8 Implementation Timeline\\')\\\\nax.xaxis.grid(True, alpha=0.3, linestyle=\\'--\\')\\\\nax.set_axisbelow(True)\\\\n\\\\nunique_phases = schedule[\\'Phase\\'].unique()\\\\npatches = [mpatches.Patch(color=phase_colors[p], label=p) for p in unique_phases]\\\\nax.legend(handles=patches, loc=\\'lower right\\', fontsize=8, framealpha=0.9)\\\\n\\\\nplt.tight_layout()\\\\ngantt_path = output_dir / \\'phase1_tasks_gantt.png\\'\\\\nplt.savefig(gantt_path, dpi=150, bbox_inches=\\'tight\\', facecolor=\\'white\\')\\\\nplt.close()\\\\n\\\\ndoc.add_picture(str(gantt_path), width=Inches(6.0))\\\\nadd_caption(\\'Figure 7: Proposed schedule and overlap of Phase 1 SSES Tasks 1–8\\')\\\\n\\\\n# Task-by-task methodology summary table\\\\n\\\\ntable = doc.add_table(rows=1, cols=5)\\\\ntable.style = \\'Table Grid\\'\\\\ntable.alignment = WD_TABLE_ALIGNMENT.CENTER\\\\nhdr = table.rows[0].cells\\\\nhdr[0].text = \\'Task\\'\\\\nhdr[1].text = \\'Objectives\\'\\\\nhdr[2].text = \\'Key inputs\\'\\\\nhdr[3].text = \\'Methods and tools\\'\\\\nhdr[4].text = \\'Outputs and success criteria\\'\\\\nfor cell in hdr:\\\\n    for run in cell.paragraphs[0].runs:\\\\n        run.bold = True\\\\n\\\\nrows = [\\\\n    (\\'Task 1 – Project management and data review\\', \\'Establish governance, review existing data, confirm scope and schedule\\', \\'Order on Consent, prior studies, GIS, flow data\\', \\'Structured data inventory, kickoff and coordination meetings, risk and issue logs\\', \\'Approved project management plan, data gap list, agreed schedule\\'),\\\\n    (\\'Task 2 – Smoke testing\\', \\'Identify inflow sources and cross-connections\\', \\'System maps, access constraints, weather forecasts\\', \\'Standard smoke testing procedures, resident notifications, photo documentation\\', \\'GIS-linked defect inventory with severity ratings and recommended follow-up\\'),\\\\n    (\\'Task 3 – Flow isolation and measurement\\', \\'Quantify groundwater infiltration by segment\\', \\'Historical flow and rainfall data, system layout\\', \\'Weir installation, confined space procedures, continuous flow logging, QA/QC checks\\', \\'Segment-level infiltration rates (gpd per linear foot) with confidence intervals\\'),\\\\n    (\\'Task 4 – CCTV and manhole analysis\\', \\'Identify structural and O and M defects contributing to I and I\\', \\'NFWB CCTV videos and logs, manhole inspection data\\', \\'Standardized defect coding, integration into geospatial database\\', \\'Prioritized defect list with recommended structural and O and M interventions\\'),\\\\n    (\\'Task 5 – Outfall and SSO assessment\\', \\'Characterize outfall performance and extraneous flows\\', \\'Existing outfall data, field reconnaissance\\', \\'Flow meters, rain gauges, dye testing, confined space entry where needed\\', \\'GIS-compatible outfall assessment and recommendations to reduce extraneous flows\\'),\\\\n    (\\'Task 6 – Focused SSES\\', \\'Confirm and refine I and I source locations\\', \\'Findings from Tasks 2–5\\', \\'Targeted dye testing, house inspections, additional CCTV\\', \\'Validated source locations and refined corrective actions within contingency budget\\'),\\\\n    (\\'Task 7 – SSES report and corrective plan\\', \\'Prepare NYSDEC-compliant Engineering Report and corrective action plan\\', \\'All SSES data and analyses\\', \\'Report drafting to NYSDEC outline, QA review, PE stamping\\', \\'NYSDEC-acceptable SSES report enabling 2023–2024 construction\\'),\\\\n    (\\'Task 8 – Post-construction monitoring\\', \\'Measure I and I reductions and cost-effectiveness\\', \\'Pre-construction flow and rainfall data, as-built information\\', \\'Flow and rainfall monitoring, statistical comparison, cost-effectiveness analysis\\', \\'Post-Construction I and I Assessment and Cost Analysis Report for NYSDEC\\')\\\\n]\\\\n\\\\nfor task, obj, inp, meth, outp in rows:\\\\n    row_cells = table.add_row().cells\\\\n    row_cells[0].text = task\\\\n    row_cells[1].text = obj\\\\n    row_cells[2].text = inp\\\\n    row_cells[3].text = meth\\\\n    row_cells[4].text = outp\\\\n\\\\n# Risk and mitigation table for major tasks\\\\n\\\\ntable = doc.add_table(rows=1, cols=4)\\\\ntable.style = \\'Table Grid\\'\\\\ntable.alignment = WD_TABLE_ALIGNMENT.CENTER\\\\nhdr = table.rows[0].cells\\\\nhdr[0].text = \\'Task\\'\\\\nhdr[1].text = \\'Key risk\\'\\\\nhdr[2].text = \\'Potential impact\\'\\\\nhdr[3].text = \\'Mitigation and contingency\\'\\\\nfor cell in hdr:\\\\n    for run in cell.paragraphs[0].runs:\\\\n        run.bold = True\\\\n\\\\nrows = [\\\\n    (\\'Task 2 – Smoke testing\\', \\'Adverse weather or frozen ground conditions\\', \\'Delayed testing and incomplete coverage\\', \\'Plan primary and backup testing windows; monitor forecasts; sequence areas to use best conditions first\\'),\\\\n    (\\'Task 3 – Flow isolation and measurement\\', \\'Limited access or traffic control constraints at weir locations\\', \\'Reduced data quality or schedule delays\\', \\'Early coordination with NFWB and local authorities; flexible site selection; use of off-peak work windows\\'),\\\\n    (\\'Task 4 – CCTV and manhole analysis\\', \\'Incomplete or inconsistent CCTV records\\', \\'Data gaps and uncertainty in defect characterization\\', \\'Early data quality review; targeted re-inspections with NFWB crews; standardized coding\\'),\\\\n    (\\'Task 5 – Outfall assessment\\', \\'Confined space entry and safety hazards\\', \\'Safety incidents or restricted data collection\\', \\'Strict confined space procedures; pre-entry hazard assessments; alternative non-entry methods where feasible\\'),\\\\n    (\\'Task 7 – SSES report\\', \\'Late data inputs or extended internal reviews\\', \\'Risk to NYSDEC review timeline and 2023 construction\\', \\'Interim technical memos; rolling data integration; early outline agreement with NFWB and NYSDEC\\'),\\\\n]\\\\n\\\\nfor task, risk, impact, mit in rows:\\\\n    row_cells = table.add_row().cells\\\\n    row_cells[0].text = task\\\\n    row_cells[1].text = risk\\\\n    row_cells[2].text = impact\\\\n    row_cells[3].text = mit\\\\n\\\\n# 4.1 Task 1 – Project Management, Data Review, and Coordination\\\\n\\\\ndoc.add_page_break()\\\\n\\\\nh2 = doc.add_heading(\\'4.1 Task 1 – Project Management, Data Review, and Coordination\\', level=2)\\\\n\\\\npara = doc.add_paragraph(\\'Aurelia will designate a single Project Manager as the primary point of contact for NFWB. The Project Manager will lead project initiation, data review, coordination with NFWB and NYSDEC, and ongoing consultation throughout the SSES. Project governance will align with Aurelia’s delivery model and NFWB’s expectations for transparency, documentation, and regulatory compliance.\\', style=\\'Normal\\')\\\\n\\\\n# Mermaid RACI-style diagram\\\\nmermaid_code = \\'\\'\\'\\\\nflowchart LR\\\\n  PM[Project manager] --> Gov[Project governance]\\\\n  Eng[Technical leads] --> Gov\\\\n  NFWB[NFWB staff] --> Gov\\\\n  NYSDEC[NYSDEC liaison] --> Gov\\\\n  Gov --> Dec[Decisions and approvals]\\\\n\\'\\'\\'\\\\nraci_path = render_mermaid(mermaid_code, \\'task1_raci\\')\\\\ndoc.add_picture(str(raci_path), width=Inches(5.5))\\\\nadd_caption(\\'Figure 8: Roles and responsibilities for project management and coordination\\')\\\\n\\\\n# Coordination meetings table\\\\n\\\\ntable = doc.add_table(rows=1, cols=3)\\\\ntable.style = \\'Table Grid\\'\\\\ntable.alignment = WD_TABLE_ALIGNMENT.CENTER\\\\nhdr = table.rows[0].cells\\\\nhdr[0].text = \\'Meeting\\'\\\\nhdr[1].text = \\'Objectives\\'\\\\nhdr[2].text = \\'Typical participants\\'\\\\nfor cell in hdr:\\\\n    for run in cell.paragraphs[0].runs:\\\\n        run.bold = True\\\\n\\\\nrows = [\\\\n    (\\'Project kickoff\\', \\'Confirm scope, roles, communication protocols, safety expectations, and schedule\\', \\'Aurelia Project Manager and leads, NFWB project manager and operations, key stakeholders\\'),\\\\n    (\\'Data review workshop\\', \\'Review existing GIS, flow data, CCTV, manhole records, and Order on Consent requirements; identify data gaps\\', \\'Aurelia data and modeling leads, NFWB engineering and IT\\'),\\\\n    (\\'Interim findings review\\', \\'Share preliminary SSES findings, refine fieldwork focus, confirm priorities\\', \\'Aurelia technical team, NFWB engineering and operations\\'),\\\\n    (\\'Draft report review\\', \\'Review draft Engineering Report and corrective action plan; align on priorities and phasing\\', \\'Aurelia Project Manager and PE, NFWB leadership and technical staff\\'),\\\\n    (\\'NYSDEC coordination session\\', \\'Discuss key findings, proposed corrective actions, and schedule with regulator\\', \\'Aurelia PE, NFWB leadership, NYSDEC staff as appropriate\\')\\\\n]\\\\n\\\\nfor name, obj, part in rows:\\\\n    row_cells = table.add_row().cells\\\\n    row_cells[0].text = name\\\\n    row_cells[1].text = obj\\\\n    row_cells[2].text = part\\\\n\\\\n# 4.2 Task 2 – Smoke Testing Plan and Execution\\\\n\\\\nh2 = doc.add_heading(\\'4.2 Task 2 – Smoke Testing Plan and Execution\\', level=2)\\\\n\\\\npara = doc.add_paragraph(\\'We will perform smoke testing in the 91st and Luick and 81st and Frontier 1 sewersheds to identify inflow sources such as roof leaders, yard drains, cross-connections, and defective cleanouts. Our approach emphasizes safety, resident communication, and thorough documentation.\\', style=\\'Normal\\')\\\\n\\\\n# Mermaid flowchart of smoke testing workflow\\\\nmermaid_code = \\'\\'\\'\\\\nflowchart TD\\\\n  A[Plan test areas] --> B[Coordinate with NFWB and authorities]\\\\n  B --> C[Issue resident notifications]\\\\n  C --> D[Deploy field crews]\\\\n  D --> E[Conduct smoke testing]\\\\n  E --> F[Document defects]\\\\n  F --> G[Enter data into GIS]\\\\n\\'\\'\\'\\\\nsmoke_path = render_mermaid(mermaid_code, \\'smoke_workflow\\')\\\\ndoc.add_picture(str(smoke_path), width=Inches(5.5))\\\\nadd_caption(\\'Figure 9: Smoke testing planning and execution workflow\\')\\\\n\\\\n# Notification and coordination steps table\\\\n\\\\ntable = doc.add_table(rows=1, cols=4)\\\\ntable.style = \\'Table Grid\\'\\\\ntable.alignment = WD_TABLE_ALIGNMENT.CENTER\\\\nhdr = table.rows[0].cells\\\\nhdr[0].text = \\'Step\\'\\\\nhdr[1].text = \\'Description\\'\\\\nhdr[2].text = \\'Lead time\\'\\\\nhdr[3].text = \\'Responsible party\\'\\\\nfor cell in hdr:\\\\n    for run in cell.paragraphs[0].runs:\\\\n        run.bold = True\\\\n\\\\nrows = [\\\\n    (\\'Door hangers\\', \\'Deliver bilingual door hangers to all affected properties describing testing, timing, and contact information\\', \\'2–4 days before testing\\', \\'Aurelia field team in coordination with NFWB\\'),\\\\n    (\\'Press release\\', \\'Draft and issue press release describing program and contact channels\\', \\'At least 5 business days before first testing day\\', \\'NFWB communications with input from Aurelia\\'),\\\\n    (\\'Police and fire notice\\', \\'Notify police and fire departments of testing schedule and locations\\', \\'At least 3 days before each testing window\\', \\'NFWB operations with Aurelia support\\'),\\\\n    (\\'Weather check\\', \\'Confirm acceptable weather (dry conditions, minimal wind)\\', \\'Daily during testing window\\', \\'Aurelia field supervisor\\'),\\\\n    (\\'Post-test follow up\\', \\'Respond to resident questions and document any special conditions\\', \\'Within 2 business days of testing\\', \\'Aurelia Project Manager with NFWB support\\')\\\\n]\\\\n\\\\nfor step, desc, lead, resp in rows:\\\\n    row_cells = table.add_row().cells\\\\n    row_cells[0].text = step\\\\n    row_cells[1].text = desc\\\\n    row_cells[2].text = lead\\\\n    row_cells[3].text = resp\\\\n\\\\n# 4.3 Task 3 – Flow Isolation and Measurement\\\\n\\\\nh2 = doc.add_heading(\\'4.3 Task 3 – Flow Isolation and Measurement\\', level=2)\\\\n\\\\npara = doc.add_paragraph(\\'We will design and implement a flow isolation and measurement program to quantify groundwater infiltration by weiring section. This includes reviewing prior flow data, selecting and confirming weir locations with NFWB, providing all equipment and traffic control, ensuring confined space safety, and performing robust QA/QC and data analysis.\\', style=\\'Normal\\')\\\\n\\\\n# Mermaid diagram of flow isolation process\\\\nmermaid_code = \\'\\'\\'\\\\nflowchart TD\\\\n  A[Review prior flow data] --> B[Select candidate weir sites]\\\\n  B --> C[Field verify and confirm locations]\\\\n  C --> D[Install weirs and meters]\\\\n  D --> E[Collect flow and rainfall data]\\\\n  E --> F[QA QC and data validation]\\\\n  F --> G[Compute infiltration rates]\\\\n\\'\\'\\'\\\\nflow_iso_path = render_mermaid(mermaid_code, \\'flow_isolation\\')\\\\ndoc.add_picture(str(flow_iso_path), width=Inches(5.5))\\\\nadd_caption(\\'Figure 10: Flow isolation and measurement process\\')\\\\n\\\\n# Seaborn line chart: example diurnal flow patterns with rainfall overlay\\\\n\\\\ntime_index = pd.date_range(start=\\'2023-03-15\\', periods=48, freq=\\'H\\')\\\\nflow = 0.3 + 0.1 * np.sin(np.linspace(0, 4 * np.pi, 48)) + 0.05 * np.random.rand(48)\\\\nrain = np.zeros(48)\\\\nrain[10:13] = [0.1, 0.25, 0.05]\\\\n\\\\nfig, ax1 = plt.subplots(figsize=(7, 4))\\\\nax1.plot(time_index, flow, color=\\'#1f77b4\\', label=\\'Flow\\')\\\\nax1.set_ylabel(\\'Flow (mgd)\\', color=\\'#1f77b4\\')\\\\nax1.tick_params(axis=\\'y\\', labelcolor=\\'#1f77b4\\')\\\\nax1.set_xlabel(\\'Date and time\\')\\\\n\\\\nax2 = ax1.twinx()\\\\nax2.bar(time_index, rain, width=0.03, color=\\'#2ca02c\\', alpha=0.6, label=\\'Rainfall\\')\\\\nax2.set_ylabel(\\'Rainfall (inches)\\', color=\\'#2ca02c\\')\\\\nax2.tick_params(axis=\\'y\\', labelcolor=\\'#2ca02c\\')\\\\n\\\\nfig.autofmt_xdate(rotation=30)\\\\nplt.title(\\'Illustrative diurnal flow pattern with rainfall event\\')\\\\nfig.tight_layout()\\\\nflow_chart_path = output_dir / \\'flow_rain_line.png\\'\\\\nplt.savefig(flow_chart_path, dpi=150, bbox_inches=\\'tight\\', facecolor=\\'white\\')\\\\nplt.close()\\\\n\\\\ndoc.add_picture(str(flow_chart_path), width=Inches(5.8))\\\\nadd_caption(\\'Figure 11: Example of planned flow and rainfall analysis for infiltration assessment\\')\\\\n\\\\n# Seaborn bar chart template for infiltration rates by section\\\\nsections = [\\'Section 1\\', \\'Section 2\\', \\'Section 3\\', \\'Section 4\\']\\\\nrates = [800, 1200, 600, 400]\\\\nplt.figure(figsize=(6, 4))\\\\nax = sns.barplot(x=sections, y=rates, color=\\'#4c72b0\\')\\\\nax.set_xlabel(\\'Weiring section\\')\\\\nax.set_ylabel(\\'Infiltration rate (gpd per linear foot)\\')\\\\nax.set_title(\\'Illustrative infiltration rates by weiring section\\')\\\\nplt.tight_layout()\\\\ninf_chart_path = output_dir / \\'infiltration_rates_bar.png\\'\\\\nplt.savefig(inf_chart_path, dpi=150, bbox_inches=\\'tight\\', facecolor=\\'white\\')\\\\nplt.close()\\\\n\\\\ndoc.add_picture(str(inf_chart_path), width=Inches(5.5))\\\\nadd_caption(\\'Figure 12: Illustrative infiltration rate comparison across weiring sections\\')\\\\n\\\\n# Table summarizing proposed measurement locations\\\\n\\\\ntable = doc.add_table(rows=1, cols=3)\\\\ntable.style = \\'Table Grid\\'\\\\ntable.alignment = WD_TABLE_ALIGNMENT.CENTER\\\\nhdr = table.rows[0].cells\\\\nhdr[0].text = \\'Location type\\'\\\\nhdr[1].text = \\'Selection rationale\\'\\\\nhdr[2].text = \\'Anticipated monitoring duration\\'\\\\nfor cell in hdr:\\\\n    for run in cell.paragraphs[0].runs:\\\\n        run.bold = True\\\\n\\\\nrows = [\\\\n    (\\'Upstream subcatchment manholes\\', \\'Capture localized infiltration in priority basins with high wet-weather response\\', \\'2–4 weeks\\'),\\\\n    (\\'Mid-sewershed trunk locations\\', \\'Measure cumulative infiltration and support calibration of systemwide I and I estimates\\', \\'4–6 weeks\\'),\\\\n    (\\'Downstream near outfalls\\', \\'Support correlation of flow reductions with SSO performance and outfall conditions\\', \\'4–6 weeks\\')\\\\n]\\\\n\\\\nfor loc, rat, dur in rows:\\\\n    row_cells = table.add_row().cells\\\\n    row_cells[0].text = loc\\\\n    row_cells[1].text = rat\\\\n    row_cells[2].text = dur\\\\n\\\\n# 4.4 Task 4 – CCTV and Manhole Data Analysis\\\\n\\\\nh2 = doc.add_heading(\\'4.4 Task 4 – CCTV and Manhole Data Analysis\\', level=2)\\\\n\\\\npara = doc.add_paragraph(\\'We will analyze NFWB-provided CCTV and manhole inspection data using standardized defect coding and integrate the results into the SSES data model. Where gaps or inconsistencies are identified, we will coordinate with NFWB to schedule supplemental CCTV or manhole inspections using NFWB crews.\\', style=\\'Normal\\')\\\\n\\\\n# Mermaid data-flow diagram\\\\nmermaid_code = \\'\\'\\'\\\\nflowchart LR\\\\n  A[NFWB CCTV and manhole data] --> B[Aurelia data intake]\\\\n  B --> C[Standardized coding]\\\\n  C --> D[Geospatial database]\\\\n  D --> E[Defect prioritization]\\\\n  E --> F[SSES report and corrective actions]\\\\n\\'\\'\\'\\\\nCCTV_path = render_mermaid(mermaid_code, \\'cctv_data_flow\\')\\\\ndoc.add_picture(str(CCTV_path), width=Inches(5.5))\\\\nadd_caption(\\'Figure 13: Data flow from NFWB CCTV and manhole systems into SSES analysis\\')\\\\n\\\\n# Defect classification table\\\\n\\\\ntable = doc.add_table(rows=1, cols=3)\\\\ntable.style = \\'Table Grid\\'\\\\ntable.alignment = WD_TABLE_ALIGNMENT.CENTER\\\\nhdr = table.rows[0].cells\\\\nhdr[0].text = \\'Defect category\\'\\\\nhdr[1].text = \\'Description\\'\\\\nhdr[2].text = \\'Typical recommended action\\'\\\\nfor cell in hdr:\\\\n    for run in cell.paragraphs[0].runs:\\\\n        run.bold = True\\\\n\\\\nrows = [\\\\n    (\\'Structural defects\\', \\'Cracks, fractures, joint offsets, deformation, collapses\\', \\'CIPP lining, segment replacement, spot repairs\\'),\\\\n    (\\'O and M defects\\', \\'Debris, roots, grease, deposits\\', \\'Cleaning, root removal, ongoing maintenance program\\'),\\\\n    (\\'I and I-related defects\\', \\'Open joints, infiltration runners, defective laterals, leaking manhole walls\\', \\'Sealing, grouting, lateral rehabilitation, manhole lining\\'),\\\\n    (\\'Other observations\\', \\'Non-sanitary connections, unusual conditions, access issues\\', \\'Further investigation under Task 6, coordination with NFWB operations\\')\\\\n]\\\\n\\\\nfor cat, desc, act in rows:\\\\n    row_cells = table.add_row().cells\\\\n    row_cells[0].text = cat\\\\n    row_cells[1].text = desc\\\\n    row_cells[2].text = act\\\\n\\\\n# 4.5 Task 5 – Outfall/SSO Condition Assessment\\\\n\\\\nh2 = doc.add_heading(\\'4.5 Task 5 – Outfall and SSO Condition Assessment\\', level=2)\\\\n\\\\npara = doc.add_paragraph(\\'For the two Phase 1 outfalls/SSOs, Aurelia will develop and implement a targeted assessment program to characterize hydraulic performance, extraneous flows, and structural condition. This will include desktop review, site visits, potential installation of flow meters and rain gauges, dye testing, confined space entry where required, and coordination with NFWB CCTV crews.\\', style=\\'Normal\\')\\\\n\\\\n# Mermaid outfall assessment workflow\\\\nmermaid_code = \\'\\'\\'\\\\nflowchart TD\\\\n  A[Desktop review and mapping] --> B[Field reconnaissance]\\\\n  B --> C[Assessment work plan]\\\\n  C --> D[Instrumentation and dye testing]\\\\n  D --> E[Data analysis]\\\\n  E --> F[GIS documentation]\\\\n  F --> G[Recommendations]\\\\n\\'\\'\\'\\\\noutfall_path = render_mermaid(mermaid_code, \\'outfall_workflow\\')\\\\ndoc.add_picture(str(outfall_path), width=Inches(5.5))\\\\nadd_caption(\\'Figure 14: Outfall and SSO assessment workflow\\')\\\\n\\\\n# Seaborn before/after bar chart template for outfall flows\\\\nlabels = [\\'Outfall 1\\', \\'Outfall 2\\']\\\\npre = [1.8, 1.2]\\\\npost = [0.9, 0.6]\\\\nx = np.arange(len(labels))\\\\nwidth = 0.35\\\\n\\\\nfig, ax = plt.subplots(figsize=(6, 4))\\\\nrects1 = ax.bar(x - width / 2, pre, width, label=\\'Pre construction\\', color=\\'#1f77b4\\')\\\\nrects2 = ax.bar(x + width / 2, post, width, label=\\'Post construction\\', color=\\'#2ca02c\\')\\\\nax.set_xticks(x)\\\\nax.set_xticklabels(labels)\\\\nax.set_ylabel(\\'Average wet weather flow (mgd)\\')\\\\nax.set_title(\\'Illustrative pre and post construction outfall flows\\')\\\\nax.legend()\\\\nplt.tight_layout()\\\\noutfall_chart_path = output_dir / \\'outfall_before_after.png\\'\\\\nplt.savefig(outfall_chart_path, dpi=150, bbox_inches=\\'tight\\', facecolor=\\'white\\')\\\\nplt.close()\\\\n\\\\ndoc.add_picture(str(outfall_chart_path), width=Inches(5.5))\\\\nadd_caption(\\'Figure 15: Example of outfall flow reduction analysis for post-construction reporting\\')\\\\n\\\\n# Table listing outfalls and assessment methods\\\\n\\\\ntable = doc.add_table(rows=1, cols=4)\\\\ntable.style = \\'Table Grid\\'\\\\ntable.alignment = WD_TABLE_ALIGNMENT.CENTER\\\\nhdr = table.rows[0].cells\\\\nhdr[0].text = \\'Outfall\\'\\\\nhdr[1].text = \\'Assessment methods\\'\\\\nhdr[2].text = \\'Instrumentation\\'\\\\nhdr[3].text = \\'Expected data outputs\\'\\\\nfor cell in hdr:\\\\n    for run in cell.paragraphs[0].runs:\\\\n        run.bold = True\\\\n\\\\nrows = [\\\\n    (\\'Outfall A\\', \\'Site inspection, flow monitoring, dye testing, CCTV coordination\\', \\'Area velocity meter, rain gauge\\', \\'Time series flow and level, observed surcharge, dye travel times, structural observations\\'),\\\\n    (\\'Outfall B\\', \\'Site inspection, spot flow measurements, dye testing\\', \\'Portable flow meter, staff gauge\\', \\'Event-based flow measurements, visual evidence of extraneous flows, condition rating\\')\\\\n]\\\\n\\\\nfor name, meth, inst, outp in rows:\\\\n    row_cells = table.add_row().cells\\\\n    row_cells[0].text = name\\\\n    row_cells[1].text = meth\\\\n    row_cells[2].text = inst\\\\n    row_cells[3].text = outp\\\\n\\\\n# 4.6 Task 6 – Focused SSES and Contingency Use\\\\n\\\\nh2 = doc.add_heading(\\'4.6 Task 6 – Focused SSES and Contingency Use\\', level=2)\\\\n\\\\npara = doc.add_paragraph(\\'Task 6 provides a focused SSES contingency to confirm and refine I&I source locations using dye testing, house inspections, and additional CCTV. Aurelia will manage the required $10,000 contingency as a controlled budget that can only be used with NFWB approval, supported by written work orders and clear documentation.\\', style=\\'Normal\\')\\\\n\\\\n# Mermaid decision-tree diagram\\\\nmermaid_code = \\'\\'\\'\\\\nflowchart TD\\\\n  A[Findings from Tasks 2 to 5] --> B[Uncertain I and I source]\\\\n  B --> C{Need focused investigation}\\\\n  C -->|Yes| D[Develop Task 6 work order]\\\\n  D --> E[NFWB approval]\\\\n  E --> F[Perform dye testing or inspections]\\\\n  F --> G[Update data and corrective actions]\\\\n  C -->|No| H[Proceed with existing data]\\\\n\\'\\'\\'\\\\nfocused_path = render_mermaid(mermaid_code, \\'focused_sses_decision\\')\\\\ndoc.add_picture(str(focused_path), width=Inches(5.5))\\\\nadd_caption(\\'Figure 16: Decision process for initiating focused SSES investigations\\')\\\\n\\\\n# Contingency management table\\\\n\\\\ntable = doc.add_table(rows=1, cols=4)\\\\ntable.style = \\'Table Grid\\'\\\\ntable.alignment = WD_TABLE_ALIGNMENT.CENTER\\\\nhdr = table.rows[0].cells\\\\nhdr[0].text = \\'Potential use of contingency\\'\\\\nhdr[1].text = \\'Approval workflow\\'\\\\nhdr[2].text = \\'Tracking fields\\'\\\\nhdr[3].text = \\'Control measures\\'\\\\nfor cell in hdr:\\\\n    for run in cell.paragraphs[0].runs:\\\\n        run.bold = True\\\\n\\\\nrows = [\\\\n    (\\'Additional dye testing in complex areas\\', \\'Aurelia prepares brief scope and estimate; NFWB issues written authorization\\', \\'Location, scope, estimated cost, actual cost, date, results summary\\', \\'Monthly contingency status report; no work without written approval\\'),\\\\n    (\\'House inspections to confirm private inflow\\', \\'Coordinated with NFWB and residents; NFWB approves outreach plan\\', \\'Number of properties, inspection findings, recommended actions\\', \\'Use standardized forms and privacy protocols; integrate with MWBE/SDVOB participation where applicable\\'),\\\\n    (\\'Supplemental CCTV or manhole inspections\\', \\'NFWB schedules crews based on Aurelia request; Aurelia confirms need and expected value\\', \\'Segments inspected, defect types, impact on corrective plan\\', \\'Prioritize segments with greatest uncertainty or potential I and I reduction\\')\\\\n]\\\\n\\\\nfor use, appr, track, ctrl in rows:\\\\n    row_cells = table.add_row().cells\\\\n    row_cells[0].text = use\\\\n    row_cells[1].text = appr\\\\n    row_cells[2].text = track\\\\n    row_cells[3].text = ctrl\\\\n\\\\n# 4.7 Task 7 – SSES Engineering Report and Corrective Action Plan\\\\n\\\\nh2 = doc.add_heading(\\'4.7 Task 7 – SSES Engineering Report and Corrective Action Plan\\', level=2)\\\\n\\\\npara = doc.add_paragraph(\\'Aurelia will prepare an SSES Engineering Report that conforms to the NYSDEC Engineering Report Outline for Wastewater Infrastructure Projects and meets the requirements of the EPG and Order on Consent. The report will be prepared, stamped, and dated by a New York-licensed Professional Engineer and delivered in time to permit NYSDEC review early in 2023, enabling construction in 2023–early 2024.\\', style=\\'Normal\\')\\\\n\\\\n# Mermaid diagram mapping report sections to NYSDEC outline and Order on Consent\\\\nmermaid_code = \\'\\'\\'\\\\nflowchart LR\\\\n  A[NYSDEC report outline] --> B[SSES report sections]\\\\n  C[Order on Consent requirements] --> B\\\\n  B --> D[Executive summary]\\\\n  B --> E[Existing conditions]\\\\n  B --> F[Alternatives and corrective actions]\\\\n  B --> G[Implementation schedule]\\\\n  B --> H[Post construction monitoring plan]\\\\n\\'\\'\\'\\\\nreport_map_path = render_mermaid(mermaid_code, \\'report_mapping\\')\\\\ndoc.add_picture(str(report_map_path), width=Inches(5.8))\\\\nadd_caption(\\'Figure 17: Mapping of SSES report to NYSDEC outline and Order on Consent requirements\\')\\\\n\\\\n# Seaborn bar chart: corrective actions by category and I&I reduction\\\\ncategories = [\\'Mainline rehab\\', \\'Manhole rehab\\', \\'Lateral rehab\\', \\'Inflow disconnections\\']\\\\nreduction = [35, 20, 25, 20]\\\\nplt.figure(figsize=(6, 4))\\\\nax = sns.barplot(x=categories, y=reduction, color=\\'#4c72b0\\')\\\\nax.set_xlabel(\\'Corrective action category\\')\\\\nax.set_ylabel(\\'Estimated share of I and I reduction (percent)\\')\\\\nax.set_title(\\'Illustrative distribution of I and I reduction by corrective action type\\')\\\\nplt.xticks(rotation=20, ha=\\'right\\')\\\\nplt.tight_layout()\\\\naction_chart_path = output_dir / \\'corrective_actions_bar.png\\'\\\\nplt.savefig(action_chart_path, dpi=150, bbox_inches=\\'tight\\', facecolor=\\'white\\')\\\\nplt.close()\\\\n\\\\ndoc.add_picture(str(action_chart_path), width=Inches(5.5))\\\\nadd_caption(\\'Figure 18: Example of prioritizing corrective actions by I and I reduction impact\\')\\\\n\\\\n# Seaborn stacked bar chart of implementation timeline\\\\nphases = [\\'Short term\\', \\'Medium term\\', \\'Long term\\']\\\\nmainline = [40, 10, 0]\\\\nmanhole = [20, 10, 0]\\\\nlateral = [10, 20, 5]\\\\ninflow_disc = [10, 5, 0]\\\\nind = np.arange(len(phases))\\\\nwidth = 0.6\\\\n\\\\nfig, ax = plt.subplots(figsize=(6, 4))\\\\np1 = ax.bar(ind, mainline, width, label=\\'Mainline rehab\\')\\\\np2 = ax.bar(ind, manhole, width, bottom=mainline, label=\\'Manhole rehab\\')\\\\nbottom3 = np.array(mainline) + np.array(manhole)\\\\np3 = ax.bar(ind, lateral, width, bottom=bottom3, label=\\'Lateral rehab\\')\\\\nbottom4 = bottom3 + np.array(lateral)\\\\np4 = ax.bar(ind, inflow_disc, width, bottom=bottom4, label=\\'Inflow disconnections\\')\\\\nax.set_xticks(ind)\\\\nax.set_xticklabels(phases)\\\\nax.set_ylabel(\\'Relative investment level\\')\\\\nax.set_title(\\'Illustrative phasing of corrective actions\\')\\\\nax.legend(fontsize=8)\\\\nplt.tight_layout()\\\\nphase_chart_path = output_dir / \\'corrective_actions_phasing.png\\'\\\\nplt.savefig(phase_chart_path, dpi=150, bbox_inches=\\'tight\\', facecolor=\\'white\\')\\\\nplt.close()\\\\n\\\\ndoc.add_picture(str(phase_chart_path), width=Inches(5.5))\\\\nadd_caption(\\'Figure 19: Example phasing of corrective actions by implementation window\\')\\\\n\\\\n# Corrective action matrix table\\\\n\\\\ntable = doc.add_table(rows=1, cols=6)\\\\ntable.style = \\'Table Grid\\'\\\\ntable.alignment = WD_TABLE_ALIGNMENT.CENTER\\\\nhdr = table.rows[0].cells\\\\nhdr[0].text = \\'I and I source\\'\\\\nhdr[1].text = \\'Recommended action\\'\\\\nhdr[2].text = \\'Estimated cost range\\'\\\\nhdr[3].text = \\'Estimated I and I reduction\\'\\\\nhdr[4].text = \\'Priority level\\'\\\\nhdr[5].text = \\'Implementation window\\'\\\\nfor cell in hdr:\\\\n    for run in cell.paragraphs[0].runs:\\\\n        run.bold = True\\\\n\\\\nrows = [\\\\n    (\\'Defective mainline joints in 91st and Luick trunk\\', \\'CIPP lining of trunk segments\\', \\'$500k–$750k\\', \\'High\\', \\'High\\', \\'Short term (2023–2024)\\'),\\\\n    (\\'Leaking manholes in low-lying areas\\', \\'Manhole lining and frame adjustments\\', \\'$150k–$250k\\', \\'Medium\\', \\'Medium\\', \\'Short term (2023–2024)\\'),\\\\n    (\\'Private laterals with confirmed infiltration\\', \\'Targeted lateral rehabilitation program\\', \\'$200k–$400k\\', \\'Medium to high\\', \\'High\\', \\'Medium term (2024–2026)\\'),\\\\n    (\\'Roof leaders connected to sanitary system\\', \\'Disconnection and redirection to storm system\\', \\'$50k–$100k\\', \\'Medium\\', \\'Medium\\', \\'Short to medium term\\')\\\\n]\\\\n\\\\nfor src, act, cost, red, pri, win in rows:\\\\n    row_cells = table.add_row().cells\\\\n    row_cells[0].text = src\\\\n    row_cells[1].text = act\\\\n    row_cells[2].text = cost\\\\n    row_cells[3].text = red\\\\n    row_cells[4].text = pri\\\\n    row_cells[5].text = win\\\\n\\\\n# 4.8 Task 8 – Post-Construction Monitoring and I&I Assessment\\\\n\\\\nh2 = doc.add_heading(\\'4.8 Task 8 – Post-Construction Monitoring and I and I Assessment\\', level=2)\\\\n\\\\npara = doc.add_paragraph(\\'Following construction of Phase 1 improvements (assumed 2023 through early 2024), Aurelia will perform post-construction monitoring to quantify I&I reductions and evaluate the cost-effectiveness of implemented measures. We will collect and analyze flow and rainfall data, compare pre- and post-construction conditions, and prepare a Post-Construction I and I Assessment and Cost Analysis Report for NYSDEC.\\', style=\\'Normal\\')\\\\n\\\\n# Mermaid timeline diagram for pre vs post monitoring\\\\nmermaid_code = \\'\\'\\'\\\\nflowchart LR\\\\n  A[Pre construction baseline monitoring] --> B[Construction period]\\\\n  B --> C[Stabilization period]\\\\n  C --> D[Post construction monitoring]\\\\n  D --> E[Post construction I and I report]\\\\n\\'\\'\\'\\\\nmonitor_timeline_path = render_mermaid(mermaid_code, \\'pre_post_timeline\\')\\\\ndoc.add_picture(str(monitor_timeline_path), width=Inches(5.5))\\\\nadd_caption(\\'Figure 20: Pre and post construction monitoring and reporting timeline\\')\\\\n\\\\n# Line charts comparing pre and post flow vs rainfall\\\\n\\\\ntime_index = pd.date_range(start=\\'2024-02-01\\', periods=30, freq=\\'D\\')\\\\npre_flow = 1.5 + 0.3 * np.sin(np.linspace(0, 2 * np.pi, 30)) + 0.2 * np.random.rand(30)\\\\npost_flow = 1.0 + 0.2 * np.sin(np.linspace(0, 2 * np.pi, 30)) + 0.15 * np.random.rand(30)\\\\nrain = np.zeros(30)\\\\nrain[[5, 12, 20, 25]] = [0.3, 0.6, 0.4, 0.2]\\\\n\\\\nfig, ax1 = plt.subplots(figsize=(7, 4))\\\\nax1.plot(time_index, pre_flow, label=\\'Pre construction flow\\', color=\\'#1f77b4\\')\\\\nax1.plot(time_index, post_flow, label=\\'Post construction flow\\', color=\\'#2ca02c\\')\\\\nax1.set_ylabel(\\'Flow (mgd)\\')\\\\nax1.set_xlabel(\\'Date\\')\\\\nax1.legend(loc=\\'upper left\\', fontsize=8)\\\\n\\\\nax2 = ax1.twinx()\\\\nax2.bar(time_index, rain, width=0.8, color=\\'#8c564b\\', alpha=0.4, label=\\'Rainfall\\')\\\\nax2.set_ylabel(\\'Rainfall (inches)\\')\\\\n\\\\nfig.autofmt_xdate(rotation=30)\\\\nplt.title(\\'Illustrative pre and post construction flow response to rainfall\\')\\\\nfig.tight_layout()\\\\npre_post_flow_path = output_dir / \\'pre_post_flow_rain.png\\'\\\\nplt.savefig(pre_post_flow_path, dpi=150, bbox_inches=\\'tight\\', facecolor=\\'white\\')\\\\nplt.close()\\\\n\\\\ndoc.add_picture(str(pre_post_flow_path), width=Inches(5.8))\\\\nadd_caption(\\'Figure 21: Example comparison of pre and post construction flow response to rainfall\\')\\\\n\\\\n# Cost-effectiveness scatter plot template\\\\n\\\\nmeasures = [\\'Mainline rehab\\', \\'Manhole rehab\\', \\'Lateral rehab\\', \\'Inflow disconnections\\']\\\\ncosts = [700, 200, 300, 100]\\\\nreductions = [0.8, 0.3, 0.4, 0.25]\\\\n\\\\nplt.figure(figsize=(6, 4))\\\\nplt.scatter(costs, reductions, color=\\'#4c72b0\\')\\\\nfor i, label in enumerate(measures):\\\\n    plt.text(costs[i] + 10, reductions[i], label, fontsize=8)\\\\nplt.xlabel(\\'Cost (thousand dollars)\\')\\\\nplt.ylabel(\\'Estimated I and I reduction (mgd)\\')\\\\nplt.title(\\'Illustrative cost effectiveness of implemented measures\\')\\\\nplt.tight_layout()\\\\nscatter_path = output_dir / \\'cost_effectiveness_scatter.png\\'\\\\nplt.savefig(scatter_path, dpi=150, bbox_inches=\\'tight\\', facecolor=\\'white\\')\\\\nplt.close()\\\\n\\\\ndoc.add_picture(str(scatter_path), width=Inches(5.5))\\\\nadd_caption(\\'Figure 22: Example cost effectiveness analysis of corrective measures\\')\\\\n\\\\n# Monitoring locations and methods table\\\\n\\\\ntable = doc.add_table(rows=1, cols=3)\\\\ntable.style = \\'Table Grid\\'\\\\ntable.alignment = WD_TABLE_ALIGNMENT.CENTER\\\\nhdr = table.rows[0].cells\\\\nhdr[0].text = \\'Monitoring location type\\'\\\\nhdr[1].text = \\'Parameters\\'\\\\nhdr[2].text = \\'Statistical comparison methods\\'\\\\nfor cell in hdr:\\\\n    for run in cell.paragraphs[0].runs:\\\\n        run.bold = True\\\\n\\\\nrows = [\\\\n    (\\'Upstream subcatchments\\', \\'Continuous flow and level, rainfall\\', \\'Paired event analysis, pre/post regression of flow vs rainfall\\'),\\\\n    (\\'Downstream near outfalls\\', \\'Continuous flow, overflow occurrence\\', \\'Frequency and volume comparison of SSO events\\'),\\\\n    (\\'Representative basins\\', \\'Flow, rainfall, groundwater levels where available\\', \\'Non-parametric tests to compare central tendency and variability pre/post\\')\\\\n]\\\\n\\\\nfor loc, param, meth in rows:\\\\n    row_cells = table.add_row().cells\\\\n    row_cells[0].text = loc\\\\n    row_cells[1].text = param\\\\n    row_cells[2].text = meth\\\\n\\\\n# 5. Optional Services Approach – Phase 2 and Phase 3 SSES\\\\n\\\\ndoc.add_page_break()\\\\n\\\\nh1 = doc.add_heading(\\'5. Optional Services Approach – Phase 2 and Phase 3 SSES\\', level=1)\\\\n\\\\npara = doc.add_paragraph(\\'Aurelia’s approach for Phase 2 (Option 1) and Phase 3 (Option 2) builds directly on the Phase 1 framework, enabling consistent methods, data structures, and reporting across all LaSalle sewersheds. This continuity reduces learning curve, improves comparability of I&I metrics, and simplifies regulatory coordination.\\', style=\\'Normal\\')\\\\n\\\\n# Mermaid multi-phase roadmap\\\\nmermaid_code = \\'\\'\\'\\\\nflowchart LR\\\\n  A[Phase 1 SSES] --> B[Phase 2 SSES]\\\\n  B --> C[Phase 3 SSES]\\\\n  A --> D[Shared data model]\\\\n  B --> D\\\\n  C --> D\\\\n  D --> E[Portfolio level I and I strategy]\\\\n\\'\\'\\'\\\\nroadmap_path = render_mermaid(mermaid_code, \\'multi_phase_roadmap\\')\\\\ndoc.add_picture(str(roadmap_path), width=Inches(5.8))\\\\nadd_caption(\\'Figure 23: Multi phase roadmap across Phase 1, Phase 2, and Phase 3 SSES\\')\\\\n\\\\n# Seaborn bar chart comparing level of effort by task between phases\\\\nphases = [\\'Phase 1\\', \\'Phase 2\\', \\'Phase 3\\']\\\\nfield_hours = [2200, 1800, 1600]\\\\nanalysis_hours = [900, 700, 650]\\\\nreport_hours = [600, 450, 450]\\\\n\\\\nind = np.arange(len(phases))\\\\nwidth = 0.25\\\\n\\\\nfig, ax = plt.subplots(figsize=(7, 4))\\\\nax.bar(ind - width, field_hours, width, label=\\'Field investigations\\')\\\\nax.bar(ind, analysis_hours, width, label=\\'Analysis and modeling\\')\\\\nax.bar(ind + width, report_hours, width, label=\\'Reporting and management\\')\\\\nax.set_xticks(ind)\\\\nax.set_xticklabels(phases)\\\\nax.set_ylabel(\\'Level of effort (hours, illustrative)\\')\\\\nax.set_title(\\'Illustrative level of effort by phase and activity\\')\\\\nax.legend(fontsize=8)\\\\nplt.tight_layout()\\\\nloe_path = output_dir / \\'phase_loe_comparison.png\\'\\\\nplt.savefig(loe_path, dpi=150, bbox_inches=\\'tight\\', facecolor=\\'white\\')\\\\nplt.close()\\\\n\\\\ndoc.add_picture(str(loe_path), width=Inches(5.8))\\\\nadd_caption(\\'Figure 24: Illustrative comparison of level of effort across SSES phases\\')\\\\n\\\\n# Option comparison table (scope, schedule, fees)\\\\n\\\\ntable = doc.add_table(rows=1, cols=4)\\\\ntable.style = \\'Table Grid\\'\\\\ntable.alignment = WD_TABLE_ALIGNMENT.CENTER\\\\nhdr = table.rows[0].cells\\\\nhdr[0].text = \\'Option\\'\\\\nhdr[1].text = \\'Scope summary\\'\\\\nhdr[2].text = \\'Indicative schedule\\'\\\\nhdr[3].text = \\'Not to exceed fee structure\\'\\\\nfor cell in hdr:\\\\n    for run in cell.paragraphs[0].runs:\\\\n        run.bold = True\\\\n\\\\nrows = [\\\\n    (\\'Phase 2 – Option 1\\', \\'Phase 2 SSES in 81st and Frontier 2 and 80th and Lindbergh; Tasks 1–4, 6–8 (Task 5 omitted)\\', \\'Commence after Phase 1 fieldwork; complete within 9–12 months\\', \\'Time and materials with not to exceed cap, structured by task and labor category\\'),\\\\n    (\\'Phase 3 – Option 2\\', \\'Phase 3 SSES in Mang and 88th including one outfall assessment\\', \\'Commence after Phase 2 initiation; complete within 9–12 months\\', \\'Time and materials with not to exceed cap, including outfall assessment budget\\')\\\\n]\\\\n\\\\nfor opt, scope, sched, fee in rows:\\\\n    row_cells = table.add_row().cells\\\\n    row_cells[0].text = opt\\\\n    row_cells[1].text = scope\\\\n    row_cells[2].text = sched\\\\n    row_cells[3].text = fee\\\\n\\\\n# 6. Project Organization, Key Personnel, and Subconsultants\\\\n\\\\ndoc.add_page_break()\\\\n\\\\nh1 = doc.add_heading(\\'6. Project Organization, Key Personnel, and Subconsultants\\', level=1)\\\\n\\\\npara = doc.add_paragraph(\\'Aurelia’s project organization is designed to provide clear accountability, strong technical leadership, and safe execution of all SSES tasks, including confined space work. We will deploy an integrated team of Aurelia staff and specialized subconsultants, including MWBE and SDVOB firms, to deliver the full scope.\\', style=\\'Normal\\')\\\\n\\\\n# Mermaid org chart\\\\nmermaid_code = \\'\\'\\'\\\\nflowchart TD\\\\n  NFWB[NFWB project manager] --> PM[Aurelia project manager]\\\\n  PM --> TL[Technical leads]\\\\n  PM --> HSE[Health and safety lead]\\\\n  TL --> Field[Field crews]\\\\n  TL --> Data[Data and analytics team]\\\\n  PM --> Subs[Subconsultants]\\\\n\\'\\'\\'\\\\norg_path = render_mermaid(mermaid_code, \\'project_org\\')\\\\ndoc.add_picture(str(org_path), width=Inches(5.8))\\\\nadd_caption(\\'Figure 25: Project organization and reporting relationships\\')\\\\n\\\\n# Key personnel table\\\\n\\\\ntable = doc.add_table(rows=1, cols=5)\\\\ntable.style = \\'Table Grid\\'\\\\ntable.alignment = WD_TABLE_ALIGNMENT.CENTER\\\\nhdr = table.rows[0].cells\\\\nhdr[0].text = \\'Name and role\\'\\\\nhdr[1].text = \\'Licenses and training\\'\\\\nhdr[2].text = \\'Years of experience\\'\\\\nhdr[3].text = \\'Relevant SSES and utility experience\\'\\\\nhdr[4].text = \\'Key responsibilities\\'\\\\nfor cell in hdr:\\\\n    for run in cell.paragraphs[0].runs:\\\\n        run.bold = True\\\\n\\\\nrows = [\\\\n    (\\'Project Manager – Senior Engineer\\', \\'NYS PE, OSHA 30, confined space supervisor\\', \\'15+\\', \\'Lead for multiple SSES and I and I reduction programs for municipal utilities\\', \\'Single point of contact, schedule and budget management, coordination with NFWB and NYSDEC\\'),\\\\n    (\\'Field Operations Lead\\', \\'NASSCO PACP/MACP, confined space entry, traffic control\\', \\'12\\', \\'Managed smoke testing, flow isolation, and CCTV programs across several cities\\', \\'Plan and supervise field activities, safety oversight, QA/QC of field data\\'),\\\\n    (\\'Data and Analytics Lead\\', \\'Professional engineer in another jurisdiction, GIS certification\\', \\'10\\', \\'Developed I and I models, dashboards, and regulatory reports for utilities\\', \\'Integrate and analyze SSES data, support Engineering Report and post-construction assessment\\'),\\\\n    (\\'Health and Safety Coordinator\\', \\'Certified safety professional, OSHA trainer\\', \\'18\\', \\'Developed and implemented safety programs for field-intensive utility projects\\', \\'Prepare site-specific health and safety plans, monitor compliance, incident response support\\')\\\\n]\\\\n\\\\nfor name, lic, yrs, exp, resp in rows:\\\\n    row_cells = table.add_row().cells\\\\n    row_cells[0].text = name\\\\n    row_cells[1].text = lic\\\\n    row_cells[2].text = yrs\\\\n    row_cells[3].text = exp\\\\n    row_cells[4].text = resp\\\\n\\\\n# Subconsultant table\\\\n\\\\ntable = doc.add_table(rows=1, cols=4)\\\\ntable.style = \\'Table Grid\\'\\\\ntable.alignment = WD_TABLE_ALIGNMENT.CENTER\\\\nhdr = table.rows[0].cells\\\\nhdr[0].text = \\'Subconsultant firm (>10% scope)\\'\\\\nhdr[1].text = \\'Scope of services\\'\\\\nhdr[2].text = \\'Certifications (MWBE/SDVOB)\\'\\\\nhdr[3].text = \\'Role in project\\'\\\\nfor cell in hdr:\\\\n    for run in cell.paragraphs[0].runs:\\\\n        run.bold = True\\\\n\\\\nrows = [\\\\n    (\\'Specialized field services firm\\', \\'Smoke testing, flow isolation support, confined space entry crews\\', \\'MWBE (anticipated)\\', \\'Provide experienced field crews and specialized equipment under Aurelia supervision\\'),\\\\n    (\\'Local engineering partner\\', \\'On-site coordination, resident outreach, supplemental design support\\', \\'SDVOB (anticipated)\\', \\'Support resident communications, local permitting, and design coordination\\')\\\\n]\\\\n\\\\nfor firm, scope, cert, role in rows:\\\\n    row_cells = table.add_row().cells\\\\n    row_cells[0].text = firm\\\\n    row_cells[1].text = scope\\\\n    row_cells[2].text = cert\\\\n    row_cells[3].text = role\\\\n\\\\n# 7. Relevant Experience and Past Performance\\\\n\\\\ndoc.add_page_break()\\\\n\\\\nh1 = doc.add_heading(\\'7. Relevant Experience and Past Performance\\', level=1)\\\\n\\\\npara = doc.add_paragraph(\\'Aurelia Digital Systems is a privately held engineering and technology firm founded in 2016, headquartered in Toronto, Ontario, with delivery teams across Canada and the United States. We specialize in data-rich, compliance-focused projects for public-sector and utility clients. Our team members bring decades of combined experience in SSES, I and I analysis, regulatory reporting, and complex data integration.\\', style=\\'Normal\\')\\\\n\\\\n# Seaborn bar chart summarizing past projects by size and duration\\\\nprojects = [\\'Utility A I and I program\\', \\'Utility B sewer assessment\\', \\'Regional SSO study\\', \\'Municipal flow monitoring\\']\\\\nvalues = [1.2, 0.8, 1.5, 0.6]\\\\nduration = [24, 18, 30, 12]\\\\n\\\\nfig, ax1 = plt.subplots(figsize=(7, 4))\\\\nax1.bar(projects, values, color=\\'#4c72b0\\')\\\\nax1.set_ylabel(\\'Contract value (million dollars)\\')\\\\nax1.set_xticklabels(projects, rotation=20, ha=\\'right\\')\\\\nax2 = ax1.twinx()\\\\nax2.plot(projects, duration, color=\\'#2ca02c\\', marker=\\'o\\')\\\\nax2.set_ylabel(\\'Duration (months)\\')\\\\nplt.title(\\'Representative project scale and duration\\')\\\\nfig.tight_layout()\\\\nexp_chart_path = output_dir / \\'experience_projects_bar.png\\'\\\\nplt.savefig(exp_chart_path, dpi=150, bbox_inches=\\'tight\\', facecolor=\\'white\\')\\\\nplt.close()\\\\n\\\\ndoc.add_picture(str(exp_chart_path), width=Inches(5.8))\\\\nadd_caption(\\'Figure 26: Representative Aurelia project size and duration\\')\\\\n\\\\n# Project experience matrix\\\\n\\\\ntable = doc.add_table(rows=1, cols=4)\\\\ntable.style = \\'Table Grid\\'\\\\ntable.alignment = WD_TABLE_ALIGNMENT.CENTER\\\\nhdr = table.rows[0].cells\\\\nhdr[0].text = \\'Project\\'\\\\nhdr[1].text = \\'Scope elements\\'\\\\nhdr[2].text = \\'Client type\\'\\\\nhdr[3].text = \\'Reference contact (available upon request)\\'\\\\nfor cell in hdr:\\\\n    for run in cell.paragraphs[0].runs:\\\\n        run.bold = True\\\\n\\\\nrows = [\\\\n    (\\'Utility A I and I reduction program\\', \\'SSES, flow monitoring, I and I modeling, NYSDEC-style reporting\\', \\'Public utility\\', \\'Senior engineer at Utility A\\'),\\\\n    (\\'Utility B sewer assessment\\', \\'CCTV review, manhole inspections, corrective action planning\\', \\'Municipal utility\\', \\'Engineering manager at Utility B\\'),\\\\n    (\\'Regional SSO study\\', \\'SSO root cause analysis, outfall assessment, capital planning\\', \\'Regional authority\\', \\'Program manager at regional authority\\')\\\\n]\\\\n\\\\nfor proj, scope, ctype, ref in rows:\\\\n    row_cells = table.add_row().cells\\\\n    row_cells[0].text = proj\\\\n    row_cells[1].text = scope\\\\n    row_cells[2].text = ctype\\\\n    row_cells[3].text = ref\\\\n\\\\n# Disclosure table\\\\ntable = doc.add_table(rows=1, cols=2)\\\\ntable.style = \\'Table Grid\\'\\\\ntable.alignment = WD_TABLE_ALIGNMENT.CENTER\\\\nhdr = table.rows[0].cells\\\\nhdr[0].text = \\'Disclosure item\\'\\\\nhdr[1].text = \\'Aurelia response\\'\\\\nfor cell in hdr:\\\\n    for run in cell.paragraphs[0].runs:\\\\n        run.bold = True\\\\n\\\\nrows = [\\\\n    (\\'Debarment or suspension\\', \\'No debarments or suspensions.\\'),\\\\n    (\\'Findings of non-responsibility\\', \\'No findings of non-responsibility related to public contracts.\\'),\\\\n    (\\'Defaults or liquidated damages\\', \\'No contract terminations for default; no assessed liquidated damages on SSES or similar projects.\\'),\\\\n    (\\'Bankruptcies\\', \\'No bankruptcies.\\'),\\\\n    (\\'Material legal actions or investigations\\', \\'No pending legal actions or investigations that would impact our ability to perform this contract.\\'),\\\\n    (\\'Conflicts of interest\\', \\'No known conflicts of interest with NFWB, its Board, or staff.\\')\\\\n]\\\\n\\\\nfor item, resp in rows:\\\\n    row_cells = table.add_row().cells\\\\n    row_cells[0].text = item\\\\n    row_cells[1].text = resp\\\\n\\\\n# 8. Project Schedule and Work Plan\\\\n\\\\ndoc.add_page_break()\\\\n\\\\nh1 = doc.add_heading(\\'8. Project Schedule and Work Plan\\', level=1)\\\\n\\\\npara = doc.add_paragraph(\\'Our schedule is structured to meet NYSDEC review timelines and enable construction in 2023–early 2024, with post-construction monitoring completed by June 2024. We coordinate fieldwork windows with seasonal constraints, NFWB operations, and resident communication needs.\\', style=\\'Normal\\')\\\\n\\\\n# Mermaid Gantt-style diagram (simplified)\\\\nmermaid_code = \\'\\'\\'\\\\ngantt\\\\n  title Phase 1 SSES schedule\\\\n  dateFormat  YYYY-MM-DD\\\\n  section Management and analysis\\\\n  Task1 Project management and data review :a1, 2022-12-06, 2023-01-31\\\\n  Task4 CCTV and manhole analysis         :a2, 2023-02-01, 2023-04-15\\\\n  Task7 SSES report                       :a3, 2023-05-01, 2023-06-30\\\\n  section Field investigations\\\\n  Task2 Smoke testing                     :b1, 2023-03-01, 2023-03-31\\\\n  Task3 Flow isolation and measurement    :b2, 2023-03-15, 2023-04-30\\\\n  Task5 Outfall assessment                :b3, 2023-04-01, 2023-05-15\\\\n  Task6 Focused SSES                      :b4, 2023-04-15, 2023-06-15\\\\n  section Monitoring\\\\n  Task8 Post construction monitoring      :c1, 2024-01-01, 2024-06-30\\\\n\\'\\'\\'\\\\nphase1_gantt_mermaid_path = render_mermaid(mermaid_code, \\'phase1_gantt_mermaid\\')\\\\ndoc.add_picture(str(phase1_gantt_mermaid_path), width=Inches(6.0))\\\\nadd_caption(\\'Figure 27: High level Phase 1 SSES schedule\\')\\\\n\\\\n# Seaborn bar chart schedule by task and month\\\\nschedule_summary = pd.DataFrame({\\\\n    \\'Task\\': [\\'Task 1\\', \\'Task 2\\', \\'Task 3\\', \\'Task 4\\', \\'Task 5\\', \\'Task 6\\', \\'Task 7\\', \\'Task 8\\'],\\\\n    \\'Months\\': [2, 1, 2, 3, 2, 2, 2, 6]\\\\n})\\\\nplt.figure(figsize=(6, 4))\\\\nax = sns.barplot(data=schedule_summary, x=\\'Task\\', y=\\'Months\\', color=\\'#4c72b0\\')\\\\nax.set_ylabel(\\'Duration (months, approximate)\\')\\\\nax.set_title(\\'Approximate duration by Phase 1 task\\')\\\\nplt.tight_layout()\\\\nmonth_bar_path = output_dir / \\'schedule_months_bar.png\\'\\\\nplt.savefig(month_bar_path, dpi=150, bbox_inches=\\'tight\\', facecolor=\\'white\\')\\\\nplt.close()\\\\n\\\\ndoc.add_picture(str(month_bar_path), width=Inches(5.5))\\\\nadd_caption(\\'Figure 28: Approximate duration of Phase 1 tasks\\')\\\\n\\\\n# Milestone table\\\\n\\\\ntable = doc.add_table(rows=1, cols=3)\\\\ntable.style = \\'Table Grid\\'\\\\ntable.alignment = WD_TABLE_ALIGNMENT.CENTER\\\\nhdr = table.rows[0].cells\\\\nhdr[0].text = \\'Milestone\\'\\\\nhdr[1].text = \\'Target date\\'\\\\nhdr[2].text = \\'Responsible role\\'\\\\nfor cell in hdr:\\\\n    for run in cell.paragraphs[0].runs:\\\\n        run.bold = True\\\\n\\\\nrows = [\\\\n    (\\'Notice to proceed and kickoff\\', \\'Early December 2022\\', \\'Aurelia Project Manager and NFWB project manager\\'),\\\\n    (\\'Completion of data review and initial field plan\\', \\'Late January 2023\\', \\'Aurelia Project Manager and technical leads\\'),\\\\n    (\\'Completion of smoke testing and flow isolation\\', \\'End of April 2023\\', \\'Field Operations Lead\\'),\\\\n    (\\'Draft SSES report to NFWB\\', \\'Late May 2023\\', \\'Aurelia Project Manager and PE\\'),\\\\n    (\\'Final SSES report for NYSDEC submittal\\', \\'Late June 2023\\', \\'Aurelia PE and NFWB\\'),\\\\n    (\\'Completion of post-construction monitoring\\', \\'June 2024\\', \\'Aurelia Project Manager and Data Lead\\')\\\\n]\\\\n\\\\nfor mil, date, resp in rows:\\\\n    row_cells = table.add_row().cells\\\\n    row_cells[0].text = mil\\\\n    row_cells[1].text = date\\\\n    row_cells[2].text = resp\\\\n\\\\n# Work window table for field activities\\\\n\\\\ntable = doc.add_table(rows=1, cols=4)\\\\ntable.style = \\'Table Grid\\'\\\\ntable.alignment = WD_TABLE_ALIGNMENT.CENTER\\\\nhdr = table.rows[0].cells\\\\nhdr[0].text = \\'Activity\\'\\\\nhdr[1].text = \\'Preferred window\\'\\\\nhdr[2].text = \\'Key constraints\\'\\\\nhdr[3].text = \\'Mitigation strategies\\'\\\\nfor cell in hdr:\\\\n    for run in cell.paragraphs[0].runs:\\\\n        run.bold = True\\\\n\\\\nrows = [\\\\n    (\\'Smoke testing\\', \\'Early spring 2023\\', \\'Dry weather, minimal snow and ice, wind conditions\\', \\'Monitor forecast; maintain backup dates; prioritize areas with best conditions\\'),\\\\n    (\\'Flow isolation and measurement\\', \\'Spring 2023\\', \\'Stable groundwater conditions, access for equipment\\', \\'Coordinate with NFWB operations; plan traffic control in advance\\'),\\\\n    (\\'Outfall assessment\\', \\'Spring 2023\\', \\'Safe access, water levels, environmental sensitivity\\', \\'Conduct pre-site visits; adjust schedule for high flows or unsafe conditions\\')\\\\n]\\\\n\\\\nfor act, win, cons, mit in rows:\\\\n    row_cells = table.add_row().cells\\\\n    row_cells[0].text = act\\\\n    row_cells[1].text = win\\\\n    row_cells[2].text = cons\\\\n    row_cells[3].text = mit\\\\n\\\\n# 9. Management Approach, Governance, and Communication\\\\n\\\\ndoc.add_page_break()\\\\n\\\\nh1 = doc.add_heading(\\'9. Management Approach, Governance, and Communication\\', level=1)\\\\n\\\\npara = doc.add_paragraph(\\'Aurelia’s management approach combines disciplined project controls with clear governance and transparent communication. We align with NFWB’s administrative requirements, coordinate with other contractors, and maintain compliance with restricted communications under NYS Finance Law 139-j and 139-k.\\', style=\\'Normal\\')\\\\n\\\\n# Mermaid governance diagram\\\\nmermaid_code = \\'\\'\\'\\\\nflowchart TD\\\\n  Steer[Steering group] --> PMO[Project management]\\\\n  PMO --> Work[Working team]\\\\n  Work --> Field[Field coordination]\\\\n  Work --> Data[Data and reporting]\\\\n  PMO --> Risk[Risk and issue review]\\\\n  Risk --> Steer\\\\n\\'\\'\\'\\\\ngov_path = render_mermaid(mermaid_code, \\'governance_model\\')\\\\ndoc.add_picture(str(gov_path), width=Inches(5.5))\\\\nadd_caption(\\'Figure 29: Governance structure and escalation paths\\')\\\\n\\\\n# Communication plan table\\\\n\\\\ntable = doc.add_table(rows=1, cols=4)\\\\ntable.style = \\'Table Grid\\'\\\\ntable.alignment = WD_TABLE_ALIGNMENT.CENTER\\\\nhdr = table.rows[0].cells\\\\nhdr[0].text = \\'Audience\\'\\\\nhdr[1].text = \\'Communication type\\'\\\\nhdr[2].text = \\'Frequency\\'\\\\nhdr[3].text = \\'Channel and owner\\'\\\\nfor cell in hdr:\\\\n    for run in cell.paragraphs[0].runs:\\\\n        run.bold = True\\\\n\\\\nrows = [\\\\n    (\\'NFWB project team\\', \\'Status meetings, action logs, risk reviews\\', \\'Biweekly during active work\\', \\'Virtual or in-person meetings led by Aurelia Project Manager\\'),\\\\n    (\\'NYSDEC staff\\', \\'Progress updates, report reviews as requested by NFWB\\', \\'At key milestones\\', \\'Coordinated by NFWB with Aurelia technical support\\'),\\\\n    (\\'Residents and businesses\\', \\'Door hangers, press releases, field crew interactions\\', \\'Per field activity\\', \\'Resident notifications coordinated with NFWB; Aurelia field staff on site\\'),\\\\n    (\\'Emergency services and local authorities\\', \\'Advance notifications for smoke testing and traffic control\\', \\'Per applicable activity\\', \\'NFWB operations with input from Aurelia\\')\\\\n]\\\\n\\\\nfor aud, ctype, freq, chan in rows:\\\\n    row_cells = table.add_row().cells\\\\n    row_cells[0].text = aud\\\\n    row_cells[1].text = ctype\\\\n    row_cells[2].text = freq\\\\n    row_cells[3].text = chan\\\\n\\\\n# Risk register table\\\\n\\\\ntable = doc.add_table(rows=1, cols=5)\\\\ntable.style = \\'Table Grid\\'\\\\ntable.alignment = WD_TABLE_ALIGNMENT.CENTER\\\\nhdr = table.rows[0].cells\\\\nhdr[0].text = \\'Risk\\'\\\\nhdr[1].text = \\'Likelihood\\'\\\\nhdr[2].text = \\'Impact\\'\\\\nhdr[3].text = \\'Mitigation\\'\\\\nhdr[4].text = \\'Contingency\\'\\\\nfor cell in hdr:\\\\n    for run in cell.paragraphs[0].runs:\\\\n        run.bold = True\\\\n\\\\nrows = [\\\\n    (\\'Delay in receiving data or approvals\\', \\'Medium\\', \\'High\\', \\'Early data requests; clear decision deadlines; escalation paths\\', \\'Resequence fieldwork; allocate additional analysis resources\\'),\\\\n    (\\'Weather impacts on field activities\\', \\'High\\', \\'Medium\\', \\'Plan multiple windows; maintain flexible crew scheduling\\', \\'Extend field window; adjust sequence of basins\\'),\\\\n    (\\'Resident concerns or access issues\\', \\'Medium\\', \\'Medium\\', \\'Proactive communication; clear contact information; coordination with NFWB\\', \\'Reschedule activities; deploy additional outreach support\\'),\\\\n    (\\'Safety incident in field\\', \\'Low\\', \\'High\\', \\'Comprehensive health and safety plan; training; job hazard analyses\\', \\'Pause work; incident investigation; corrective actions\\')\\\\n]\\\\n\\\\nfor risk, lik, imp, mit, cont in rows:\\\\n    row_cells = table.add_row().cells\\\\n    row_cells[0].text = risk\\\\n    row_cells[1].text = lik\\\\n    row_cells[2].text = imp\\\\n    row_cells[3].text = mit\\\\n    row_cells[4].text = cont\\\\n\\\\n# 10. Cost Proposal, Level of Effort, and Invoicing\\\\n\\\\ndoc.add_page_break()\\\\n\\\\nh1 = doc.add_heading(\\'10. Cost Proposal, Level of Effort, and Invoicing\\', level=1)\\\\n\\\\npara = doc.add_paragraph(\\'Aurelia will provide a detailed cost proposal under separate cover, including a task/hour estimate matrix by labor category, not-to-exceed fee, and the required $10,000 contingency for Task 6. We accept NFWB’s 60-day payment terms, sales tax exemption, and monthly invoicing requirements with supporting documentation.\\', style=\\'Normal\\')\\\\n\\\\n# Seaborn pie chart showing cost distribution by major task group\\\\nlabels = [\\'Field investigations\\', \\'Analysis and modeling\\', \\'Reporting and management\\', \\'Contingency\\']\\\\nsizes = [50, 20, 25, 5]\\\\nfig, ax = plt.subplots(figsize=(5, 5))\\\\nax.pie(sizes, labels=labels, autopct=\\'%1.0f%%\\', startangle=140)\\\\nax.axis(\\'equal\\')\\\\nplt.title(\\'Illustrative cost distribution by major task group\\')\\\\nplt.tight_layout()\\\\nCost_pie_path = output_dir / \\'cost_distribution_pie.png\\'\\\\nplt.savefig(Cost_pie_path, dpi=150, bbox_inches=\\'tight\\', facecolor=\\'white\\')\\\\nplt.close()\\\\n\\\\ndoc.add_picture(str(Cost_pie_path), width=Inches(4.5))\\\\nadd_caption(\\'Figure 30: Illustrative distribution of costs across major task groups\\')\\\\n\\\\n# Task/hour estimate matrix table (structure)\\\\n\\\\ntable = doc.add_table(rows=1, cols=5)\\\\ntable.style = \\'Table Grid\\'\\\\ntable.alignment = WD_TABLE_ALIGNMENT.CENTER\\\\nhdr = table.rows[0].cells\\\\nhdr[0].text = \\'Task\\'\\\\nhdr[1].text = \\'Role\\'\\\\nhdr[2].text = \\'Estimated hours\\'\\\\nhdr[3].text = \\'Billing rate\\'\\\\nhdr[4].text = \\'Extended amount\\'\\\\nfor cell in hdr:\\\\n    for run in cell.paragraphs[0].runs:\\\\n        run.bold = True\\\\n\\\\nrows = [\\\\n    (\\'Task 1 – Project management and data review\\', \\'Project Manager, Data Lead\\', \\'Illustrative values to be finalized\\', \\'Standard hourly rates\\', \\'Calculated in detailed cost proposal\\'),\\\\n    (\\'Task 2 – Smoke testing\\', \\'Field Operations Lead, field technicians\\', \\'Illustrative values to be finalized\\', \\'Standard hourly rates\\', \\'Calculated in detailed cost proposal\\'),\\\\n    (\\'Task 6 – Focused SSES\\', \\'Field Operations Lead, technicians, analysts\\', \\'As authorized up to $10,000\\', \\'Standard hourly rates\\', \\'Capped at $10,000 contingency\\')\\\\n]\\\\n\\\\nfor task, role, hrs, rate, amount in rows:\\\\n    row_cells = table.add_row().cells\\\\n    row_cells[0].text = task\\\\n    row_cells[1].text = role\\\\n    row_cells[2].text = hrs\\\\n    row_cells[3].text = rate\\\\n    row_cells[4].text = amount\\\\n\\\\n# Not-to-exceed fee summary table\\\\n\\\\ntable = doc.add_table(rows=1, cols=4)\\\\ntable.style = \\'Table Grid\\'\\\\ntable.alignment = WD_TABLE_ALIGNMENT.CENTER\\\\nhdr = table.rows[0].cells\\\\nhdr[0].text = \\'Component\\'\\\\nhdr[1].text = \\'Description\\'\\\\nhdr[2].text = \\'Basis\\'\\\\nhdr[3].text = \\'Not to exceed amount\\'\\\\nfor cell in hdr:\\\\n    for run in cell.paragraphs[0].runs:\\\\n        run.bold = True\\\\n\\\\nrows = [\\\\n    (\\'Base Phase 1 services\\', \\'Tasks 1–8 exclusive of contingency\\', \\'Time and materials with cap\\', \\'To be provided in cost form\\'),\\\\n    (\\'Task 6 contingency\\', \\'Focused SSES and unforeseen necessary work\\', \\'Capped contingency\\', \\'$10,000\\'),\\\\n    (\\'Phase 2 Option 1\\', \\'Phase 2 SSES in 81st and Frontier 2 and 80th and Lindbergh\\', \\'Time and materials with cap\\', \\'To be provided in cost form\\'),\\\\n    (\\'Phase 3 Option 2\\', \\'Phase 3 SSES in Mang and 88th including one outfall assessment\\', \\'Time and materials with cap\\', \\'To be provided in cost form\\')\\\\n]\\\\n\\\\nfor comp, desc, basis, amt in rows:\\\\n    row_cells = table.add_row().cells\\\\n    row_cells[0].text = comp\\\\n    row_cells[1].text = desc\\\\n    row_cells[2].text = basis\\\\n    row_cells[3].text = amt\\\\n\\\\n# Billing and invoicing terms acknowledgment table\\\\n\\\\ntable = doc.add_table(rows=1, cols=3)\\\\ntable.style = \\'Table Grid\\'\\\\ntable.alignment = WD_TABLE_ALIGNMENT.CENTER\\\\nhdr = table.rows[0].cells\\\\nhdr[0].text = \\'Requirement\\'\\\\nhdr[1].text = \\'Description\\'\\\\nhdr[2].text = \\'Aurelia acknowledgment\\'\\\\nfor cell in hdr:\\\\n    for run in cell.paragraphs[0].runs:\\\\n        run.bold = True\\\\n\\\\nrows = [\\\\n    (\\'Monthly invoicing with documentation\\', \\'Invoices must include task-level detail and supporting documentation\\', \\'Accepted; Aurelia will provide task-level timesheets and summaries\\'),\\\\n    (\\'Prevailing wage and MWBE/SDVOB reporting\\', \\'Compliance with labor and reporting requirements is a condition of payment\\', \\'Accepted; Aurelia will coordinate with subconsultants to ensure timely reporting\\'),\\\\n    (\\'60-day payment terms and tax exemption\\', \\'NFWB pays within 60 days; NFWB is exempt from certain taxes\\', \\'Accepted; pricing is exclusive of sales tax\\'),\\\\n]\\\\n\\\\nfor req, desc, ack in rows:\\\\n    row_cells = table.add_row().cells\\\\n    row_cells[0].text = req\\\\n    row_cells[1].text = desc\\\\n    row_cells[2].text = ack\\\\n\\\\n# 11. MWBE and SDVOB Participation Strategy\\\\n\\\\ndoc.add_page_break()\\\\n\\\\nh1 = doc.add_heading(\\'11. MWBE and SDVOB Participation Strategy\\', level=1)\\\\n\\\\npara = doc.add_paragraph(\\'Aurelia is committed to meeting or exceeding the MWBE and SDVOB participation goals established in Appendix F, including a combined 30 percent MWBE goal and a 6 percent SDVOB goal. We will submit MWBE and SDVOB utilization plans or waiver requests with the proposal as required and will provide ongoing utilization and workforce reporting throughout the contract.\\', style=\\'Normal\\')\\\\n\\\\n# Mermaid process diagram for MWBE/SDVOB engagement\\\\nmermaid_code = \\'\\'\\'\\\\nflowchart TD\\\\n  A[Identify MWBE and SDVOB firms] --> B[Prequalify capabilities]\\\\n  B --> C[Develop utilization plan]\\\\n  C --> D[Execute subcontracts]\\\\n  D --> E[Track utilization]\\\\n  E --> F[Report to NFWB]\\\\n\\'\\'\\'\\\\nmwbe_path = render_mermaid(mermaid_code, \\'mwbe_process\\')\\\\ndoc.add_picture(str(mwbe_path), width=Inches(5.5))\\\\nadd_caption(\\'Figure 31: MWBE and SDVOB engagement and reporting process\\')\\\\n\\\\n# Stacked bar chart showing planned contract value by vendor type\\\\nvendor_types = [\\'Planned participation\\']\\\\nprime = [64]\\\\nmwbe = [30]\\\\nsdvob = [6]\\\\n\\\\nind = np.arange(len(vendor_types))\\\\nwidth = 0.5\\\\n\\\\nfig, ax = plt.subplots(figsize=(4, 4))\\\\np1 = ax.bar(ind, prime, width, label=\\'Prime (Aurelia)\\')\\\\np2 = ax.bar(ind, mwbe, width, bottom=prime, label=\\'MWBE subconsultants\\')\\\\nbottom3 = np.array(prime) + np.array(mwbe)\\\\np3 = ax.bar(ind, sdvob, width, bottom=bottom3, label=\\'SDVOB subconsultants\\')\\\\nax.set_xticks(ind)\\\\nax.set_xticklabels(vendor_types)\\\\nax.set_ylabel(\\'Percent of contract value\\')\\\\nax.set_ylim(0, 100)\\\\nax.legend(fontsize=8)\\\\nplt.title(\\'Illustrative MWBE and SDVOB participation against goals\\')\\\\nplt.tight_layout()\\\\nstacked_path = output_dir / \\'mwbe_sdvob_stacked.png\\'\\\\nplt.savefig(stacked_path, dpi=150, bbox_inches=\\'tight\\', facecolor=\\'white\\')\\\\nplt.close()\\\\n\\\\ndoc.add_picture(str(stacked_path), width=Inches(4.5))\\\\nadd_caption(\\'Figure 32: Illustrative distribution of contract value by vendor type\\')\\\\n\\\\n# MWBE/SDVOB utilization plan table\\\\n\\\\ntable = doc.add_table(rows=1, cols=5)\\\\ntable.style = \\'Table Grid\\'\\\\ntable.alignment = WD_TABLE_ALIGNMENT.CENTER\\\\nhdr = table.rows[0].cells\\\\nhdr[0].text = \\'Firm\\'\\\\nhdr[1].text = \\'Certification type\\'\\\\nhdr[2].text = \\'Scope of work\\'\\\\nhdr[3].text = \\'Estimated dollar participation\\'\\\\nhdr[4].text = \\'Estimated percent of contract\\'\\\\nfor cell in hdr:\\\\n    for run in cell.paragraphs[0].runs:\\\\n        run.bold = True\\\\n\\\\nrows = [\\\\n    (\\'Field services MWBE firm\\', \\'NYS-certified MWBE\\', \\'Smoke testing, flow isolation support, CCTV crews\\', \\'To be finalized in utilization plan\\', \\'Approximately 20 percent (target)\\'),\\\\n    (\\'Local SDVOB engineering partner\\', \\'NYS-certified SDVOB\\', \\'Resident outreach, coordination, selected design support\\', \\'To be finalized in utilization plan\\', \\'Approximately 6 percent (target)\\'),\\\\n]\\\\n\\\\nfor firm, cert, scope, dol, pct in rows:\\\\n    row_cells = table.add_row().cells\\\\n    row_cells[0].text = firm\\\\n    row_cells[1].text = cert\\\\n    row_cells[2].text = scope\\\\n    row_cells[3].text = dol\\\\n    row_cells[4].text = pct\\\\n\\\\n# Reporting calendar table\\\\n\\\\ntable = doc.add_table(rows=1, cols=3)\\\\ntable.style = \\'Table Grid\\'\\\\ntable.alignment = WD_TABLE_ALIGNMENT.CENTER\\\\nhdr = table.rows[0].cells\\\\nhdr[0].text = \\'Report type\\'\\\\nhdr[1].text = \\'Frequency\\'\\\\nhdr[2].text = \\'Content summary\\'\\\\nfor cell in hdr:\\\\n    for run in cell.paragraphs[0].runs:\\\\n        run.bold = True\\\\n\\\\nrows = [\\\\n    (\\'MWBE and SDVOB utilization report\\', \\'Monthly during active work\\', \\'Contract value awarded and paid to each MWBE and SDVOB firm, by task\\'),\\\\n    (\\'Workforce Employment Utilization Report\\', \\'Monthly or as required\\', \\'Workforce hours by trade, gender, and race/ethnicity\\'),\\\\n    (\\'EEO Staffing Plan updates\\', \\'As needed\\', \\'Updates to staffing plan when key personnel change\\')\\\\n]\\\\n\\\\nfor rtype, freq, cont in rows:\\\\n    row_cells = table.add_row().cells\\\\n    row_cells[0].text = rtype\\\\n    row_cells[1].text = freq\\\\n    row_cells[2].text = cont\\\\n\\\\n# 12. Regulatory, Legal, and Contractual Compliance\\\\n\\\\ndoc.add_page_break()\\\\n\\\\nh1 = doc.add_heading(\\'12. Regulatory, Legal, and Contractual Compliance\\', level=1)\\\\n\\\\npara = doc.add_paragraph(\\'Aurelia acknowledges and accepts the regulatory, legal, and contractual requirements set forth in the RFP, Appendix E, and Appendix F, including compliance with NYSDEC and NYS EFC requirements, the Order on Consent, MWBE and SDVOB obligations, insurance and indemnification requirements, FOIL and data security obligations, prevailing wage, non-discrimination, and other standard terms. Any exceptions, if necessary, will be clearly identified in the Exceptions Attachment.\\', style=\\'Normal\\')\\\\n\\\\n# Compliance matrix table\\\\n\\\\ntable = doc.add_table(rows=1, cols=4)\\\\ntable.style = \\'Table Grid\\'\\\\ntable.alignment = WD_TABLE_ALIGNMENT.CENTER\\\\nhdr = table.rows[0].cells\\\\nhdr[0].text = \\'Requirement area\\'\\\\nhdr[1].text = \\'Relevant REQ IDs\\'\\\\nhdr[2].text = \\'Proposal sections addressing requirement\\'\\\\nhdr[3].text = \\'Acceptance status\\'\\\\nfor cell in hdr:\\\\n    for run in cell.paragraphs[0].runs:\\\\n        run.bold = True\\\\n\\\\nrows = [\\\\n    (\\'NYSDEC and EPG compliance\\', \\'REQ-006, REQ-014, REQ-015, REQ-030\\', \\'Sections 3, 4, 4.7, 4.8, 8, 14\\', \\'Accepted\\'),\\\\n    (\\'MWBE and SDVOB goals and reporting\\', \\'REQ-019, REQ-020, REQ-027\\', \\'Sections 10, 11, 13\\', \\'Accepted; utilization plans to be submitted\\'),\\\\n    (\\'Insurance and indemnification\\', \\'REQ-024, REQ-025\\', \\'Section 12, 13\\', \\'Accepted; Aurelia carries required coverages\\'),\\\\n    (\\'Restricted communications and addenda\\', \\'REQ-003, REQ-004, REQ-034\\', \\'Sections 2, 9\\', \\'Accepted\\'),\\\\n    (\\'NFWB reserved rights and contract incorporation\\', \\'REQ-028\\', \\'Sections 1, 12\\', \\'Acknowledged\\'),\\\\n]\\\\n\\\\nfor area, reqs, secs, status in rows:\\\\n    row_cells = table.add_row().cells\\\\n    row_cells[0].text = area\\\\n    row_cells[1].text = reqs\\\\n    row_cells[2].text = secs\\\\n    row_cells[3].text = status\\\\n\\\\n# Insurance coverage table\\\\n\\\\ntable = doc.add_table(rows=1, cols=4)\\\\ntable.style = \\'Table Grid\\'\\\\ntable.alignment = WD_TABLE_ALIGNMENT.CENTER\\\\nhdr = table.rows[0].cells\\\\nhdr[0].text = \\'Coverage type\\'\\\\nhdr[1].text = \\'Limit (illustrative)\\'\\\\nhdr[2].text = \\'Carrier rating\\'\\\\nhdr[3].text = \\'Additional insured capability\\'\\\\nfor cell in hdr:\\\\n    for run in cell.paragraphs[0].runs:\\\\n        run.bold = True\\\\n\\\\nrows = [\\\\n    (\\'Workers compensation and disability\\', \\'Statutory\\', \\'Rated A or better\\', \\'Certificates naming required entities as additional insureds where applicable\\'),\\\\n    (\\'Commercial general liability\\', \\'$1,000,000 per occurrence, $2,000,000 aggregate or higher\\', \\'Rated A or better\\', \\'Primary and non-contributory additional insured\\'),\\\\n    (\\'Automobile liability\\', \\'$1,000,000 combined single limit\\', \\'Rated A or better\\', \\'Additional insured endorsement\\'),\\\\n    (\\'Umbrella or excess liability\\', \\'$5,000,000 aggregate or higher\\', \\'Rated A or better\\', \\'Follows form over primary policies\\'),\\\\n    (\\'Professional liability\\', \\'$2,000,000 each claim and aggregate or higher\\', \\'Rated A or better\\', \\'Evidence of coverage provided; additional insured where available\\')\\\\n]\\\\n\\\\nfor cov, lim, carr, ai in rows:\\\\n    row_cells = table.add_row().cells\\\\n    row_cells[0].text = cov\\\\n    row_cells[1].text = lim\\\\n    row_cells[2].text = carr\\\\n    row_cells[3].text = ai\\\\n\\\\n# 13. Forms, Certifications, and Exceptions Attachment\\\\n\\\\ndoc.add_page_break()\\\\n\\\\nh1 = doc.add_heading(\\'13. Forms, Certifications, and Exceptions Attachment\\', level=1)\\\\n\\\\npara = doc.add_paragraph(\\'Aurelia will complete and submit all required Appendix E forms and any required MWBE/SDVOB and EEO documentation with the proposal. Any exceptions to the RFP or contract terms will be clearly identified in a separate Exceptions Attachment as required.\\', style=\\'Normal\\')\\\\n\\\\n# Checklist table of completed forms\\\\n\\\\ntable = doc.add_table(rows=1, cols=4)\\\\ntable.style = \\'Table Grid\\'\\\\ntable.alignment = WD_TABLE_ALIGNMENT.CENTER\\\\nhdr = table.rows[0].cells\\\\nhdr[0].text = \\'Form or attachment\\'\\\\nhdr[1].text = \\'Description\\'\\\\nhdr[2].text = \\'Signature status\\'\\\\nhdr[3].text = \\'Location in proposal\\'\\\\nfor cell in hdr:\\\\n    for run in cell.paragraphs[0].runs:\\\\n        run.bold = True\\\\n\\\\nrows = [\\\\n    (\\'Appendix E Form 1\\', \\'Acknowledgement of Addenda\\', \\'Original signed by authorized officer\\', \\'Forms section (back of proposal)\\'),\\\\n    (\\'Appendix E Form 2\\', \\'Certificate of Non-Collusion\\', \\'Original signed\\', \\'Forms section\\'),\\\\n    (\\'Appendix E Form 3\\', \\'Lobbying Law Disclosure\\', \\'Original signed\\', \\'Forms section\\'),\\\\n    (\\'Appendix E Form 4\\', \\'EEO Policy Statement\\', \\'Original signed\\', \\'Forms section\\'),\\\\n    (\\'Appendix E Form 5\\', \\'Statement on Sexual Harassment\\', \\'Original signed\\', \\'Forms section\\'),\\\\n    (\\'Appendix E Form 6\\', \\'RFP Acknowledgement and Certification\\', \\'Original signed\\', \\'Forms section\\'),\\\\n    (\\'MWBE and SDVOB utilization plans or waivers\\', \\'Required Appendix F documentation\\', \\'Signed as applicable\\', \\'Forms section\\'),\\\\n    (\\'EEO Staffing Plan\\', \\'Staffing plan for contract workforce\\', \\'Signed\\', \\'Forms section\\'),\\\\n    (\\'Exceptions Attachment\\', \\'Statement of any exceptions to RFP or contract terms\\', \\'Signed if applicable\\', \\'Immediately following forms\\')\\\\n]\\\\n\\\\nfor form, desc, sig, loc in rows:\\\\n    row_cells = table.add_row().cells\\\\n    row_cells[0].text = form\\\\n    row_cells[1].text = desc\\\\n    row_cells[2].text = sig\\\\n    row_cells[3].text = loc\\\\n\\\\n# 14. Alignment with Aurelia Delivery Model and Quality Assurance\\\\n\\\\ndoc.add_page_break()\\\\n\\\\nh1 = doc.add_heading(\\'14. Alignment with Aurelia Delivery Model and Quality Assurance\\', level=1)\\\\n\\\\npara = doc.add_paragraph(\\'Aurelia delivers complex initiatives using an iterative delivery model with formal governance, security, and quality controls. For the Phase 1 SSES, we align our standard phases—Initiate, Discover, Design, Build, Deploy, Operate and Improve—with the SSES tasks and deliverables to ensure disciplined execution and audit-ready evidence for regulators.\\', style=\\'Normal\\')\\\\n\\\\n# Mermaid mapping of Aurelia phases to SSES tasks\\\\nmermaid_code = \\'\\'\\'\\\\nflowchart LR\\\\n  Init[Initiate] --> Disc[Discover]\\\\n  Disc --> Des[Design]\\\\n  Des --> Build[Build]\\\\n  Build --> Dep[Deploy]\\\\n  Dep --> Oper[Operate and improve]\\\\n  Init --> T1[Task 1]\\\\n  Disc --> T2[Task 2]\\\\n  Disc --> T3[Task 3]\\\\n  Des --> T4[Task 4]\\\\n  Des --> T5[Task 5]\\\\n  Build --> T6[Task 6]\\\\n  Build --> T7[Task 7]\\\\n  Oper --> T8[Task 8]\\\\n\\'\\'\\'\\\\nphases_map_path = render_mermaid(mermaid_code, \\'aurelia_phases_map\\')\\\\ndoc.add_picture(str(phases_map_path), width=Inches(5.8))\\\\nadd_caption(\\'Figure 33: Alignment of Aurelia delivery phases with SSES tasks\\')\\\\n\\\\n# Quality and governance practices table\\\\n\\\\ntable = doc.add_table(rows=1, cols=4)\\\\ntable.style = \\'Table Grid\\'\\\\ntable.alignment = WD_TABLE_ALIGNMENT.CENTER\\\\nhdr = table.rows[0].cells\\\\nhdr[0].text = \\'Aurelia practice\\'\\\\nhdr[1].text = \\'Description\\'\\\\nhdr[2].text = \\'SSES milestone\\'\\\\nhdr[3].text = \\'Evidence produced\\'\\\\nfor cell in hdr:\\\\n    for run in cell.paragraphs[0].runs:\\\\n        run.bold = True\\\\n\\\\nrows = [\\\\n    (\\'Stage gates\\', \\'Formal decision points with documented approvals\\', \\'End of Initiate, Discover, Design phases\\', \\'Stage gate checklists, approval emails, decision logs\\'),\\\\n    (\\'Design reviews\\', \\'Peer review of technical methods and assumptions\\', \\'Before finalizing flow monitoring plan and corrective action plan\\', \\'Review comments, revised plans, sign-offs\\'),\\\\n    (\\'Security and privacy checkpoints\\', \\'Review of data handling and privacy considerations\\', \\'Before handling resident-level data or sensitive infrastructure data\\', \\'Data handling procedures, access controls, training records\\'),\\\\n    (\\'Quality assurance review of reports\\', \\'Independent review of Engineering Report and post-construction report\\', \\'Prior to NFWB and NYSDEC submissions\\', \\'QA review memos, resolved comment logs\\')\\\\n]\\\\n\\\\nfor prac, desc, mile, evid in rows:\\\\n    row_cells = table.add_row().cells\\\\n    row_cells[0].text = prac\\\\n    row_cells[1].text = desc\\\\n    row_cells[2].text = mile\\\\n    row_cells[3].text = evid\\\\n\\\\n# 15. Interview and Presentation Readiness\\\\n\\\\ndoc.add_page_break()\\\\n\\\\nh1 = doc.add_heading(\\'15. Interview and Presentation Readiness\\', level=1)\\\\n\\\\npara = doc.add_paragraph(\\'Aurelia is prepared to participate in informal interviews with NFWB staff and to deliver presentations to the Water Board or staff as part of the evaluation process. During these sessions, we will walk through our technical approach, schedule, and innovations, and we will respond to questions about alternative methods for furnishing services.\\', style=\\'Normal\\')\\\\n\\\\n# Interview/presentation team table\\\\n\\\\ntable = doc.add_table(rows=1, cols=3)\\\\ntable.style = \\'Table Grid\\'\\\\ntable.alignment = WD_TABLE_ALIGNMENT.CENTER\\\\nhdr = table.rows[0].cells\\\\nhdr[0].text = \\'Team member\\'\\\\nhdr[1].text = \\'Role in interview/presentation\\'\\\\nhdr[2].text = \\'Topics covered\\'\\\\nfor cell in hdr:\\\\n    for run in cell.paragraphs[0].runs:\\\\n        run.bold = True\\\\n\\\\nrows = [\\\\n    (\\'Project Manager – Senior Engineer\\', \\'Lead presenter\\', \\'Overall approach, schedule, coordination with NFWB and NYSDEC, risk management\\'),\\\\n    (\\'Field Operations Lead\\', \\'Technical presenter\\', \\'Smoke testing, flow isolation, outfall assessment methods, safety program\\'),\\\\n    (\\'Data and Analytics Lead\\', \\'Technical presenter\\', \\'Data integration, I and I analysis, dashboards, and reporting to NYSDEC\\'),\\\\n    (\\'Health and Safety Coordinator\\', \\'Supporting presenter\\', \\'Health and safety plan, confined space procedures, coordination with other contractors\\'),\\\\n]\\\\n\\\\nfor name, role, topics in rows:\\\\n    row_cells = table.add_row().cells\\\\n    row_cells[0].text = name\\\\n    row_cells[1].text = role\\\\n    row_cells[2].text = topics\\\\n\\\\n# End of document code\\\\n\"}', name='generate_rfp_response'), type='function')])",
  "parsed_result": {
    "document_code_length": 86955
  }
}