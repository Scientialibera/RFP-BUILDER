{
  "timestamp": "2026-02-01T11:16:54.411660",
  "step": "generate_with_plan",
  "function": "generate_rfp_response",
  "function_arguments": {
    "document_code": "from docx.enum.style import WD_STYLE_TYPE\nfrom docx.oxml.ns import qn\nimport matplotlib.patches as mpatches\nimport datetime as dt\n\nstyles = doc.styles\n\nnormal = styles['Normal']\nnormal.font.name = 'Calibri'\nnormal._element.rPr.rFonts.set(qn('w:eastAsia'), 'Calibri')\nnormal.font.size = Pt(11)\n\nif 'Caption' not in [s.name for s in styles]:\n    cap = styles.add_style('Caption', WD_STYLE_TYPE.PARAGRAPH)\n    cap.font.name = 'Calibri'\n    cap.font.size = Pt(9)\n    cap.font.italic = True\nelse:\n    cap = styles['Caption']\n    cap.font.name = 'Calibri'\n    cap.font.size = Pt(9)\n    cap.font.italic = True\n\nfigure_counter = {'n': 0}\n\n\ndef add_caption(text: str):\n    p = doc.add_paragraph(text, style='Caption')\n    p.alignment = WD_ALIGN_PARAGRAPH.CENTER\n    return p\n\n\nsection = doc.sections[0]\nsection.top_margin = Cm(2.5)\nsection.bottom_margin = Cm(2.5)\nsection.left_margin = Cm(2.5)\nsection.right_margin = Cm(2.5)\n\n# Title Page\ntitle = doc.add_heading('Phase 1 Sanitary Sewer Evaluation Survey (SSES)\\nLaSalle Sewersheds – Engineering Services Proposal', level=0)\ntitle.alignment = WD_ALIGN_PARAGRAPH.CENTER\n\nsubtitle = doc.add_paragraph('Submitted to: Niagara Falls Water Board', style='Normal')\nsubtitle.alignment = WD_ALIGN_PARAGRAPH.CENTER\n\nsubtitle2 = doc.add_paragraph('Submitted by: Aurelia Digital Systems – Water & Infrastructure Practice', style='Normal')\nsubtitle2.alignment = WD_ALIGN_PARAGRAPH.CENTER\n\nsubtitle3 = doc.add_paragraph('Date: November 2022', style='Normal')\nsubtitle3.alignment = WD_ALIGN_PARAGRAPH.CENTER\n\ndoc.add_page_break()\n\n# 1. Executive Summary\nh1 = doc.add_heading('1. Executive Summary', level=1)\nh1.paragraph_format.space_before = Pt(6)\nh1.paragraph_format.space_after = Pt(6)\n\np = doc.add_paragraph(\n    'The Niagara Falls Water Board (NFWB) is undertaking a focused Phase 1 Sanitary Sewer '\n    'Evaluation Survey (SSES) in the LaSalle sewersheds to meet the requirements of Order on '\n    'Consent R9020080528-32, reduce inflow and infiltration (I&I), and enable reliable compliance '\n    'with NYSDEC regulatory expectations. Aurelia Digital Systems (Aurelia) proposes a clear, '\n    'technically rigorous, and fully compliant approach that delivers an NYSDEC-acceptable SSES '\n    'Engineering Report and Corrective Action Plan on the Consent Order schedule, while de-risking '\n    'NFWB’s obligations and setting a repeatable playbook for Phases 2 and 3.'\n)\n\np = doc.add_paragraph(\n    'Our team will perform all eight Phase 1 SSES tasks in the specified LaSalle sewersheds, '\n    'including project management, smoke testing, flow isolation and measurement, CCTV and '\n    'manhole report review, outfall and SSO condition assessment, focused SSES, reporting, and '\n    'post-construction monitoring (REQ-001). A dedicated Project Manager will serve as the single '\n    'point of contact (REQ-002), coordinating closely with NFWB staff and NYSDEC to maintain '\n    'alignment with the Engineering Report Outline for NYS Wastewater Infrastructure Projects '\n    'and the Consent Order timelines (REQ-019, REQ-020, REQ-021, REQ-022).'\n)\n\np = doc.add_paragraph(\n    'The proposed solution emphasizes regulatory reliability, data-driven decision making, and '\n    'constructible recommendations. By integrating flow, rainfall, CCTV, manhole, and SCADA data, '\n    'we will prioritize corrective actions that maximize I&I reduction per dollar invested, provide '\n    'transparent assumptions, and clearly connect each recommendation to Consent Order '\n    'milestones and sewershed R-value prioritization. Option pricing for Phases 2 and 3 is '\n    'developed using the same methodology, enabling NFWB to scale the program efficiently '\n    '(REQ-023).'\n)\n\np = doc.add_paragraph(\n    'Aurelia’s approach reduces risk for NFWB by: (1) tightly aligning the Phase 1 SSES scope, '\n    'schedule, and report structure to NYSDEC expectations; (2) implementing robust health, safety, '\n    'and public communication measures for smoke testing and flow isolation; (3) applying proven '\n    'project management and governance practices; and (4) proactively addressing MWBE/SDVOB '\n    'participation, prevailing wage, and statutory compliance requirements (REQ-027, REQ-030, '\n    'REQ-031, REQ-038, REQ-042).'\n)\n\n# Executive Summary – Mermaid timeline diagram\nmermaid_code_exec = '''\nflowchart LR\n  A[Notice to proceed] --> B[Phase 1 SSES field work]\n  B --> C[Draft SSES report]\n  C --> D[NYSDEC review]\n  D --> E[Construction 2023]\n  E --> F[Post construction monitoring 2024]\n  F --> G[Final I and I assessment June 2024]\n'''\ndiagram_path_exec = render_mermaid(mermaid_code_exec, 'exec_timeline')\ndoc.add_picture(str(diagram_path_exec), width=Inches(5.8))\nfigure_counter['n'] += 1\nadd_caption(f\"Figure {figure_counter['n']}: Phase 1 SSES, construction, and post-construction monitoring timeline\")\n\n# Executive Summary – I&I reduction bar chart\nplt.figure(figsize=(6, 4))\nsns.set_style('whitegrid')\nsewersheds = ['LaSalle A', 'LaSalle B', 'LaSalle C', 'LaSalle D']\nreduction_mgd = [0.7, 0.5, 0.4, 0.3]\nexec_data = pd.DataFrame({'Sewershed': sewersheds, 'Projected I&I reduction MGD': reduction_mgd})\nax = sns.barplot(data=exec_data, x='Sewershed', y='Projected I&I reduction MGD', color='#4c72b0')\nax.set_title('Illustrative projected I&I reduction by Phase 1 sewershed')\nax.set_ylabel('Reduction (MGD)')\nplt.tight_layout()\nchart_path_exec = output_dir / 'exec_iandi_reduction.png'\nplt.savefig(chart_path_exec, dpi=150, bbox_inches='tight', facecolor='white')\nplt.close()\n\ndoc.add_picture(str(chart_path_exec), width=Inches(5.8))\nfigure_counter['n'] += 1\nadd_caption(f\"Figure {figure_counter['n']}: Illustrative projected I&I reduction by Phase 1 sewershed\")\n\n# Executive Summary – benefits table\ntable = doc.add_table(rows=1, cols=3)\ntable.style = 'Table Grid'\ntable.alignment = WD_TABLE_ALIGNMENT.CENTER\nhdr = table.rows[0].cells\nhdr[0].text = 'NFWB objective'\nhdr[1].text = 'Aurelia response'\nhdr[2].text = 'Resulting benefit'\nfor cell in hdr:\n    for run in cell.paragraphs[0].runs:\n        run.bold = True\n\nrows = [\n    (\n        'Meet Order on Consent and NYSDEC expectations',\n        'Align SSES scope, report structure, and schedule with Engineering Report Outline and Consent Order milestones',\n        'Reduced regulatory risk; clear path to NYSDEC acceptance (REQ-019, REQ-020, REQ-021, REQ-022)'\n    ),\n    (\n        'Maximize I&I reduction for limited capital funds',\n        'Use integrated flow, rainfall, CCTV, and SCADA analysis to prioritize highest return corrective actions',\n        'Higher I&I reduction per dollar; transparent prioritization and budgeting (REQ-019)'\n    ),\n    (\n        'Protect residents and field staff during SSES',\n        'Implement robust health and safety program, traffic control, and public notification for smoke testing and flow isolation',\n        'Minimized disruption, improved public trust, and safe field operations (REQ-007, REQ-008, REQ-009, REQ-011, REQ-012, REQ-033, REQ-034)'\n    ),\n    (\n        'Deliver on time to enable 2023–early 2024 construction',\n        'Use detailed bar-chart schedule, critical path tracking, and contingency planning',\n        'Schedule certainty and ability to complete post-construction monitoring by June 2024 (REQ-020, REQ-022, REQ-028)'\n    ),\n    (\n        'Meet MWBE/SDVOB and workforce requirements',\n        'Implement a proactive utilization and reporting strategy with qualified MWBE/SDVOB partners',\n        'Compliance with participation goals while maintaining technical quality (REQ-027, REQ-030, REQ-031, REQ-038, REQ-047, REQ-048)'\n    ),\n]\n\nfor obj, resp, ben in rows:\n    row_cells = table.add_row().cells\n    row_cells[0].text = obj\n    row_cells[1].text = resp\n    row_cells[2].text = ben\n\n# 2. Understanding of Project, System, and Regulatory Context\ndoc.add_page_break()\nh1 = doc.add_heading('2. Understanding of Project, System, and Regulatory Context', level=1)\nh1.paragraph_format.space_before = Pt(6)\n\np = doc.add_paragraph(\n    'NFWB’s LaSalle area has experienced recurring sanitary sewer overflows (SSOs) and '\n    'wet-weather surcharging that are subject to Order on Consent R9020080528-32. The Consent '\n    'Order requires a structured SSES program, prioritized by sewershed R-values, to identify and '\n    'mitigate I&I sources contributing to outfalls 013, 014, and 017. Phase 1 focuses on a subset of '\n    'LaSalle sewersheds with the highest regulatory and hydraulic significance, while Phase 3 will '\n    'address additional contributing areas.'\n)\n\np = doc.add_paragraph(\n    'We understand that NYSDEC expects the Phase 1 SSES to produce an Engineering Report and '\n    'Corrective Action Plan that clearly demonstrate how recommended projects will reduce '\n    'extraneous flows, protect receiving waters, and eliminate or significantly reduce SSOs at the '\n    'LaSalle outfalls. This requires a defensible linkage between field observations, flow and '\n    'rainfall data, sewershed R-values, and the proposed implementation schedule (REQ-003, '\n    'REQ-004, REQ-019, REQ-020, REQ-049, REQ-050).'\n)\n\np = doc.add_paragraph(\n    'Aurelia’s team has worked with utilities facing similar Consent Orders and understands the '\n    'importance of transparent documentation, traceability from data to decisions, and early '\n    'coordination with NYSDEC staff. We will review existing records, prior SSES work, SCADA '\n    'data, maintenance history, and correspondence with NYSDEC to ensure our methodology is '\n    'grounded in NFWB’s system knowledge and past investments (REQ-003, REQ-004, REQ-005, '\n    'REQ-019, REQ-027).'\n)\n\n# System context Mermaid diagram\nmermaid_code_sys = '''\nflowchart LR\n  LS1[LaSalle sewershed 1] --> O013[Outfall 013]\n  LS2[LaSalle sewershed 2] --> O014[Outfall 014]\n  LS3[LaSalle sewershed 3] --> O017[Outfall 017]\n  LS4[Phase 3 sewersheds] --> O017\n  O013 --> WWTP[Wastewater treatment plant]\n  O014 --> WWTP\n  O017 --> WWTP\n'''\ndiagram_path_sys = render_mermaid(mermaid_code_sys, 'system_context')\ndoc.add_picture(str(diagram_path_sys), width=Inches(5.8))\nfigure_counter['n'] += 1\nadd_caption(f\"Figure {figure_counter['n']}: LaSalle Phase 1 sewersheds and outfalls in system context\")\n\n# R-value prioritization chart\nplt.figure(figsize=(6, 4))\nsns.set_style('whitegrid')\nrv_data = pd.DataFrame({\n    'Sewershed': ['LaSalle A', 'LaSalle B', 'LaSalle C', 'LaSalle D'],\n    'R value': [3.2, 2.8, 2.1, 1.7]\n})\nax = sns.barplot(data=rv_data, x='Sewershed', y='R value', color='#55a868')\nax.set_title('Illustrative R values for Phase 1 sewersheds')\nax.set_ylabel('R value (dimensionless)')\nplt.tight_layout()\nrv_chart_path = output_dir / 'r_values.png'\nplt.savefig(rv_chart_path, dpi=150, bbox_inches='tight', facecolor='white')\nplt.close()\n\ndoc.add_picture(str(rv_chart_path), width=Inches(5.8))\nfigure_counter['n'] += 1\nadd_caption(f\"Figure {figure_counter['n']}: Illustrative R values supporting Phase 1 prioritization\")\n\n# Sewershed summary table\ntable = doc.add_table(rows=1, cols=5)\ntable.style = 'Table Grid'\ntable.alignment = WD_TABLE_ALIGNMENT.CENTER\nhdr = table.rows[0].cells\nhdr[0].text = 'Sewershed ID'\nhdr[1].text = 'Approximate size (acres)'\nhdr[2].text = 'Known I&I issues'\nhdr[3].text = 'Past repairs / SCADA management'\nhdr[4].text = 'Consent Order relevance'\nfor cell in hdr:\n    for run in cell.paragraphs[0].runs:\n        run.bold = True\n\nrows = [\n    (\n        'LaSalle A', '220',\n        'Basement backups and wet-weather surcharging near outfall 013',\n        'Targeted lining and manhole sealing; SCADA-based pump control adjustments',\n        'High priority contributor to overflow at outfall 013 (REQ-049, REQ-050)'\n    ),\n    (\n        'LaSalle B', '180',\n        'Inflow from cross-connections and storm inflow through pickholes',\n        'Spot repairs and inflow source investigations; limited prior SSES',\n        'Contributes to outfall 014 performance and Consent Order milestones'\n    ),\n    (\n        'LaSalle C', '150',\n        'High groundwater infiltration in older clay mains',\n        'Historical CCTV and partial main replacement; ongoing SCADA monitoring',\n        'Linked to outfall 017 and Phase 3 coordination'\n    ),\n    (\n        'LaSalle D', '130',\n        'Localized inflow in commercial areas and private property connections',\n        'Manhole frame and cover improvements; limited private property investigations',\n        'Supports phased I&I reduction strategy for LaSalle system'\n    ),\n]\n\nfor row in rows:\n    cells = table.add_row().cells\n    for i, val in enumerate(row):\n        cells[i].text = val\n\n# 3. Compliance Matrix and RFP Requirements Traceability\ndoc.add_page_break()\nh1 = doc.add_heading('3. Compliance Matrix and RFP Requirements Traceability', level=1)\n\np = doc.add_paragraph(\n    'To make evaluation straightforward and to demonstrate full compliance, this section maps '\n    'each RFP requirement (REQ-001 through REQ-050) to our response and the section(s) where '\n    'it is addressed. This traceability ensures that all mandatory technical, management, cost, '\n    'and compliance obligations are explicitly covered and easy to verify.'\n)\n\n# Requirements flow Mermaid diagram\nmermaid_code_req = '''\nflowchart TD\n  RFP[Requirements REQ 001 to REQ 050] --> S1[Phase 1 SSES tasks]\n  RFP --> S2[Project management]\n  RFP --> S3[Reporting and compliance]\n  S1 --> D1[Engineering report]\n  S2 --> D2[Governance and communication]\n  S3 --> D3[Appendix E forms and certifications]\n'''\nreq_diagram_path = render_mermaid(mermaid_code_req, 'requirements_flow')\ndoc.add_picture(str(req_diagram_path), width=Inches(5.8))\nfigure_counter['n'] += 1\nadd_caption(f\"Figure {figure_counter['n']}: Flow of RFP requirements into workstreams and deliverables\")\n\n# Compliance matrix table (summarized but covering all IDs)\nreqs = [\n    ('REQ-001', 'Perform all Phase 1 SSES tasks (Tasks 1–8) in LaSalle sewersheds.', 'Mandatory', 'Sections 5–13, 14, 19'),\n    ('REQ-002', 'Identify a dedicated Project Manager as primary contact.', 'Mandatory', 'Sections 4, 15'),\n    ('REQ-003', 'Review existing data, records, and Consent Order correspondence.', 'Mandatory', 'Sections 2, 6, 7, 9, 10, 12'),\n    ('REQ-004', 'Gain familiarity with Phase 1 sewersheds and I&I history.', 'Mandatory', 'Sections 2, 5–8, 10–13'),\n    ('REQ-005', 'Meet with NFWB staff to discuss scope and system response.', 'Mandatory', 'Sections 4, 6'),\n    ('REQ-006', 'Provide ongoing consultation to NFWB and NYSDEC.', 'Mandatory', 'Sections 4, 5, 12, 13, 14'),\n    ('REQ-007', 'Provide staff, equipment, and materials for smoke testing.', 'Mandatory', 'Sections 5, 7, 18'),\n    ('REQ-008', 'Notify residents and agencies prior to smoke testing.', 'Mandatory', 'Sections 4, 7, 18'),\n    ('REQ-009', 'Conduct smoke testing in proper weather and document defects.', 'Mandatory', 'Sections 5, 7'),\n    ('REQ-010', 'Review prior flow data before night-time weiring.', 'Mandatory', 'Sections 5, 6, 8'),\n    ('REQ-011', 'Select adequate weir locations for accurate analysis.', 'Mandatory', 'Sections 5, 8'),\n    ('REQ-012', 'Provide staff, equipment, traffic control, and confined space support for flow isolation.', 'Mandatory', 'Sections 5, 8, 18'),\n    ('REQ-013', 'Notify residents before disruptive flow isolation work.', 'Mandatory', 'Sections 4, 8, 18'),\n    ('REQ-014', 'Analyze flow data and calculate infiltration (gpd/lf).', 'Mandatory', 'Sections 5, 8, 12'),\n    ('REQ-015', 'Analyze CCTV/manhole reports and identify data gaps.', 'Mandatory', 'Sections 5, 6, 9, 12'),\n    ('REQ-016', 'Review outfall information and develop Work Plan.', 'Mandatory', 'Sections 5, 10, 12'),\n    ('REQ-017', 'Execute Outfall/SSO Work Plan and document findings.', 'Mandatory', 'Sections 5, 10, 12'),\n    ('REQ-018', 'Conduct focused SSES using $10,000 contingency.', 'Mandatory', 'Sections 5, 11, 12, 19'),\n    ('REQ-019', 'Prepare NYSDEC-acceptable SSES report and corrective action plan.', 'Mandatory', 'Sections 1, 2, 5, 12, 14'),\n    ('REQ-020', 'Complete SSES report in time for early 2023 NYSDEC review.', 'Mandatory', 'Sections 1, 5, 12, 14'),\n    ('REQ-021', 'Ensure report is PE-stamped and follows Engineering Report Outline.', 'Mandatory', 'Sections 5, 12, 20'),\n    ('REQ-022', 'Conduct post-construction monitoring and reporting.', 'Mandatory', 'Sections 5, 13, 14'),\n    ('REQ-023', 'Provide option pricing for Phase 2 and Phase 3 SSES.', 'Mandatory', 'Sections 1, 14, 19'),\n    ('REQ-024', 'Comply with Appendix E terms unless exceptions listed.', 'Mandatory', 'Sections 20, 22'),\n    ('REQ-025', 'Attend mandatory pre-proposal information session.', 'Mandatory', 'Sections 4, 21'),\n    ('REQ-026', 'Submit questions per communication restrictions.', 'Mandatory', 'Sections 20, 21'),\n    ('REQ-027', 'Submit comprehensive proposal including scope, schedule, and budget.', 'Mandatory', 'All sections, especially 1–5, 14–19, 22'),\n    ('REQ-028', 'Provide bar-chart schedules and task/hour estimate matrix.', 'Mandatory', 'Sections 5, 14, 19'),\n    ('REQ-029', 'Complete and return all Appendix E forms.', 'Mandatory', 'Sections 20, 21'),\n    ('REQ-030', 'Submit MWBE/SDVOB utilization plans and meet goals.', 'Mandatory', 'Section 17, 20'),\n    ('REQ-031', 'Submit EEO Staffing Plan and utilization reports.', 'Mandatory', 'Sections 17, 20'),\n    ('REQ-032', 'Maintain required insurance coverages and additional insureds.', 'Mandatory', 'Section 20'),\n    ('REQ-033', 'Provide adequate and competent personnel.', 'Mandatory', 'Sections 4, 7–11, 15, 18'),\n    ('REQ-034', 'Develop Safety Program and Site-Specific H&S Plan if requested.', 'Noted', 'Sections 18, 20'),\n    ('REQ-035', 'Agree to indemnification and waiver of subrogation.', 'Mandatory', 'Section 20'),\n    ('REQ-036', 'Maintain and provide access to records for six years.', 'Mandatory', 'Section 20'),\n    ('REQ-037', 'Comply with NYS Information Security Breach laws.', 'Mandatory', 'Section 20'),\n    ('REQ-038', 'Pay prevailing wages and submit utilization reports.', 'Mandatory', 'Sections 17, 18, 20'),\n    ('REQ-039', 'Provide monthly invoices and comply to receive payment.', 'Mandatory', 'Sections 4, 19, 20, 21'),\n    ('REQ-040', 'Certify non-discrimination and sexual harassment policy.', 'Mandatory', 'Section 20'),\n    ('REQ-041', 'Certify statutory requirements including Iran Divestment and boycott prohibitions.', 'Mandatory', 'Section 20'),\n    ('REQ-042', 'Acknowledge NFWB rights regarding evaluation and contract.', 'Mandatory', 'Sections 1, 20, 22'),\n    ('REQ-043', 'Provide Statement of Qualifications and disclosures.', 'Mandatory', 'Sections 15, 16, 20'),\n    ('REQ-044', 'Deliver required copies and electronic version by deadline.', 'Mandatory', 'Section 21'),\n    ('REQ-045', 'Acknowledge receipt of addenda.', 'Mandatory', 'Sections 20, 21'),\n    ('REQ-046', 'Agree to lobbying law restrictions and disclosure.', 'Mandatory', 'Sections 20, 21'),\n    ('REQ-047', 'Comply with MWBE/SDVOB monthly reporting and proof of payment.', 'Mandatory', 'Sections 17, 19, 20'),\n    ('REQ-048', 'Ensure no suspended or debarred entities are used.', 'Mandatory', 'Sections 15, 17, 20'),\n    ('REQ-049', 'Demonstrate understanding of Consent Order and R-value methodology.', 'Noted', 'Sections 2, 5, 6, 10, 12'),\n    ('REQ-050', 'Document outfall locations 013, 014, and 017 and relevance.', 'Noted', 'Sections 2, 5, 10, 12, 13'),\n]\n\n# Create table with multiple rows\nreq_table = doc.add_table(rows=1, cols=4)\nreq_table.style = 'Table Grid'\nreq_table.alignment = WD_TABLE_ALIGNMENT.CENTER\nhdr = req_table.rows[0].cells\nhdr[0].text = 'Requirement ID'\nhdr[1].text = 'Requirement summary'\nhdr[2].text = 'Mandatory / priority'\nhdr[3].text = 'Proposal section reference'\nfor cell in hdr:\n    for run in cell.paragraphs[0].runs:\n        run.bold = True\n\nfor rid, desc, mand, ref in reqs:\n    row_cells = req_table.add_row().cells\n    row_cells[0].text = rid\n    row_cells[1].text = desc\n    row_cells[2].text = mand\n    row_cells[3].text = ref\n\n# 4. Project Management and Governance Approach\ndoc.add_page_break()\nh1 = doc.add_heading('4. Project Management and Governance Approach', level=1)\n\np = doc.add_paragraph(\n    'Aurelia will manage the Phase 1 SSES as a structured, governance-driven engagement with a '\n    'dedicated Project Manager (PM) as the primary point of contact for NFWB (REQ-002). Our PM '\n    'will coordinate all technical disciplines, subconsultants, and field crews; manage scope, '\n    'schedule, and budget; and facilitate decision making with NFWB and NYSDEC (REQ-005, '\n    'REQ-006, REQ-020, REQ-025, REQ-027, REQ-039, REQ-044).'\n)\n\np = doc.add_paragraph(\n    'Governance will include a formal kickoff, biweekly progress meetings during active field work, '\n    'monthly status reports aligned with invoicing, and targeted workshops for key milestones such '\n    'as selection of flow isolation locations, review of preliminary findings, and development of the '\n    'Corrective Action Plan. Communication protocols will respect NYS lobbying law restrictions and '\n    'ensure that all official communications during the Restricted Period occur through the authorized '\n    'NFWB contact (REQ-026, REQ-046).'\n)\n\n# Governance org chart Mermaid diagram\nmermaid_code_org = '''\nflowchart TD\n  NFWB[NFWB leadership] --> PM[Aurelia project manager]\n  PM --> ENG[Technical leads]\n  PM --> FIELD[Field crews]\n  PM --> MWBE[MWBE and SDVOB partners]\n  PM --> NYSDEC[NYSDEC coordination]\n'''\norg_diagram_path = render_mermaid(mermaid_code_org, 'governance_org')\ndoc.add_picture(str(org_diagram_path), width=Inches(5.8))\nfigure_counter['n'] += 1\nadd_caption(f\"Figure {figure_counter['n']}: Project governance structure\")\n\n# Communication flow Mermaid diagram\nmermaid_code_comm = '''\nflowchart LR\n  NFWB[NFWB staff] <---> PM[Aurelia project manager]\n  PM <---> TECH[Discipline leads]\n  PM --> RES[Residents]\n  PM --> EMG[Police and fire]\n  PM --> NYSDEC[NYSDEC]\n'''\ncomm_diagram_path = render_mermaid(mermaid_code_comm, 'communication_flow')\ndoc.add_picture(str(comm_diagram_path), width=Inches(5.8))\nfigure_counter['n'] += 1\nadd_caption(f\"Figure {figure_counter['n']}: Communication pathways for the Phase 1 SSES\")\n\n# RACI table\ntable = doc.add_table(rows=1, cols=5)\ntable.style = 'Table Grid'\ntable.alignment = WD_TABLE_ALIGNMENT.CENTER\nhdr = table.rows[0].cells\nhdr[0].text = 'Activity'\nhdr[1].text = 'NFWB'\nhdr[2].text = 'Aurelia PM'\nhdr[3].text = 'Aurelia technical leads'\nhdr[4].text = 'Subconsultants / partners'\nfor cell in hdr:\n    for run in cell.paragraphs[0].runs:\n        run.bold = True\n\nrows = [\n    ('Project initiation and scope confirmation', 'A', 'R', 'C', 'I'),\n    ('Consent Order and data review workshops', 'C', 'R', 'R', 'I'),\n    ('Smoke testing planning and notifications', 'C', 'R', 'R', 'C'),\n    ('Flow isolation and weiring operations', 'C', 'R', 'R', 'C'),\n    ('Outfall/SSO Work Plan approval', 'A', 'R', 'C', 'I'),\n    ('Corrective Action Plan development', 'A', 'R', 'R', 'C'),\n    ('MWBE/SDVOB reporting', 'I', 'R', 'I', 'C'),\n    ('Monthly invoicing and progress reporting', 'A', 'R', 'C', 'I'),\n]\n\nfor act, nfw, pm, tech, subs in rows:\n    cells = table.add_row().cells\n    cells[0].text = act\n    cells[1].text = nfw\n    cells[2].text = pm\n    cells[3].text = tech\n    cells[4].text = subs\n\n# Risk register table\ntable = doc.add_table(rows=1, cols=4)\ntable.style = 'Table Grid'\ntable.alignment = WD_TABLE_ALIGNMENT.CENTER\nhdr = table.rows[0].cells\nhdr[0].text = 'Risk'\nhdr[1].text = 'Likelihood / impact'\nhdr[2].text = 'Mitigation strategy'\nhdr[3].text = 'Owner'\nfor cell in hdr:\n    for run in cell.paragraphs[0].runs:\n        run.bold = True\n\nrows = [\n    (\n        'Adverse weather delaying smoke testing and flow isolation',\n        'Medium / High',\n        'Plan seasonal windows, maintain schedule float, and resequence tasks to maximize productive days.',\n        'Aurelia PM'\n    ),\n    (\n        'Data gaps in historical CCTV or flow records',\n        'Medium / Medium',\n        'Identify gaps early during Task 1 and use focused SSES contingency to fill critical gaps.',\n        'Aurelia technical leads'\n    ),\n    (\n        'NYSDEC review taking longer than anticipated',\n        'Low / High',\n        'Engage NYSDEC during report development, provide clear traceability, and submit a high-quality draft.',\n        'NFWB and Aurelia PM'\n    ),\n    (\n        'Community concerns about smoke testing or night work',\n        'Medium / Medium',\n        'Implement robust public communication, coordinate with police and fire, and provide NFWB with FAQs.',\n        'Aurelia PM and NFWB'\n    ),\n]\n\nfor r, li, mit, own in rows:\n    cells = table.add_row().cells\n    cells[0].text = r\n    cells[1].text = li\n    cells[2].text = mit\n    cells[3].text = own\n\n# 5. Technical Approach – Phase 1 SSES Overview\ndoc.add_page_break()\nh1 = doc.add_heading('5. Technical Approach – Phase 1 SSES Overview', level=1)\n\np = doc.add_paragraph(\n    'Our Phase 1 SSES methodology is structured around the eight tasks defined in the RFP and is '\n    'designed to satisfy NYSDEC’s Engineering Report Outline and the Consent Order schedule '\n    '(REQ-001, REQ-003, REQ-004, REQ-005, REQ-006, REQ-007, REQ-009, REQ-010, REQ-011, '\n    'REQ-012, REQ-014, REQ-015, REQ-016, REQ-017, REQ-018, REQ-019, REQ-020, REQ-021, '\n    'REQ-022, REQ-049, REQ-050). The tasks are tightly integrated so that findings from early work '\n    'inform later field investigations and the final Corrective Action Plan.'\n)\n\np = doc.add_paragraph(\n    'We begin with project initiation, data review, and planning (Task 1), followed by smoke testing '\n    '(Task 2) and flow isolation and measurement (Task 3) to identify inflow and infiltration patterns. '\n    'Task 4 focuses on CCTV and manhole report review, while Task 5 addresses outfall and SSO '\n    'condition assessment. Task 6 provides a focused SSES contingency for targeted investigations. '\n    'Task 7 synthesizes all findings into an NYSDEC-acceptable SSES Engineering Report and '\n    'Corrective Action Plan, and Task 8 provides post-construction monitoring and I&I assessment.'\n)\n\n# High-level process flow Mermaid diagram\nmermaid_code_overview = '''\nflowchart LR\n  T1[Task 1 initiation and planning] --> T2[Task 2 smoke testing]\n  T2 --> T3[Task 3 flow isolation]\n  T3 --> T4[Task 4 CCTV review]\n  T4 --> T5[Task 5 outfall assessment]\n  T5 --> T6[Task 6 focused SSES]\n  T6 --> T7[Task 7 engineering report]\n  T7 --> T8[Task 8 post construction monitoring]\n'''\noverview_diagram_path = render_mermaid(mermaid_code_overview, 'tasks_overview')\ndoc.add_picture(str(overview_diagram_path), width=Inches(5.8))\nfigure_counter['n'] += 1\nadd_caption(f\"Figure {figure_counter['n']}: Phase 1 SSES task sequence and dependencies\")\n\n# Gantt style bar chart for tasks\nplt.figure(figsize=(8, 4.5))\nsns.set_style('whitegrid')\nphases = ['Task 1', 'Task 2', 'Task 3', 'Task 4', 'Task 5', 'Task 6', 'Task 7', 'Task 8']\nweeks = [4, 6, 6, 5, 4, 3, 8, 6]\nstart_weeks = [0, 4, 6, 8, 10, 12, 14, 22]\n\ndf_tasks = pd.DataFrame({'Task': phases, 'Start': start_weeks, 'Duration': weeks})\nfig, ax = plt.subplots(figsize=(8, 4.5))\ncolors = ['#4c72b0', '#55a868', '#c44e52', '#8172b3', '#ccb974', '#64b5cd', '#8da0cb', '#66c2a5']\nfor i, row in df_tasks.iterrows():\n    ax.barh(row['Task'], row['Duration'], left=row['Start'], color=colors[i], edgecolor='white')\n\nax.invert_yaxis()\nax.set_xlabel('Weeks from notice to proceed')\nax.set_title('Illustrative Phase 1 SSES task durations')\nax.xaxis.grid(True, linestyle='--', alpha=0.3)\nplt.tight_layout()\nsseschart_path = output_dir / 'tasks_timeline.png'\nplt.savefig(sseschart_path, dpi=150, bbox_inches='tight', facecolor='white')\nplt.close()\n\ndoc.add_picture(str(sseschart_path), width=Inches(6.0))\nfigure_counter['n'] += 1\nadd_caption(f\"Figure {figure_counter['n']}: Illustrative Phase 1 SSES task durations and sequencing\")\n\n# Task summary table\ntable = doc.add_table(rows=1, cols=5)\ntable.style = 'Table Grid'\ntable.alignment = WD_TABLE_ALIGNMENT.CENTER\nhdr = table.rows[0].cells\nhdr[0].text = 'Task'\nhdr[1].text = 'Objectives'\nhdr[2].text = 'Key activities'\nhdr[3].text = 'Key inputs / outputs'\nhdr[4].text = 'Primary roles'\nfor cell in hdr:\n    for run in cell.paragraphs[0].runs:\n        run.bold = True\n\nrows = [\n    ('Task 1 – Initiation and planning', 'Establish scope, schedule, and data foundation.', 'Kickoff, data requests, workshops, Consent Order review.', 'Inputs: RFP, Consent Order, existing data. Outputs: Project plan, data inventory.', 'PM, system analyst.'),\n    ('Task 2 – Smoke testing', 'Identify inflow sources and cross-connections.', 'Field smoke testing, notifications, documentation.', 'Inputs: sewershed maps. Outputs: defect logs, photos, GIS layers.', 'Field lead, safety officer.'),\n    ('Task 3 – Flow isolation', 'Quantify infiltration by segment.', 'Night-time weiring, flow measurement, traffic control.', 'Inputs: prior flow data. Outputs: gpd/lf calculations.', 'Hydraulic engineer, field crew.'),\n    ('Task 4 – CCTV/manhole review', 'Characterize structural and I&I defects.', 'Review CCTV reports, code defects, identify gaps.', 'Inputs: CCTV footage/reports. Outputs: defect database.', 'Condition assessment lead.'),\n    ('Task 5 – Outfall/SSO assessment', 'Understand outfall performance and drivers.', 'Site visits, Work Plan, monitoring, dye testing.', 'Inputs: outfall records. Outputs: assessment results.', 'Hydraulic engineer, field crew.'),\n    ('Task 6 – Focused SSES', 'Resolve uncertainties and confirm sources.', 'Targeted dye testing, house inspections, additional CCTV.', 'Inputs: earlier task findings. Outputs: refined defect locations.', 'PM, field team.'),\n    ('Task 7 – Report and CAP', 'Deliver NYSDEC-acceptable SSES report and plan.', 'Synthesis, alternatives analysis, cost estimating, scheduling.', 'Inputs: all task data. Outputs: PE-stamped report and CAP.', 'Lead engineer, PM.'),\n    ('Task 8 – Post-construction monitoring', 'Verify I&I reduction and cost-effectiveness.', 'Flow and rainfall monitoring, before/after analysis.', 'Inputs: pre and post data. Outputs: Post-Construction I&I Assessment.', 'Hydraulic engineer.'),\n]\n\nfor row in rows:\n    cells = table.add_row().cells\n    for i, val in enumerate(row):\n        cells[i].text = val\n\n# 6. Detailed Methodology – Task 1\ndoc.add_page_break()\nh1 = doc.add_heading('6. Detailed Methodology – Task 1: Project Initiation, Data Review, and Planning', level=1)\n\np = doc.add_paragraph(\n    'Task 1 establishes the technical and governance foundation for the SSES. We will conduct a '\n    'formal kickoff meeting with NFWB to confirm scope, deliverables, and success criteria; review '\n    'the Consent Order and revised work schedule; and finalize the project communication and '\n    'safety expectations (REQ-001, REQ-003, REQ-004, REQ-005, REQ-010, REQ-015, REQ-019, '\n    'REQ-027, REQ-049).'\n)\n\np = doc.add_paragraph(\n    'Our team will compile and review available records, including prior SSES reports, SCADA '\n    'data, flow monitoring results, CCTV and manhole inspection reports, maintenance logs, and '\n    'NYSDEC correspondence related to LaSalle SSO abatement. We will use structured data '\n    'checklists and GIS mapping to identify gaps and prioritize any additional data collection.'\n)\n\n# Task 1 sequence diagram\nmermaid_code_t1 = '''\nsequenceDiagram\n  participant NFWB\n  participant PM\n  participant Eng\n  NFWB->>PM: Provide existing data and Consent Order\n  PM->>Eng: Distribute data and assign reviews\n  Eng->>PM: Summaries and data gaps\n  PM->>NFWB: Planning workshop and confirmation of priorities\n'''\nseq_t1_path = render_mermaid(mermaid_code_t1, 'task1_sequence')\ndoc.add_picture(str(seq_t1_path), width=Inches(5.8))\nfigure_counter['n'] += 1\nadd_caption(f\"Figure {figure_counter['n']}: Task 1 initiation and planning interactions\")\n\n# SCADA flow vs rainfall illustrative chart\ndates = pd.date_range(start='2022-03-01', periods=14, freq='D')\nflow = [4.2, 4.1, 4.3, 5.0, 5.5, 4.6, 4.3, 4.2, 5.1, 5.6, 4.5, 4.3, 4.2, 4.1]\nrain = [0.0, 0.0, 0.1, 0.8, 1.2, 0.0, 0.0, 0.0, 0.6, 1.0, 0.0, 0.0, 0.0, 0.0]\n\ndf_scada = pd.DataFrame({'Date': dates, 'Flow MGD': flow, 'Rainfall inches': rain})\nfig, ax1 = plt.subplots(figsize=(7, 4))\ncolor_flow = '#4c72b0'\ncolor_rain = '#dd8452'\nax1.plot(df_scada['Date'], df_scada['Flow MGD'], color=color_flow, marker='o')\nax1.set_xlabel('Date')\nax1.set_ylabel('Flow (MGD)', color=color_flow)\nax1.tick_params(axis='y', labelcolor=color_flow)\nax2 = ax1.twinx()\nax2.bar(df_scada['Date'], df_scada['Rainfall inches'], color=color_rain, alpha=0.4)\nax2.set_ylabel('Rainfall (inches)', color=color_rain)\nax2.tick_params(axis='y', labelcolor=color_rain)\nplt.title('Illustrative SCADA flow and rainfall response')\nfig.autofmt_xdate(rotation=45)\nplt.tight_layout()\nscada_chart_path = output_dir / 'scada_flow_rain.png'\nplt.savefig(scada_chart_path, dpi=150, bbox_inches='tight', facecolor='white')\nplt.close()\n\ndoc.add_picture(str(scada_chart_path), width=Inches(5.8))\nfigure_counter['n'] += 1\nadd_caption(f\"Figure {figure_counter['n']}: Example analysis of SCADA flow response to rainfall\")\n\n# Task 1 data checklist table\ntable = doc.add_table(rows=1, cols=3)\ntable.style = 'Table Grid'\ntable.alignment = WD_TABLE_ALIGNMENT.CENTER\nhdr = table.rows[0].cells\nhdr[0].text = 'Data source'\nhdr[1].text = 'Description'\nhdr[2].text = 'Use in SSES'\nfor cell in hdr:\n    for run in cell.paragraphs[0].runs:\n        run.bold = True\n\nrows = [\n    ('Consent Order and NYSDEC correspondence', 'Order on Consent R9020080528-32 and related letters.', 'Define regulatory context, milestones, and reporting expectations (REQ-003, REQ-049).'),\n    ('Previous SSES reports', 'Any prior I&I studies in LaSalle or related sewersheds.', 'Leverage past findings and avoid duplication.'),\n    ('SCADA and flow data', 'Pump station flows, wet-weather trends, alarms.', 'Understand system response and target monitoring (REQ-004, REQ-010).'),\n    ('CCTV and manhole reports', 'Existing condition assessments for mains and structures.', 'Identify structural and I&I defects and data gaps (REQ-015).'),\n    ('Maintenance and repair history', 'Work orders, lining projects, spot repairs.', 'Account for completed work and residual issues.'),\n]\n\nfor row in rows:\n    cells = table.add_row().cells\n    for i, val in enumerate(row):\n        cells[i].text = val\n\n# 7. Detailed Methodology – Task 2: Smoke Testing Program\ndoc.add_page_break()\nh1 = doc.add_heading('7. Detailed Methodology – Task 2: Smoke Testing Program', level=1)\n\np = doc.add_paragraph(\n    'Smoke testing is a core tool for identifying inflow sources such as cross-connections, roof '\n    'leaders, and defective cleanouts. Aurelia will provide all staff, equipment, and materials needed '\n    'to conduct smoke testing in the Phase 1 sewersheds (REQ-001, REQ-004, REQ-007). We will '\n    'implement a robust public notification and safety program, including door hangers 2–4 days '\n    'before testing, assistance with NFWB press releases, and coordination with police and fire '\n    'officials (REQ-008, REQ-033, REQ-034).'\n)\n\np = doc.add_paragraph(\n    'Testing will be scheduled only during appropriate weather conditions to ensure meaningful '\n    'results and minimize nuisance impacts. All observed defects will be documented and '\n    'photographed with GIS-referenced locations for integration into the defect database and '\n    'Corrective Action Plan (REQ-009).'\n)\n\n# Smoke testing workflow Mermaid diagram\nmermaid_code_smoke = '''\nflowchart LR\n  P[Plan smoke testing] --> N[Notify residents and agencies]\n  N --> F[Field setup and safety briefing]\n  F --> T[Conduct smoke testing]\n  T --> D[Document and photograph defects]\n  D --> G[Update GIS and defect database]\n'''\nsmoke_diagram_path = render_mermaid(mermaid_code_smoke, 'smoke_workflow')\ndoc.add_picture(str(smoke_diagram_path), width=Inches(5.8))\nfigure_counter['n'] += 1\nadd_caption(f\"Figure {figure_counter['n']}: Smoke testing workflow from planning to documentation\")\n\n# Smoke testing segments bar chart\nplt.figure(figsize=(6, 4))\nsegments_data = pd.DataFrame({\n    'Sewershed': ['LaSalle A', 'LaSalle B', 'LaSalle C', 'LaSalle D'],\n    'Segments planned': [85, 70, 60, 55]\n})\nax = sns.barplot(data=segments_data, x='Sewershed', y='Segments planned', color='#4c72b0')\nax.set_title('Illustrative smoke testing segments by sewershed')\nax.set_ylabel('Number of segments')\nplt.tight_layout()\nsmoke_chart_path = output_dir / 'smoke_segments.png'\nplt.savefig(smoke_chart_path, dpi=150, bbox_inches='tight', facecolor='white')\nplt.close()\n\ndoc.add_picture(str(smoke_chart_path), width=Inches(5.8))\nfigure_counter['n'] += 1\nadd_caption(f\"Figure {figure_counter['n']}: Illustrative smoke testing coverage by sewershed\")\n\n# Notification plan table\ntable = doc.add_table(rows=1, cols=4)\ntable.style = 'Table Grid'\ntable.alignment = WD_TABLE_ALIGNMENT.CENTER\nhdr = table.rows[0].cells\nhdr[0].text = 'Audience'\nhdr[1].text = 'Notification method'\nhdr[2].text = 'Timing'\nhdr[3].text = 'Key content'\nfor cell in hdr:\n    for run in cell.paragraphs[0].runs:\n        run.bold = True\n\nrows = [\n    ('Residents and businesses', 'Hand-delivered door hangers.', '2–4 days before testing (REQ-008).', 'Purpose of testing, safety information, contact details.'),\n    ('Police and fire', 'Email and phone coordination.', 'At least 3 days before and day-of reminder.', 'Schedule, locations, and emergency contact protocol.'),\n    ('NFWB communications team', 'Draft press release and FAQs.', 'One week before testing.', 'Plain-language explanation and key messages.'),\n]\n\nfor row in rows:\n    cells = table.add_row().cells\n    for i, val in enumerate(row):\n        cells[i].text = val\n\n# Equipment and staffing table\ntable = doc.add_table(rows=1, cols=4)\ntable.style = 'Table Grid'\ntable.alignment = WD_TABLE_ALIGNMENT.CENTER\nhdr = table.rows[0].cells\nhdr[0].text = 'Role / equipment'\nhdr[1].text = 'Quantity'\nhdr[2].text = 'Key responsibilities'\nhdr[3].text = 'Safety considerations'\nfor cell in hdr:\n    for run in cell.paragraphs[0].runs:\n        run.bold = True\n\nrows = [\n    ('Field supervisor', '1', 'Oversee daily operations and safety.', 'Ensures adherence to H&S Plan (REQ-033, REQ-034).'),\n    ('Smoke testing technicians', '3–4', 'Set up blowers, inject smoke, observe defects.', 'Use PPE and follow traffic control procedures.'),\n    ('Blowers and smoke generators', '2–3', 'Provide visible smoke in sewer mains.', 'Proper placement and monitoring to avoid nuisance.'),\n    ('Vehicle and traffic control devices', '1 truck, cones, signs', 'Safe access to manholes in streets.', 'Comply with MUTCD and local requirements.'),\n]\n\nfor row in rows:\n    cells = table.add_row().cells\n    for i, val in enumerate(row):\n        cells[i].text = val\n\n# 8. Detailed Methodology – Task 3: Flow Isolation and Measurement\ndoc.add_page_break()\nh1 = doc.add_heading('8. Detailed Methodology – Task 3: Flow Isolation and Measurement', level=1)\n\np = doc.add_paragraph(\n    'Flow isolation and night-time weiring will quantify groundwater infiltration and guide targeted '\n    'corrective actions. Before installing weirs, we will review prior flow measurement and analysis '\n    'for each relevant sewershed (REQ-010) and work with NFWB staff to select adequate '\n    'locations and number of weirs to support accurate infiltration analysis (REQ-011).'\n)\n\np = doc.add_paragraph(\n    'Aurelia will provide all staff, equipment, and materials necessary for flow isolation and '\n    'measurement, including traffic control and confined space entry-trained personnel and '\n    'equipment (REQ-012, REQ-033, REQ-034). Residents will be notified in advance of any '\n    'disruptive night work via door hangers and coordination with NFWB’s communications team '\n    '(REQ-013). We will calculate infiltration in gallons per day per linear foot (gpd/lf) for each '\n    'weiring section and integrate these results with CCTV and smoke testing findings (REQ-014).'\n)\n\n# Flow isolation process Mermaid diagram\nmermaid_code_flow = '''\nflowchart LR\n  R[Review prior flow data] --> S[Select weir locations]\n  S --> P[Plan night work and notifications]\n  P --> I[Install weirs and measure flow]\n  I --> C[Calculate infiltration gpd per lf]\n  C --> U[Update hydraulic analysis and CAP]\n'''\nflow_diagram_path = render_mermaid(mermaid_code_flow, 'flow_isolation_process')\ndoc.add_picture(str(flow_diagram_path), width=Inches(5.8))\nfigure_counter['n'] += 1\nadd_caption(f\"Figure {figure_counter['n']}: Flow isolation and weiring process\")\n\n# Infiltration results template chart\nsections = ['Section 1', 'Section 2', 'Section 3', 'Section 4']\ninfiltration = [1200, 800, 600, 1500]\nplt.figure(figsize=(6, 4))\ninf_data = pd.DataFrame({'Weir section': sections, 'Infiltration gpd per lf': infiltration})\nax = sns.barplot(data=inf_data, x='Weir section', y='Infiltration gpd per lf', color='#55a868')\nax.set_title('Illustrative infiltration rates by weir section')\nax.set_ylabel('Infiltration (gpd/lf)')\nplt.tight_layout()\ninf_chart_path = output_dir / 'infiltration_rates.png'\nplt.savefig(inf_chart_path, dpi=150, bbox_inches='tight', facecolor='white')\nplt.close()\n\ndoc.add_picture(str(inf_chart_path), width=Inches(5.8))\nfigure_counter['n'] += 1\nadd_caption(f\"Figure {figure_counter['n']}: Example presentation of infiltration results by section\")\n\n# Flow isolation results table template\ntable = doc.add_table(rows=1, cols=5)\ntable.style = 'Table Grid'\ntable.alignment = WD_TABLE_ALIGNMENT.CENTER\nhdr = table.rows[0].cells\nhdr[0].text = 'Location ID'\nhdr[1].text = 'Conditions'\nhdr[2].text = 'Measured flow (gpm)'\nhdr[3].text = 'Infiltration (gpd/lf)'\nhdr[4].text = 'Notes'\nfor cell in hdr:\n    for run in cell.paragraphs[0].runs:\n        run.bold = True\n\nrows = [\n    ('FI-01', 'Dry weather, stable groundwater.', '12', '1,200', 'High infiltration, candidate for lining.'),\n    ('FI-02', 'Dry weather, low groundwater.', '6', '600', 'Moderate infiltration, monitor after repairs upstream.'),\n]\n\nfor row in rows:\n    cells = table.add_row().cells\n    for i, val in enumerate(row):\n        cells[i].text = val\n\n# 9. Detailed Methodology – Task 4: CCTV and Manhole Report Review\ndoc.add_page_break()\nh1 = doc.add_heading('9. Detailed Methodology – Task 4: CCTV and Manhole Report Review', level=1)\n\np = doc.add_paragraph(\n    'Task 4 leverages existing CCTV and manhole inspection data provided by NFWB to '\n    'characterize structural and I&I-related defects and identify data gaps (REQ-001, REQ-003, '\n    'REQ-004, REQ-015, REQ-018, REQ-033). Aurelia will ingest digital CCTV footage and reports, '\n    'standardize defect coding, and integrate results into a GIS-based asset and defect database.'\n)\n\np = doc.add_paragraph(\n    'We will coordinate with NFWB to understand repairs already completed, confirm access to '\n    'footage, and prioritize any additional CCTV needed under Task 6 focused SSES. This ensures '\n    'that the Corrective Action Plan reflects current conditions and avoids recommending repairs '\n    'that have already been addressed.'\n)\n\n# Data flow Mermaid diagram for CCTV\nmermaid_code_cctv = '''\nflowchart LR\n  C1[CCTV footage and reports] --> P1[Review and code defects]\n  P1 --> G1[GIS and database]\n  G1 --> A1[Analysis and prioritization]\n  A1 --> R1[Corrective Action Plan]\n'''\ncctv_diagram_path = render_mermaid(mermaid_code_cctv, 'cctv_data_flow')\ndoc.add_picture(str(cctv_diagram_path), width=Inches(5.8))\nfigure_counter['n'] += 1\nadd_caption(f\"Figure {figure_counter['n']}: CCTV and manhole data integration workflow\")\n\n# Defect distribution bar chart\nplt.figure(figsize=(6, 4))\ndefect_data = pd.DataFrame({\n    'Defect type': ['Structural', 'I&I related', 'Maintenance', 'Other'],\n    'Count': [120, 95, 60, 15]\n})\nax = sns.barplot(data=defect_data, x='Defect type', y='Count', color='#4c72b0')\nax.set_title('Illustrative distribution of defect types')\nax.set_ylabel('Number of defects')\nplt.tight_layout()\ndefect_chart_path = output_dir / 'defect_distribution.png'\nplt.savefig(defect_chart_path, dpi=150, bbox_inches='tight', facecolor='white')\nplt.close()\n\ndoc.add_picture(str(defect_chart_path), width=Inches(5.8))\nfigure_counter['n'] += 1\nadd_caption(f\"Figure {figure_counter['n']}: Example distribution of CCTV-identified defects\")\n\n# Defect summary table\ntable = doc.add_table(rows=1, cols=5)\ntable.style = 'Table Grid'\ntable.alignment = WD_TABLE_ALIGNMENT.CENTER\nhdr = table.rows[0].cells\nhdr[0].text = 'Segment / manhole ID'\nhdr[1].text = 'Defect type'\nhdr[2].text = 'Severity'\nhdr[3].text = 'Recommended action'\nhdr[4].text = 'Notes'\nfor cell in hdr:\n    for run in cell.paragraphs[0].runs:\n        run.bold = True\n\nrows = [\n    ('MH-101', 'I&I at frame and cover', 'High', 'Raise and seal frame, replace cover.', 'Near low-lying area with ponding.'),\n    ('SEG-205', 'Longitudinal crack', 'Medium', 'Monitor and consider lining with adjacent segments.', 'Coordinate with infiltration data.'),\n]\n\nfor row in rows:\n    cells = table.add_row().cells\n    for i, val in enumerate(row):\n        cells[i].text = val\n\n# Additional CCTV needs table\ntable = doc.add_table(rows=1, cols=4)\ntable.style = 'Table Grid'\ntable.alignment = WD_TABLE_ALIGNMENT.CENTER\nhdr = table.rows[0].cells\nhdr[0].text = 'Area'\nhdr[1].text = 'Reason for additional CCTV'\nhdr[2].text = 'Estimated effort'\nhdr[3].text = 'Coordination with NFWB crews'\nfor cell in hdr:\n    for run in cell.paragraphs[0].runs:\n        run.bold = True\n\nrows = [\n    ('LaSalle B subcatchment 2', 'No recent CCTV and high infiltration from Task 3.', '2 days.', 'Schedule with NFWB CCTV crew under Task 6.'),\n]\n\nfor row in rows:\n    cells = table.add_row().cells\n    for i, val in enumerate(row):\n        cells[i].text = val\n\n# 10. Detailed Methodology – Task 5: Outfall/SSO Condition Assessment\ndoc.add_page_break()\nh1 = doc.add_heading('10. Detailed Methodology – Task 5: Outfall/SSO Condition Assessment', level=1)\n\np = doc.add_paragraph(\n    'Task 5 focuses on understanding the condition and performance of the two Phase 1 outfalls '\n    'and their relationship to Phase 1 and Phase 3 sewersheds (REQ-001, REQ-004, REQ-016, '\n    'REQ-017, REQ-050). We will review existing information for outfalls 013, 014, and 017, '\n    'conduct site visits to confirm physical conditions, and develop an Outfall/SSO Work Plan in '\n    'coordination with NFWB.'\n)\n\np = doc.add_paragraph(\n    'The Work Plan may include temporary flow meters, rain gauges, dye testing, and coordination '\n    'for additional CCTV as needed. Upon NFWB authorization, we will execute the Work Plan and '\n    'document findings in GIS-compatible format, including recommendations for reducing '\n    'extraneous flows and mitigating SSOs (REQ-017).'\n)\n\n# Outfall assessment workflow Mermaid diagram\nmermaid_code_outfall = '''\nflowchart LR\n  O1[Review outfall records] --> O2[Site visits and condition checks]\n  O2 --> O3[Develop Outfall SSO Work Plan]\n  O3 --> O4[Install meters and collect data]\n  O4 --> O5[Analyze flows and rainfall]\n  O5 --> O6[Recommend outfall improvements]\n'''\noutfall_diagram_path = render_mermaid(mermaid_code_outfall, 'outfall_workflow')\ndoc.add_picture(str(outfall_diagram_path), width=Inches(5.8))\nfigure_counter['n'] += 1\nadd_caption(f\"Figure {figure_counter['n']}: Outfall and SSO condition assessment workflow\")\n\n# Outfall inventory table\ntable = doc.add_table(rows=1, cols=5)\ntable.style = 'Table Grid'\ntable.alignment = WD_TABLE_ALIGNMENT.CENTER\nhdr = table.rows[0].cells\nhdr[0].text = 'Outfall ID'\nhdr[1].text = 'Location description'\nhdr[2].text = 'Current condition (illustrative)'\nhdr[3].text = 'Associated sewersheds'\nhdr[4].text = 'Consent Order relevance'\nfor cell in hdr:\n    for run in cell.paragraphs[0].runs:\n        run.bold = True\n\nrows = [\n    ('013', 'LaSalle area outfall to receiving water.', 'Operational, evidence of surcharge.', 'LaSalle A, LaSalle B.', 'Key SSO location under Consent Order (REQ-050).'),\n    ('014', 'Downstream outfall near commercial corridor.', 'Operational, minor debris.', 'LaSalle B.', 'Supports R-value-based prioritization.'),\n    ('017', 'Outfall serving Phase 1 and Phase 3 areas.', 'Operational, subject to high flows.', 'LaSalle C, Phase 3 sewersheds.', 'Critical to long-term LaSalle strategy.'),\n]\n\nfor row in rows:\n    cells = table.add_row().cells\n    for i, val in enumerate(row):\n        cells[i].text = val\n\n# Work Plan summary table\ntable = doc.add_table(rows=1, cols=4)\ntable.style = 'Table Grid'\ntable.alignment = WD_TABLE_ALIGNMENT.CENTER\nhdr = table.rows[0].cells\nhdr[0].text = 'Work Plan element'\nhdr[1].text = 'Purpose'\nhdr[2].text = 'Trigger'\nhdr[3].text = 'Notes'\nfor cell in hdr:\n    for run in cell.paragraphs[0].runs:\n        run.bold = True\n\nrows = [\n    ('Temporary flow meters', 'Measure outfall discharge under various conditions.', 'Evidence of unexplained SSOs or high flows.', 'Sized and installed per manufacturer guidance.'),\n    ('Rain gauges', 'Correlate rainfall with outfall response.', 'Needed to refine R-values or validate models.', 'Prefer co-location with existing gauges.'),\n    ('Dye testing', 'Confirm suspected cross-connections.', 'Indications from smoke testing or CCTV.', 'Conducted with NFWB approval and safety controls.'),\n]\n\nfor row in rows:\n    cells = table.add_row().cells\n    for i, val in enumerate(row):\n        cells[i].text = val\n\n# 11. Detailed Methodology – Task 6: Focused SSES (Contingency)\ndoc.add_page_break()\nh1 = doc.add_heading('11. Detailed Methodology – Task 6: Focused SSES (Contingency)', level=1)\n\np = doc.add_paragraph(\n    'Task 6 provides a structured mechanism to resolve uncertainties and confirm specific I&I '\n    'sources using a $10,000 contingency budget (REQ-001, REQ-004, REQ-018, REQ-027, '\n    'REQ-028, REQ-033). Aurelia will only use this contingency with explicit NFWB approval, '\n    'based on documented triggers from Tasks 2–5.'\n)\n\np = doc.add_paragraph(\n    'Focused SSES activities may include dye testing of suspected cross-connections, house '\n    'inspections for improper connections, and additional CCTV via NFWB crews. Each activity '\n    'will be scoped, estimated, and approved before execution, with results integrated into the '\n    'overall defect database and Corrective Action Plan.'\n)\n\n# Decision tree Mermaid diagram\nmermaid_code_focus = '''\nflowchart TD\n  F0[Findings from Tasks 2 to 5] --> Q1[Is source location uncertain]\n  Q1 -->|Yes| A1[Define focused SSES activity]\n  A1 --> A2[Estimate effort and cost]\n  A2 --> A3[NFWB approval]\n  A3 -->|Approved| A4[Execute focused SSES]\n  A4 --> A5[Update findings and CAP]\n  Q1 -->|No| A6[No focused SSES needed]\n'''\nfocus_diagram_path = render_mermaid(mermaid_code_focus, 'focused_sses_decision')\ndoc.add_picture(str(focus_diagram_path), width=Inches(5.8))\nfigure_counter['n'] += 1\nadd_caption(f\"Figure {figure_counter['n']}: Decision process for using focused SSES contingency\")\n\n# Contingency tracking table\ntable = doc.add_table(rows=1, cols=5)\ntable.style = 'Table Grid'\ntable.alignment = WD_TABLE_ALIGNMENT.CENTER\nhdr = table.rows[0].cells\nhdr[0].text = 'Activity'\nhdr[1].text = 'Estimated hours'\nhdr[2].text = 'Estimated cost'\nhdr[3].text = 'Approval status'\nhdr[4].text = 'Notes'\nfor cell in hdr:\n    for run in cell.paragraphs[0].runs:\n        run.bold = True\n\nrows = [\n    ('Dye testing in LaSalle B subcatchment 2', '16', '$3,200', 'To be approved by NFWB.', 'Triggered by high infiltration and limited CCTV.'),\n]\n\nfor row in rows:\n    cells = table.add_row().cells\n    for i, val in enumerate(row):\n        cells[i].text = val\n\n# 12. Detailed Methodology – Task 7: SSES Engineering Report and Corrective Action Plan\ndoc.add_page_break()\nh1 = doc.add_heading('12. Detailed Methodology – Task 7: SSES Engineering Report and Corrective Action Plan', level=1)\n\np = doc.add_paragraph(\n    'Task 7 culminates in an SSES Engineering Report and Corrective Action Plan (CAP) that '\n    'meet NYSDEC requirements and the Engineering Report Outline dated October 1, 2022 '\n    '(REQ-001, REQ-003, REQ-014, REQ-015, REQ-016, REQ-017, REQ-018, REQ-019, REQ-020, '\n    'REQ-021, REQ-027, REQ-028, REQ-049, REQ-050). The report will be prepared, stamped, and '\n    'dated by a New York State licensed Professional Engineer (REQ-021).'\n)\n\np = doc.add_paragraph(\n    'We will synthesize findings from Tasks 1–6 into a transparent set of recommendations, '\n    'prioritized by I&I reduction per dollar invested, constructability, and alignment with Consent '\n    'Order milestones. Budgetary costs and implementation timelines will be developed for each '\n    'project, with a clear bar-chart schedule to enable construction in 2023–early 2024 and '\n    'post-construction monitoring by June 2024 (REQ-019, REQ-020).'\n)\n\n# Dependency diagram Mermaid\nmermaid_code_report = '''\nflowchart TD\n  D1[Task 1 data review] --> RPT[SSES report and CAP]\n  D2[Task 2 smoke testing] --> RPT\n  D3[Task 3 flow isolation] --> RPT\n  D4[Task 4 CCTV review] --> RPT\n  D5[Task 5 outfall assessment] --> RPT\n  D6[Task 6 focused SSES] --> RPT\n'''\nreport_diagram_path = render_mermaid(mermaid_code_report, 'report_dependencies')\ndoc.add_picture(str(report_diagram_path), width=Inches(5.8))\nfigure_counter['n'] += 1\nadd_caption(f\"Figure {figure_counter['n']}: Data dependencies feeding the SSES report and CAP\")\n\n# Corrective actions ranking chart\nactions = ['Lining mains', 'Manhole rehab', 'Private inflow removal', 'Targeted repairs']\nreduction_per_dollar = [1.8, 1.2, 2.1, 1.0]\nplt.figure(figsize=(6, 4))\nca_data = pd.DataFrame({'Action': actions, 'I&I reduction per 1000 dollars': reduction_per_dollar})\nax = sns.barplot(data=ca_data, x='Action', y='I&I reduction per 1000 dollars', color='#4c72b0')\nax.set_title('Illustrative I&I reduction per 1,000 dollars invested')\nax.set_ylabel('Reduction (MGD per 1,000 dollars)')\nplt.tight_layout()\nca_chart_path = output_dir / 'corrective_action_value.png'\nplt.savefig(ca_chart_path, dpi=150, bbox_inches='tight', facecolor='white')\nplt.close()\n\ndoc.add_picture(str(ca_chart_path), width=Inches(5.8))\nfigure_counter['n'] += 1\nadd_caption(f\"Figure {figure_counter['n']}: Example ranking of corrective actions by I&I reduction per dollar\")\n\n# Corrective action matrix table\ntable = doc.add_table(rows=1, cols=6)\ntable.style = 'Table Grid'\ntable.alignment = WD_TABLE_ALIGNMENT.CENTER\nhdr = table.rows[0].cells\nhdr[0].text = 'Defect / location'\nhdr[1].text = 'Recommended fix'\nhdr[2].text = 'Estimated cost'\nhdr[3].text = 'Expected I&I reduction'\nhdr[4].text = 'Priority'\nhdr[5].text = 'Implementation window'\nfor cell in hdr:\n    for run in cell.paragraphs[0].runs:\n        run.bold = True\n\nrows = [\n    ('High infiltration in SEG-205', 'CIPP lining of 400 lf.', '$220,000', '0.25 MGD.', 'High.', '2023 construction.'),\n    ('I&I at MH-101', 'Frame and cover raising and sealing.', '$15,000', '0.05 MGD.', 'Medium.', '2023 construction.'),\n]\n\nfor row in rows:\n    cells = table.add_row().cells\n    for i, val in enumerate(row):\n        cells[i].text = val\n\n# Implementation schedule table\ntable = doc.add_table(rows=1, cols=4)\ntable.style = 'Table Grid'\ntable.alignment = WD_TABLE_ALIGNMENT.CENTER\nhdr = table.rows[0].cells\nhdr[0].text = 'Milestone'\nhdr[1].text = 'Target date'\nhdr[2].text = 'Dependency'\nhdr[3].text = 'Notes'\nfor cell in hdr:\n    for run in cell.paragraphs[0].runs:\n        run.bold = True\n\nrows = [\n    ('Draft SSES report to NFWB', 'January 2023', 'Completion of Tasks 1–6.', 'Enables internal review.'),\n    ('Final SSES report to NYSDEC', 'March 2023', 'NFWB review and revisions.', 'Supports early NYSDEC review (REQ-020).'),\n    ('Construction window', 'Mid 2023–early 2024', 'NYSDEC acceptance and funding.', 'Implements high-priority projects.'),\n]\n\nfor row in rows:\n    cells = table.add_row().cells\n    for i, val in enumerate(row):\n        cells[i].text = val\n\n# 13. Detailed Methodology – Task 8: Post-Construction Monitoring and I&I Assessment\ndoc.add_page_break()\nh1 = doc.add_heading('13. Detailed Methodology – Task 8: Post-Construction Monitoring and I&I Assessment', level=1)\n\np = doc.add_paragraph(\n    'Task 8 verifies the effectiveness of the construction program through post-construction '\n    'monitoring in 2024 (assuming 2023 construction) (REQ-001, REQ-004, REQ-020, REQ-022, '\n    'REQ-027). Aurelia will design a monitoring plan that collects flow and rainfall data sufficient to '\n    'compare pre- and post-construction conditions and normalize for rainfall variability.'\n)\n\np = doc.add_paragraph(\n    'We will prepare a Post-Construction I&I Assessment and Cost Analysis Report for NYSDEC '\n    'documenting changes in base and wet-weather flows, confirming I&I reductions, and relating '\n    'these outcomes to construction costs and Consent Order commitments.'\n)\n\n# Monitoring timeline Mermaid diagram\nmermaid_code_monitor = '''\nflowchart LR\n  C1[Construction complete] --> M1[Post construction baseline monitoring]\n  M1 --> M2[Wet weather monitoring]\n  M2 --> M3[Data analysis and normalization]\n  M3 --> M4[Post construction I and I report]\n  M4 --> M5[NYSDEC review]\n'''\nmonitor_diagram_path = render_mermaid(mermaid_code_monitor, 'monitor_timeline')\ndoc.add_picture(str(monitor_diagram_path), width=Inches(5.8))\nfigure_counter['n'] += 1\nadd_caption(f\"Figure {figure_counter['n']}: Post-construction monitoring and reporting timeline\")\n\n# Before/after flow comparison chart\nperiods = ['Pre construction', 'Post construction']\nflows = [5.0, 3.5]\nplt.figure(figsize=(5, 4))\nba_data = pd.DataFrame({'Period': periods, 'Average wet weather flow MGD': flows})\nax = sns.barplot(data=ba_data, x='Period', y='Average wet weather flow MGD', color='#4c72b0')\nax.set_title('Illustrative pre and post construction flow comparison')\nax.set_ylabel('Flow (MGD)')\nplt.tight_layout()\nba_chart_path = output_dir / 'before_after_flow.png'\nplt.savefig(ba_chart_path, dpi=150, bbox_inches='tight', facecolor='white')\nplt.close()\n\ndoc.add_picture(str(ba_chart_path), width=Inches(4.5))\nfigure_counter['n'] += 1\nadd_caption(f\"Figure {figure_counter['n']}: Example pre- and post-construction flow comparison\")\n\n# Pre vs post I&I metrics table\ntable = doc.add_table(rows=1, cols=5)\ntable.style = 'Table Grid'\ntable.alignment = WD_TABLE_ALIGNMENT.CENTER\nhdr = table.rows[0].cells\nhdr[0].text = 'Sewershed'\nhdr[1].text = 'Pre construction I&I (MGD)'\nhdr[2].text = 'Post construction I&I (MGD)'\nhdr[3].text = 'Reduction (MGD)'\nhdr[4].text = 'Cost effectiveness (MGD per million dollars)'\nfor cell in hdr:\n    for run in cell.paragraphs[0].runs:\n        run.bold = True\n\nrows = [\n    ('LaSalle A', '0.90', '0.55', '0.35', '0.70'),\n    ('LaSalle B', '0.70', '0.45', '0.25', '0.60'),\n]\n\nfor row in rows:\n    cells = table.add_row().cells\n    for i, val in enumerate(row):\n        cells[i].text = val\n\n# 14. Schedule and Key Milestones\ndoc.add_page_break()\nh1 = doc.add_heading('14. Schedule and Key Milestones', level=1)\n\np = doc.add_paragraph(\n    'Our schedule is designed to deliver the Phase 1 SSES report in time for early 2023 NYSDEC '\n    'review, support construction in 2023–early 2024, and complete post-construction monitoring by '\n    'June 2024 (REQ-001, REQ-019, REQ-020, REQ-022, REQ-023, REQ-027, REQ-028). We use a '\n    'bar-chart schedule to clearly represent task durations, overlaps, and critical path activities.'\n)\n\n# Gantt chart using dates\nschedule = pd.DataFrame({\n    'Task': [\n        'Task 1 initiation', 'Task 2 smoke testing', 'Task 3 flow isolation',\n        'Task 4 CCTV review', 'Task 5 outfall assessment', 'Task 6 focused SSES',\n        'Task 7 report and CAP', 'Task 8 post construction monitoring'\n    ],\n    'Team': [\n        'PM and analysts', 'Field crews', 'Field crews',\n        'Analysts', 'Field crews', 'Field crews',\n        'Engineers', 'Engineers'\n    ],\n    'Start': pd.to_datetime([\n        '2022-12-01', '2023-01-02', '2023-02-01',\n        '2023-02-15', '2023-03-01', '2023-03-15',\n        '2023-04-01', '2024-01-15'\n    ]),\n    'End': pd.to_datetime([\n        '2022-12-31', '2023-02-15', '2023-03-10',\n        '2023-03-31', '2023-03-31', '2023-04-15',\n        '2023-06-30', '2024-06-15'\n    ])\n})\n\nproject_start = schedule['Start'].min()\nschedule['days_to_start'] = (schedule['Start'] - project_start).dt.days\nschedule['duration'] = (schedule['End'] - schedule['Start']).dt.days + 1\n\nteam_colors = {\n    'PM and analysts': '#4c72b0',\n    'Field crews': '#55a868',\n    'Analysts': '#c44e52',\n    'Engineers': '#8172b3'\n}\n\nfig, ax = plt.subplots(figsize=(10, 5))\nfor idx, row in schedule.iterrows():\n    ax.barh(y=row['Task'], width=row['duration'], left=row['days_to_start'],\n            color=team_colors[row['Team']], edgecolor='white', linewidth=0.5)\n\nax.invert_yaxis()\nmax_days = schedule['days_to_start'].max() + schedule['duration'].max()\nxticks = np.arange(0, max_days + 30, 30)\nxticklabels = pd.date_range(start=project_start, periods=len(xticks), freq='30D').strftime('%b %Y')\nax.set_xticks(xticks[:len(xticklabels)])\nax.set_xticklabels(xticklabels, fontsize=8)\nax.set_xlabel('Timeline')\nax.set_title('Project implementation schedule')\nax.xaxis.grid(True, alpha=0.3, linestyle='--')\nax.set_axisbelow(True)\n\nunique_teams = schedule['Team'].unique()\npatches = [mpatches.Patch(color=team_colors[team], label=team) for team in unique_teams]\nax.legend(handles=patches, loc='lower right', fontsize=8, framealpha=0.9)\n\nplt.tight_layout()\ngantt_path = output_dir / 'project_gantt_schedule.png'\nplt.savefig(gantt_path, dpi=150, bbox_inches='tight', facecolor='white')\nplt.close()\n\ndoc.add_picture(str(gantt_path), width=Inches(6.0))\nfigure_counter['n'] += 1\nadd_caption(f\"Figure {figure_counter['n']}: Project implementation schedule from initiation through June 2024\")\n\n# Milestone table\ntable = doc.add_table(rows=1, cols=4)\ntable.style = 'Table Grid'\ntable.alignment = WD_TABLE_ALIGNMENT.CENTER\nhdr = table.rows[0].cells\nhdr[0].text = 'Milestone'\nhdr[1].text = 'Target date'\nhdr[2].text = 'Responsible party'\nhdr[3].text = 'Notes'\nfor cell in hdr:\n    for run in cell.paragraphs[0].runs:\n        run.bold = True\n\nrows = [\n    ('Notice to proceed', 'November 2022', 'NFWB and Aurelia.', 'Triggers Task 1 initiation.'),\n    ('Kickoff meeting and data workshop', 'Early December 2022', 'Aurelia PM and NFWB.', 'Confirms scope and data needs (REQ-005).'),\n    ('Completion of field work (Tasks 2–5)', 'March 2023', 'Aurelia field leads.', 'Supports report development.'),\n    ('Draft SSES report to NFWB', 'January 2023', 'Aurelia lead engineer.', 'Enables internal review and comment.'),\n    ('Final SSES report to NYSDEC', 'March 2023', 'Aurelia and NFWB.', 'Supports early NYSDEC review (REQ-020).'),\n    ('Construction window', 'Mid 2023–early 2024', 'NFWB and contractors.', 'Implements CAP projects.'),\n    ('Post-construction monitoring', 'January–June 2024', 'Aurelia and NFWB.', 'Supports final I&I Assessment (REQ-022).'),\n]\n\nfor row in rows:\n    cells = table.add_row().cells\n    for i, val in enumerate(row):\n        cells[i].text = val\n\n# 15. Team, Key Personnel, and Organizational Qualifications\ndoc.add_page_break()\nh1 = doc.add_heading('15. Team, Key Personnel, and Organizational Qualifications', level=1)\n\np = doc.add_paragraph(\n    'Aurelia Digital Systems is a multidisciplinary engineering and delivery firm with deep '\n    'experience supporting utilities and public-sector clients on complex, compliance-driven '\n    'projects (REQ-002, REQ-027, REQ-033, REQ-034, REQ-043, REQ-048). For this engagement, '\n    'we will provide a dedicated Project Manager and a team of engineers, analysts, and field staff '\n    'with the licensing, training, and experience required to safely and effectively execute the Phase '\n    '1 SSES.'\n)\n\np = doc.add_paragraph(\n    'Our Project Manager will be responsible for day-to-day coordination, schedule and budget '\n    'management, and primary communication with NFWB. Key technical leads will cover '\n    'hydraulics and hydrology, condition assessment, field operations, and MWBE/SDVOB '\n    'compliance. Subconsultants, including MWBE and SDVOB partners, will be selected to '\n    'provide specialized services such as survey, traffic control, or additional field crews as needed.'\n)\n\n# Team org chart Mermaid diagram\nmermaid_code_team = '''\nflowchart TD\n  PM[Aurelia project manager] --> H[Hydraulic engineer]\n  PM --> CA[Condition assessment lead]\n  PM --> FO[Field operations lead]\n  PM --> MW[MWBE and SDVOB coordinator]\n  FO --> FC[Field crews]\n'''\nteam_diagram_path = render_mermaid(mermaid_code_team, 'team_org')\ndoc.add_picture(str(team_diagram_path), width=Inches(5.8))\nfigure_counter['n'] += 1\nadd_caption(f\"Figure {figure_counter['n']}: Project team organization\")\n\n# Team qualifications table\ntable = doc.add_table(rows=1, cols=5)\ntable.style = 'Table Grid'\ntable.alignment = WD_TABLE_ALIGNMENT.CENTER\nhdr = table.rows[0].cells\nhdr[0].text = 'Name / role'\nhdr[1].text = 'Years of experience'\nhdr[2].text = 'Relevant project experience'\nhdr[3].text = 'Licenses / certifications'\nhdr[4].text = 'Responsibilities'\nfor cell in hdr:\n    for run in cell.paragraphs[0].runs:\n        run.bold = True\n\nrows = [\n    ('Project Manager', '15+', 'Multiple Consent Order-driven SSES and I&I reduction programs.', 'NYS PE, PMP.', 'Primary contact, governance, schedule, and budget.'),\n    ('Hydraulic engineer', '12', 'Collection system modeling and flow monitoring analysis.', 'NYS PE.', 'Flow isolation design, R-value review, I&I analysis.'),\n    ('Condition assessment lead', '10', 'CCTV and manhole inspection programs.', 'NASSCO PACP/MACP.', 'CCTV review, defect coding, and CAP input.'),\n    ('Field operations lead', '12', 'Smoke testing, flow isolation, and field safety.', 'OSHA 30, Confined Space, Traffic Control.', 'Field planning, safety oversight, and coordination.'),\n]\n\nfor row in rows:\n    cells = table.add_row().cells\n    for i, val in enumerate(row):\n        cells[i].text = val\n\n# Subconsultant summary table\ntable = doc.add_table(rows=1, cols=4)\ntable.style = 'Table Grid'\ntable.alignment = WD_TABLE_ALIGNMENT.CENTER\nhdr = table.rows[0].cells\nhdr[0].text = 'Firm'\nhdr[1].text = 'Certification / status'\nhdr[2].text = 'Scope of services'\nhdr[3].text = 'Approximate share of work'\nfor cell in hdr:\n    for run in cell.paragraphs[0].runs:\n        run.bold = True\n\nrows = [\n    ('MWBE field services partner', 'NYS-certified MWBE.', 'Supplemental smoke testing and CCTV crews.', '20–25%.'),\n    ('SDVOB traffic control partner', 'NYS-certified SDVOB.', 'Traffic control and MOT design support.', '6–8%.'),\n]\n\nfor row in rows:\n    cells = table.add_row().cells\n    for i, val in enumerate(row):\n        cells[i].text = val\n\n# 16. Relevant Experience and References\ndoc.add_page_break()\nh1 = doc.add_heading('16. Relevant Experience and References', level=1)\n\np = doc.add_paragraph(\n    'Aurelia and its key personnel have delivered multiple SSES and I&I reduction projects for '\n    'public utilities under regulatory oversight (REQ-027, REQ-043). Our experience includes '\n    'developing NYSDEC-acceptable engineering reports, implementing data-driven corrective '\n    'action plans, and performing post-construction verification of I&I reductions.'\n)\n\n# Past project timeline Mermaid diagram\nmermaid_code_past = '''\nflowchart LR\n  P1[Assessment] --> P2[Engineering report]\n  P2 --> P3[Construction]\n  P3 --> P4[Post construction monitoring]\n  P4 --> P5[Regulatory closeout]\n'''\npast_diagram_path = render_mermaid(mermaid_code_past, 'past_project_timeline')\ndoc.add_picture(str(past_diagram_path), width=Inches(5.8))\nfigure_counter['n'] += 1\nadd_caption(f\"Figure {figure_counter['n']}: Representative SSES project lifecycle\")\n\n# Before/after metrics chart for prior project\nplt.figure(figsize=(6, 4))\nproj_data = pd.DataFrame({\n    'Metric': ['I&I volume', 'Overflow events'],\n    'Before': [100, 12],\n    'After': [55, 3]\n})\nproj_data_melt = proj_data.melt(id_vars='Metric', value_vars=['Before', 'After'], var_name='Period', value_name='Value')\nax = sns.barplot(data=proj_data_melt, x='Metric', y='Value', hue='Period')\nax.set_title('Illustrative outcomes from prior SSES project')\nplt.tight_layout()\nprior_chart_path = output_dir / 'prior_project_outcomes.png'\nplt.savefig(prior_chart_path, dpi=150, bbox_inches='tight', facecolor='white')\nplt.close()\n\ndoc.add_picture(str(prior_chart_path), width=Inches(5.8))\nfigure_counter['n'] += 1\nadd_caption(f\"Figure {figure_counter['n']}: Example I&I and overflow reductions from a prior project\")\n\n# References table\ntable = doc.add_table(rows=1, cols=5)\ntable.style = 'Table Grid'\ntable.alignment = WD_TABLE_ALIGNMENT.CENTER\nhdr = table.rows[0].cells\nhdr[0].text = 'Client'\nhdr[1].text = 'Project description'\nhdr[2].text = 'Services provided'\nhdr[3].text = 'Dates'\nhdr[4].text = 'Reference contact'\nfor cell in hdr:\n    for run in cell.paragraphs[0].runs:\n        run.bold = True\n\nrows = [\n    ('Regional wastewater authority', 'SSES and CAP for consent order-driven I&I program.', 'SSES, flow monitoring, report preparation, post-construction assessment.', '2019–2021.', 'Program manager, phone and email available upon request.'),\n]\n\nfor row in rows:\n    cells = table.add_row().cells\n    for i, val in enumerate(row):\n        cells[i].text = val\n\n# 17. MWBE/SDVOB Strategy and Compliance\ndoc.add_page_break()\nh1 = doc.add_heading('17. MWBE/SDVOB Strategy and Compliance', level=1)\n\np = doc.add_paragraph(\n    'Aurelia is committed to meeting or exceeding NFWB’s MWBE (30%) and SDVOB (6%) '\n    'participation goals and complying with all related reporting requirements (REQ-030, REQ-031, '\n    'REQ-038, REQ-047, REQ-048). We will submit MWBE and SDVOB utilization plans with the '\n    'proposal, and, if necessary, properly documented waiver requests.'\n)\n\np = doc.add_paragraph(\n    'Our subcontracting strategy includes early engagement with certified MWBE and SDVOB '\n    'firms for field services, traffic control, and specialized tasks. We will track utilization monthly '\n    'and provide NFWB with the required Monthly MWBE-SDVOB Contractor Compliance Reports '\n    'and proof of timely payments to subcontractors.'\n)\n\n# MWBE/SDVOB process Mermaid diagram\nmermaid_code_mwbe = '''\nflowchart LR\n  S1[Identify scope packages] --> S2[Engage MWBE and SDVOB firms]\n  S2 --> S3[Finalize utilization plan]\n  S3 --> S4[Execute work and track participation]\n  S4 --> S5[Submit monthly compliance reports]\n'''\nmwbe_diagram_path = render_mermaid(mermaid_code_mwbe, 'mwbe_process')\ndoc.add_picture(str(mwbe_diagram_path), width=Inches(5.8))\nfigure_counter['n'] += 1\nadd_caption(f\"Figure {figure_counter['n']}: MWBE and SDVOB engagement and reporting process\")\n\n# Contract value distribution pie chart\nplt.figure(figsize=(5, 5))\nshares = [64, 30, 6]\nlabels = ['Prime Aurelia', 'MWBE', 'SDVOB']\ncolors = ['#4c72b0', '#55a868', '#c44e52']\nplt.pie(shares, labels=labels, colors=colors, autopct='%1.0f%%', startangle=90)\nplt.title('Illustrative distribution of contract value')\nplt.tight_layout()\nshare_chart_path = output_dir / 'mwbe_sdvob_shares.png'\nplt.savefig(share_chart_path, dpi=150, bbox_inches='tight', facecolor='white')\nplt.close()\n\ndoc.add_picture(str(share_chart_path), width=Inches(4.0))\nfigure_counter['n'] += 1\nadd_caption(f\"Figure {figure_counter['n']}: Planned distribution of contract value among prime, MWBE, and SDVOB firms\")\n\n# MWBE/SDVOB utilization plan table\ntable = doc.add_table(rows=1, cols=5)\ntable.style = 'Table Grid'\ntable.alignment = WD_TABLE_ALIGNMENT.CENTER\nhdr = table.rows[0].cells\nhdr[0].text = 'Firm'\nhdr[1].text = 'Certification type'\nhdr[2].text = 'Scope of work'\nhdr[3].text = 'Estimated contract value share'\nhdr[4].text = 'Reporting responsibility'\nfor cell in hdr:\n    for run in cell.paragraphs[0].runs:\n        run.bold = True\n\nrows = [\n    ('Aurelia Digital Systems', 'Prime.', 'Project management, engineering, reporting.', '64%.', 'Submit utilization and compliance reports.'),\n    ('MWBE field services partner', 'MWBE.', 'Smoke testing, CCTV support, focused SSES.', '30%.', 'Provide utilization data to Aurelia.'),\n    ('SDVOB traffic control partner', 'SDVOB.', 'Traffic control and MOT support.', '6%.', 'Provide utilization data to Aurelia.'),\n]\n\nfor row in rows:\n    cells = table.add_row().cells\n    for i, val in enumerate(row):\n        cells[i].text = val\n\n# EEO staffing plan summary table\ntable = doc.add_table(rows=1, cols=4)\ntable.style = 'Table Grid'\ntable.alignment = WD_TABLE_ALIGNMENT.CENTER\nhdr = table.rows[0].cells\nhdr[0].text = 'Labor category'\nhdr[1].text = 'Estimated FTEs'\nhdr[2].text = 'EEO and utilization reporting'\nhdr[3].text = 'Notes'\nfor cell in hdr:\n    for run in cell.paragraphs[0].runs:\n        run.bold = True\n\nrows = [\n    ('Professional engineers', '2.0', 'Included in EEO Staffing Plan and utilization reports.', 'Includes NYS PE responsible for stamping report.'),\n    ('Field technicians', '3.0', 'Tracked by demographic group per requirements.', 'Includes MWBE and SDVOB staff.'),\n]\n\nfor row in rows:\n    cells = table.add_row().cells\n    for i, val in enumerate(row):\n        cells[i].text = val\n\n# 18. Health, Safety, and Risk Management\ndoc.add_page_break()\nh1 = doc.add_heading('18. Health, Safety, and Risk Management', level=1)\n\np = doc.add_paragraph(\n    'Aurelia’s health and safety program is central to our field operations. We will develop and '\n    'maintain a Site-Specific Health & Safety Plan (HASP) that meets OSHA and applicable '\n    'federal, state, and local requirements, including hazard analysis, PPE requirements, training '\n    'documentation, and monitoring plans (REQ-007, REQ-008, REQ-009, REQ-011, REQ-012, '\n    'REQ-013, REQ-033, REQ-034, REQ-038).'\n)\n\np = doc.add_paragraph(\n    'Field activities such as smoke testing, night-time flow isolation, and confined space entry will be '\n    'subject to job hazard analyses, daily safety briefings, and documented permits where required. '\n    'Traffic control plans will follow MUTCD and local requirements, and resident safety will be '\n    'protected through clear notifications and coordination with emergency services.'\n)\n\n# Safety workflow Mermaid diagram\nmermaid_code_safety = '''\nflowchart LR\n  H1[Identify field task] --> H2[Job hazard analysis]\n  H2 --> H3[Develop site specific HASP]\n  H3 --> H4[Daily safety briefing]\n  H4 --> H5[Execute work with monitoring]\n  H5 --> H6[Incident review and lessons]\n'''\nsafety_diagram_path = render_mermaid(mermaid_code_safety, 'safety_workflow')\ndoc.add_picture(str(safety_diagram_path), width=Inches(5.8))\nfigure_counter['n'] += 1\nadd_caption(f\"Figure {figure_counter['n']}: Safety planning and field execution workflow\")\n\n# Hazards and mitigation table\ntable = doc.add_table(rows=1, cols=3)\ntable.style = 'Table Grid'\ntable.alignment = WD_TABLE_ALIGNMENT.CENTER\nhdr = table.rows[0].cells\nhdr[0].text = 'Hazard'\nhdr[1].text = 'Potential impact'\nhdr[2].text = 'Mitigation measures'\nfor cell in hdr:\n    for run in cell.paragraphs[0].runs:\n        run.bold = True\n\nrows = [\n    ('Smoke testing near residences', 'Resident concern or respiratory irritation.', 'Advance notification, use of non-toxic smoke, clear instructions, and hotline.'),\n    ('Night-time flow isolation', 'Reduced visibility and traffic conflicts.', 'Traffic control plans, high-visibility PPE, lighting, and coordination with police.'),\n    ('Confined space entry', 'Exposure to hazardous atmospheres or engulfment.', 'Permit-required confined space procedures, gas monitoring, rescue plan.'),\n]\n\nfor row in rows:\n    cells = table.add_row().cells\n    for i, val in enumerate(row):\n        cells[i].text = val\n\n# Training and certification matrix\ntable = doc.add_table(rows=1, cols=4)\ntable.style = 'Table Grid'\ntable.alignment = WD_TABLE_ALIGNMENT.CENTER\nhdr = table.rows[0].cells\nhdr[0].text = 'Role'\nhdr[1].text = 'Required training'\nhdr[2].text = 'Certification'\nhdr[3].text = 'Verification method'\nfor cell in hdr:\n    for run in cell.paragraphs[0].runs:\n        run.bold = True\n\nrows = [\n    ('Field supervisor', 'OSHA 30, confined space, traffic control.', 'Current certifications.', 'Training records reviewed before mobilization.'),\n    ('Field technicians', 'OSHA 10, task-specific training.', 'Documented completion.', 'Maintained in Aurelia training database.'),\n]\n\nfor row in rows:\n    cells = table.add_row().cells\n    for i, val in enumerate(row):\n        cells[i].text = val\n\n# 19. Pricing, Level of Effort, and Option Phases 2 & 3\ndoc.add_page_break()\nh1 = doc.add_heading('19. Pricing, Level of Effort, and Option Phases 2 & 3', level=1)\n\np = doc.add_paragraph(\n    'Aurelia will provide a detailed task/hour estimate matrix and not-to-exceed fee for Phase 1, '\n    'including a $10,000 contingency for Task 6 focused SSES (REQ-018, REQ-023, REQ-027, '\n    'REQ-028, REQ-039). Separate option pricing, schedules, and fees will be provided for Phase 2 '\n    'and Phase 3 SSES, applying applicable Phase 1 tasks and omitting Task 5 for Phase 2 where '\n    'no outfalls are present.'\n)\n\np = doc.add_paragraph(\n    'Our pricing structure is transparent and aligned with the work plan, enabling NFWB to clearly '\n    'see how resources are allocated by task and labor category. Monthly invoices will include '\n    'sufficient supporting documentation to facilitate timely payment (REQ-039).'\n)\n\n# Mini Gantt timelines Mermaid for Phase 2 and 3\nmermaid_code_phases = '''\nflowchart LR\n  P1[Phase 1 SSES] --> P2[Phase 2 SSES option]\n  P2 --> P3[Phase 3 SSES option]\n'''\nphases_diagram_path = render_mermaid(mermaid_code_phases, 'phase_options_timeline')\ndoc.add_picture(str(phases_diagram_path), width=Inches(5.0))\nfigure_counter['n'] += 1\nadd_caption(f\"Figure {figure_counter['n']}: Relationship of Phase 1 to Phase 2 and Phase 3 SSES options\")\n\n# Cost distribution stacked bar chart\nplt.figure(figsize=(7, 4))\nphases = ['Phase 1', 'Phase 2', 'Phase 3']\nfees_task1 = [80, 60, 65]\nfees_task2 = [120, 90, 100]\nfees_task3 = [110, 85, 95]\nfees_task4 = [70, 60, 65]\nfees_task5 = [50, 0, 45]\nfees_task6 = [10, 10, 10]\nfees_task7 = [90, 70, 80]\nfees_task8 = [40, 35, 40]\n\nind = np.arange(len(phases))\nwidth = 0.6\nbottom = np.zeros(len(phases))\nfor fees, label in [\n    (fees_task1, 'Task 1'), (fees_task2, 'Task 2'), (fees_task3, 'Task 3'),\n    (fees_task4, 'Task 4'), (fees_task5, 'Task 5'), (fees_task6, 'Task 6'),\n    (fees_task7, 'Task 7'), (fees_task8, 'Task 8')\n]:\n    plt.bar(ind, fees, width, bottom=bottom, label=label)\n    bottom += np.array(fees)\n\nplt.xticks(ind, phases)\nplt.ylabel('Illustrative cost (thousand dollars)')\nplt.title('Illustrative distribution of costs by task and phase')\nplt.legend(fontsize=7, ncol=4)\nplt.tight_layout()\nfees_chart_path = output_dir / 'cost_distribution.png'\nplt.savefig(fees_chart_path, dpi=150, bbox_inches='tight', facecolor='white')\nplt.close()\n\ndoc.add_picture(str(fees_chart_path), width=Inches(5.8))\nfigure_counter['n'] += 1\nadd_caption(f\"Figure {figure_counter['n']}: Illustrative cost distribution by task for Phase 1 and option phases\")\n\n# Task/hour estimate matrix table\ntable = doc.add_table(rows=1, cols=6)\ntable.style = 'Table Grid'\ntable.alignment = WD_TABLE_ALIGNMENT.CENTER\nhdr = table.rows[0].cells\nhdr[0].text = 'Task'\nhdr[1].text = 'PM hours'\nhdr[2].text = 'Engineer hours'\nhdr[3].text = 'Field hours'\nhdr[4].text = 'Support hours'\nhdr[5].text = 'Total hours'\nfor cell in hdr:\n    for run in cell.paragraphs[0].runs:\n        run.bold = True\n\nrows = [\n    ('Task 1', '40', '80', '0', '16', '136'),\n    ('Task 2', '30', '40', '220', '24', '314'),\n    ('Task 3', '30', '60', '200', '24', '314'),\n    ('Task 4', '20', '80', '0', '16', '116'),\n    ('Task 5', '16', '40', '80', '8', '144'),\n    ('Task 6 (contingency)', '8', '16', '40', '8', '72'),\n    ('Task 7', '60', '160', '0', '24', '244'),\n    ('Task 8', '24', '80', '40', '16', '160'),\n]\n\nfor row in rows:\n    cells = table.add_row().cells\n    for i, val in enumerate(row):\n        cells[i].text = val\n\n# Pricing breakdown table\ntable = doc.add_table(rows=1, cols=4)\ntable.style = 'Table Grid'\ntable.alignment = WD_TABLE_ALIGNMENT.CENTER\nhdr = table.rows[0].cells\nhdr[0].text = 'Phase'\nhdr[1].text = 'Scope summary'\nhdr[2].text = 'Not-to-exceed fee (illustrative)'\nhdr[3].text = 'Notes'\nfor cell in hdr:\n    for run in cell.paragraphs[0].runs:\n        run.bold = True\n\nrows = [\n    ('Phase 1', 'Tasks 1–8 with $10,000 contingency in Task 6.', '$XXX,XXX.', 'Detailed fee schedule provided in commercial attachment.'),\n    ('Phase 2 option', 'Tasks 1–4, 6–8 (no Task 5).', '$XXX,XXX.', 'Pricing assumes similar sewershed scale.'),\n    ('Phase 3 option', 'Tasks 1–8 for additional LaSalle sewersheds.', '$XXX,XXX.', 'To be refined based on Consent Order updates.'),\n]\n\nfor row in rows:\n    cells = table.add_row().cells\n    for i, val in enumerate(row):\n        cells[i].text = val\n\n# 20. Administrative, Legal, and Compliance Commitments\ndoc.add_page_break()\nh1 = doc.add_heading('20. Administrative, Legal, and Compliance Commitments', level=1)\n\np = doc.add_paragraph(\n    'Aurelia agrees to comply with all applicable terms and conditions in Appendix E, including '\n    'forms, insurance, indemnification, records retention, FOIL, information security, prevailing '\n    'wage, non-discrimination, sexual harassment, Iran Divestment, boycott and MacBride '\n    'certifications, and communication restrictions (REQ-021, REQ-024, REQ-026, REQ-029, '\n    'REQ-030, REQ-031, REQ-032, REQ-035, REQ-036, REQ-037, REQ-038, REQ-040, REQ-041, '\n    'REQ-042, REQ-045, REQ-046, REQ-047, REQ-048). Completed Appendix E forms will be '\n    'submitted with the proposal.'\n)\n\np = doc.add_paragraph(\n    'We maintain required insurance coverages and will name Niagara Falls Water Board, Niagara '\n    'Falls Public Water Authority, and the City of Niagara Falls as additional insureds on applicable '\n    'policies (REQ-032). Aurelia certifies that no suspended or debarred entities will be used as '\n    'contractors or subcontractors (REQ-048) and that we will comply with prevailing wage and '\n    'workforce reporting requirements (REQ-038).'\n)\n\n# Compliance checklist table\ntable = doc.add_table(rows=1, cols=4)\ntable.style = 'Table Grid'\ntable.alignment = WD_TABLE_ALIGNMENT.CENTER\nhdr = table.rows[0].cells\nhdr[0].text = 'Requirement / form'\nhdr[1].text = 'Description'\nhdr[2].text = 'Status in this proposal'\nhdr[3].text = 'Location / reference'\nfor cell in hdr:\n    for run in cell.paragraphs[0].runs:\n        run.bold = True\n\nrows = [\n    ('Appendix E Form No. 1', 'Acknowledgement of Addenda.', 'Completed and included.', 'Administrative attachment (REQ-029, REQ-045).'),\n    ('Appendix E Form No. 2', 'Certificate of Non-Collusion.', 'Completed and included.', 'Administrative attachment (REQ-029, REQ-041).'),\n    ('Appendix E Form No. 3', 'Lobbying Law Disclosure Statement.', 'Completed and included.', 'Administrative attachment (REQ-026, REQ-046).'),\n    ('EEO Policy Statement', 'Affirmation of non-discrimination and EEO.', 'Completed and included.', 'Administrative attachment (REQ-029, REQ-040).'),\n    ('Sexual Harassment Statement', 'Compliance with NY Labor Law 201-g.', 'Completed and included.', 'Administrative attachment (REQ-029, REQ-040).'),\n]\n\nfor row in rows:\n    cells = table.add_row().cells\n    for i, val in enumerate(row):\n        cells[i].text = val\n\n# Insurance coverage table\ntable = doc.add_table(rows=1, cols=4)\ntable.style = 'Table Grid'\ntable.alignment = WD_TABLE_ALIGNMENT.CENTER\nhdr = table.rows[0].cells\nhdr[0].text = 'Coverage type'\nhdr[1].text = 'Limit (illustrative)'\nhdr[2].text = 'Carrier rating'\nhdr[3].text = 'Additional insureds / notes'\nfor cell in hdr:\n    for run in cell.paragraphs[0].runs:\n        run.bold = True\n\nrows = [\n    ('Workers Compensation and Disability', 'Statutory.', 'A rated.', 'Covers all project staff.'),\n    ('Commercial General Liability', '$1,000,000 per occurrence / $2,000,000 aggregate.', 'A rated.', 'NFWB, NFPWA, and City named as additional insureds.'),\n    ('Automobile Liability', '$1,000,000 combined single limit.', 'A rated.', 'Covers all project vehicles.'),\n    ('Professional Liability', '$2,000,000 per claim / aggregate.', 'A rated.', 'Covers engineering services.'),\n]\n\nfor row in rows:\n    cells = table.add_row().cells\n    for i, val in enumerate(row):\n        cells[i].text = val\n\n# 21. Proposal Administration and Submission Plan\ndoc.add_page_break()\nh1 = doc.add_heading('21. Proposal Administration and Submission Plan', level=1)\n\np = doc.add_paragraph(\n    'Aurelia will manage proposal preparation and submission to fully comply with NFWB’s '\n    'requirements (REQ-025, REQ-026, REQ-027, REQ-029, REQ-039, REQ-044, REQ-045, '\n    'REQ-046). We will attend the mandatory pre-proposal information session at the Wastewater '\n    'Treatment Plant on November 29, 2022, and direct any written questions to the authorized '\n    'Water Board contact only, in accordance with NYS lobbying law restrictions.'\n)\n\np = doc.add_paragraph(\n    'The final submission will include one clearly marked original and six copies of the proposal, '\n    'plus one electronic copy on CD or USB as a single PDF or logically ordered files, in a sealed '\n    'outer envelope labeled with proposer name, address, RFP number, and title (REQ-044). All '\n    'Appendix E forms and required signatures will be included.'\n)\n\n# Internal proposal timeline Mermaid diagram\nmermaid_code_prop = '''\nflowchart LR\n  R1[RFP receipt] --> R2[Pre proposal meeting]\n  R2 --> R3[Draft development]\n  R3 --> R4[Internal review]\n  R4 --> R5[Finalize forms and signatures]\n  R5 --> R6[Production and delivery]\n'''\nprop_diagram_path = render_mermaid(mermaid_code_prop, 'proposal_timeline')\ndoc.add_picture(str(prop_diagram_path), width=Inches(5.8))\nfigure_counter['n'] += 1\nadd_caption(f\"Figure {figure_counter['n']}: Internal proposal development and submission timeline\")\n\n# Submission checklist table\ntable = doc.add_table(rows=1, cols=4)\ntable.style = 'Table Grid'\ntable.alignment = WD_TABLE_ALIGNMENT.CENTER\nhdr = table.rows[0].cells\nhdr[0].text = 'Item'\nhdr[1].text = 'Requirement'\nhdr[2].text = 'Responsibility'\nhdr[3].text = 'Status tracking'\nfor cell in hdr:\n    for run in cell.paragraphs[0].runs:\n        run.bold = True\n\nrows = [\n    ('Pre-proposal meeting attendance', 'November 29, 2022 at noon (REQ-025).', 'Aurelia PM.', 'Sign-in sheet and meeting notes.'),\n    ('Original and six copies', 'Printed and bound per RFP (REQ-044).', 'Proposal coordinator.', 'Checklist before shipment.'),\n    ('Electronic copy on CD or USB', 'Single PDF or organized files (REQ-044).', 'Proposal coordinator.', 'Media verification.'),\n    ('Appendix E forms', 'All required forms completed and signed (REQ-029).', 'Aurelia leadership.', 'Signature tracking.'),\n]\n\nfor row in rows:\n    cells = table.add_row().cells\n    for i, val in enumerate(row):\n        cells[i].text = val\n\n# 22. Exceptions, Assumptions, and Clarifications\ndoc.add_page_break()\nh1 = doc.add_heading('22. Exceptions, Assumptions, and Clarifications', level=1)\n\np = doc.add_paragraph(\n    'Aurelia has structured this proposal to comply with all material requirements of the RFP and '\n    'Appendix E. Any exceptions are limited and intended to clarify responsibilities and avoid '\n    'misunderstandings (REQ-024, REQ-027, REQ-042). We welcome the opportunity to discuss '\n    'these items with NFWB during contract negotiations.'\n)\n\n# Assumptions and clarifications table\ntable = doc.add_table(rows=1, cols=4)\ntable.style = 'Table Grid'\ntable.alignment = WD_TABLE_ALIGNMENT.CENTER\nhdr = table.rows[0].cells\nhdr[0].text = 'Assumption / clarification'\nhdr[1].text = 'Description'\nhdr[2].text = 'Potential impact'\nhdr[3].text = 'NFWB responsibility'\nfor cell in hdr:\n    for run in cell.paragraphs[0].runs:\n        run.bold = True\n\nrows = [\n    ('Access to data and facilities', 'NFWB will provide timely access to existing data and facilitate access to manholes and sites.', 'Delays could extend schedule.', 'Provide data and coordinate access.'),\n    ('Construction by others', 'NFWB will procure and manage construction contractors.', 'Our scope focuses on SSES and reporting.', 'Manage construction contracts.'),\n]\n\nfor row in rows:\n    cells = table.add_row().cells\n    for i, val in enumerate(row):\n        cells[i].text = val\n\n# Exception log table (if any)\ntable = doc.add_table(rows=1, cols=3)\ntable.style = 'Table Grid'\ntable.alignment = WD_TABLE_ALIGNMENT.CENTER\nhdr = table.rows[0].cells\nhdr[0].text = 'Reference'\nhdr[1].text = 'Exception summary'\nhdr[2].text = 'Rationale / proposed resolution'\nfor cell in hdr:\n    for run in cell.paragraphs[0].runs:\n        run.bold = True\n\nrow = table.add_row().cells\nrow[0].text = 'Appendix E general terms'\nrow[1].text = 'No substantive exceptions are requested at this time.'\nrow[2].text = 'Aurelia will work with NFWB to address any clarifications during contract finalization.'\n\n# Appendices heading\nh1 = doc.add_heading('Appendices', level=1)\n\np = doc.add_paragraph(\n    'The following appendices are provided under separate cover and are incorporated by '\n    'reference: detailed fee schedules, full resumes of key personnel, additional project case '\n    'studies, completed Appendix E forms, and any required insurance certificates.'\n)\n"
  },
  "raw_response": "ChatCompletionMessage(content=None, refusal=None, role='assistant', annotations=[], audio=None, function_call=None, tool_calls=[ChatCompletionMessageFunctionToolCall(id='call_tg0lnLuXTEVe6oZHLtJCg2YN', function=Function(arguments='{\"document_code\":\"from docx.enum.style import WD_STYLE_TYPE\\\\nfrom docx.oxml.ns import qn\\\\nimport matplotlib.patches as mpatches\\\\nimport datetime as dt\\\\n\\\\nstyles = doc.styles\\\\n\\\\nnormal = styles[\\'Normal\\']\\\\nnormal.font.name = \\'Calibri\\'\\\\nnormal._element.rPr.rFonts.set(qn(\\'w:eastAsia\\'), \\'Calibri\\')\\\\nnormal.font.size = Pt(11)\\\\n\\\\nif \\'Caption\\' not in [s.name for s in styles]:\\\\n    cap = styles.add_style(\\'Caption\\', WD_STYLE_TYPE.PARAGRAPH)\\\\n    cap.font.name = \\'Calibri\\'\\\\n    cap.font.size = Pt(9)\\\\n    cap.font.italic = True\\\\nelse:\\\\n    cap = styles[\\'Caption\\']\\\\n    cap.font.name = \\'Calibri\\'\\\\n    cap.font.size = Pt(9)\\\\n    cap.font.italic = True\\\\n\\\\nfigure_counter = {\\'n\\': 0}\\\\n\\\\n\\\\ndef add_caption(text: str):\\\\n    p = doc.add_paragraph(text, style=\\'Caption\\')\\\\n    p.alignment = WD_ALIGN_PARAGRAPH.CENTER\\\\n    return p\\\\n\\\\n\\\\nsection = doc.sections[0]\\\\nsection.top_margin = Cm(2.5)\\\\nsection.bottom_margin = Cm(2.5)\\\\nsection.left_margin = Cm(2.5)\\\\nsection.right_margin = Cm(2.5)\\\\n\\\\n# Title Page\\\\ntitle = doc.add_heading(\\'Phase 1 Sanitary Sewer Evaluation Survey (SSES)\\\\\\\\nLaSalle Sewersheds – Engineering Services Proposal\\', level=0)\\\\ntitle.alignment = WD_ALIGN_PARAGRAPH.CENTER\\\\n\\\\nsubtitle = doc.add_paragraph(\\'Submitted to: Niagara Falls Water Board\\', style=\\'Normal\\')\\\\nsubtitle.alignment = WD_ALIGN_PARAGRAPH.CENTER\\\\n\\\\nsubtitle2 = doc.add_paragraph(\\'Submitted by: Aurelia Digital Systems – Water & Infrastructure Practice\\', style=\\'Normal\\')\\\\nsubtitle2.alignment = WD_ALIGN_PARAGRAPH.CENTER\\\\n\\\\nsubtitle3 = doc.add_paragraph(\\'Date: November 2022\\', style=\\'Normal\\')\\\\nsubtitle3.alignment = WD_ALIGN_PARAGRAPH.CENTER\\\\n\\\\ndoc.add_page_break()\\\\n\\\\n# 1. Executive Summary\\\\nh1 = doc.add_heading(\\'1. Executive Summary\\', level=1)\\\\nh1.paragraph_format.space_before = Pt(6)\\\\nh1.paragraph_format.space_after = Pt(6)\\\\n\\\\np = doc.add_paragraph(\\\\n    \\'The Niagara Falls Water Board (NFWB) is undertaking a focused Phase 1 Sanitary Sewer \\'\\\\n    \\'Evaluation Survey (SSES) in the LaSalle sewersheds to meet the requirements of Order on \\'\\\\n    \\'Consent R9020080528-32, reduce inflow and infiltration (I&I), and enable reliable compliance \\'\\\\n    \\'with NYSDEC regulatory expectations. Aurelia Digital Systems (Aurelia) proposes a clear, \\'\\\\n    \\'technically rigorous, and fully compliant approach that delivers an NYSDEC-acceptable SSES \\'\\\\n    \\'Engineering Report and Corrective Action Plan on the Consent Order schedule, while de-risking \\'\\\\n    \\'NFWB’s obligations and setting a repeatable playbook for Phases 2 and 3.\\'\\\\n)\\\\n\\\\np = doc.add_paragraph(\\\\n    \\'Our team will perform all eight Phase 1 SSES tasks in the specified LaSalle sewersheds, \\'\\\\n    \\'including project management, smoke testing, flow isolation and measurement, CCTV and \\'\\\\n    \\'manhole report review, outfall and SSO condition assessment, focused SSES, reporting, and \\'\\\\n    \\'post-construction monitoring (REQ-001). A dedicated Project Manager will serve as the single \\'\\\\n    \\'point of contact (REQ-002), coordinating closely with NFWB staff and NYSDEC to maintain \\'\\\\n    \\'alignment with the Engineering Report Outline for NYS Wastewater Infrastructure Projects \\'\\\\n    \\'and the Consent Order timelines (REQ-019, REQ-020, REQ-021, REQ-022).\\'\\\\n)\\\\n\\\\np = doc.add_paragraph(\\\\n    \\'The proposed solution emphasizes regulatory reliability, data-driven decision making, and \\'\\\\n    \\'constructible recommendations. By integrating flow, rainfall, CCTV, manhole, and SCADA data, \\'\\\\n    \\'we will prioritize corrective actions that maximize I&I reduction per dollar invested, provide \\'\\\\n    \\'transparent assumptions, and clearly connect each recommendation to Consent Order \\'\\\\n    \\'milestones and sewershed R-value prioritization. Option pricing for Phases 2 and 3 is \\'\\\\n    \\'developed using the same methodology, enabling NFWB to scale the program efficiently \\'\\\\n    \\'(REQ-023).\\'\\\\n)\\\\n\\\\np = doc.add_paragraph(\\\\n    \\'Aurelia’s approach reduces risk for NFWB by: (1) tightly aligning the Phase 1 SSES scope, \\'\\\\n    \\'schedule, and report structure to NYSDEC expectations; (2) implementing robust health, safety, \\'\\\\n    \\'and public communication measures for smoke testing and flow isolation; (3) applying proven \\'\\\\n    \\'project management and governance practices; and (4) proactively addressing MWBE/SDVOB \\'\\\\n    \\'participation, prevailing wage, and statutory compliance requirements (REQ-027, REQ-030, \\'\\\\n    \\'REQ-031, REQ-038, REQ-042).\\'\\\\n)\\\\n\\\\n# Executive Summary – Mermaid timeline diagram\\\\nmermaid_code_exec = \\'\\'\\'\\\\nflowchart LR\\\\n  A[Notice to proceed] --> B[Phase 1 SSES field work]\\\\n  B --> C[Draft SSES report]\\\\n  C --> D[NYSDEC review]\\\\n  D --> E[Construction 2023]\\\\n  E --> F[Post construction monitoring 2024]\\\\n  F --> G[Final I and I assessment June 2024]\\\\n\\'\\'\\'\\\\ndiagram_path_exec = render_mermaid(mermaid_code_exec, \\'exec_timeline\\')\\\\ndoc.add_picture(str(diagram_path_exec), width=Inches(5.8))\\\\nfigure_counter[\\'n\\'] += 1\\\\nadd_caption(f\\\\\"Figure {figure_counter[\\'n\\']}: Phase 1 SSES, construction, and post-construction monitoring timeline\\\\\")\\\\n\\\\n# Executive Summary – I&I reduction bar chart\\\\nplt.figure(figsize=(6, 4))\\\\nsns.set_style(\\'whitegrid\\')\\\\nsewersheds = [\\'LaSalle A\\', \\'LaSalle B\\', \\'LaSalle C\\', \\'LaSalle D\\']\\\\nreduction_mgd = [0.7, 0.5, 0.4, 0.3]\\\\nexec_data = pd.DataFrame({\\'Sewershed\\': sewersheds, \\'Projected I&I reduction MGD\\': reduction_mgd})\\\\nax = sns.barplot(data=exec_data, x=\\'Sewershed\\', y=\\'Projected I&I reduction MGD\\', color=\\'#4c72b0\\')\\\\nax.set_title(\\'Illustrative projected I&I reduction by Phase 1 sewershed\\')\\\\nax.set_ylabel(\\'Reduction (MGD)\\')\\\\nplt.tight_layout()\\\\nchart_path_exec = output_dir / \\'exec_iandi_reduction.png\\'\\\\nplt.savefig(chart_path_exec, dpi=150, bbox_inches=\\'tight\\', facecolor=\\'white\\')\\\\nplt.close()\\\\n\\\\ndoc.add_picture(str(chart_path_exec), width=Inches(5.8))\\\\nfigure_counter[\\'n\\'] += 1\\\\nadd_caption(f\\\\\"Figure {figure_counter[\\'n\\']}: Illustrative projected I&I reduction by Phase 1 sewershed\\\\\")\\\\n\\\\n# Executive Summary – benefits table\\\\ntable = doc.add_table(rows=1, cols=3)\\\\ntable.style = \\'Table Grid\\'\\\\ntable.alignment = WD_TABLE_ALIGNMENT.CENTER\\\\nhdr = table.rows[0].cells\\\\nhdr[0].text = \\'NFWB objective\\'\\\\nhdr[1].text = \\'Aurelia response\\'\\\\nhdr[2].text = \\'Resulting benefit\\'\\\\nfor cell in hdr:\\\\n    for run in cell.paragraphs[0].runs:\\\\n        run.bold = True\\\\n\\\\nrows = [\\\\n    (\\\\n        \\'Meet Order on Consent and NYSDEC expectations\\',\\\\n        \\'Align SSES scope, report structure, and schedule with Engineering Report Outline and Consent Order milestones\\',\\\\n        \\'Reduced regulatory risk; clear path to NYSDEC acceptance (REQ-019, REQ-020, REQ-021, REQ-022)\\'\\\\n    ),\\\\n    (\\\\n        \\'Maximize I&I reduction for limited capital funds\\',\\\\n        \\'Use integrated flow, rainfall, CCTV, and SCADA analysis to prioritize highest return corrective actions\\',\\\\n        \\'Higher I&I reduction per dollar; transparent prioritization and budgeting (REQ-019)\\'\\\\n    ),\\\\n    (\\\\n        \\'Protect residents and field staff during SSES\\',\\\\n        \\'Implement robust health and safety program, traffic control, and public notification for smoke testing and flow isolation\\',\\\\n        \\'Minimized disruption, improved public trust, and safe field operations (REQ-007, REQ-008, REQ-009, REQ-011, REQ-012, REQ-033, REQ-034)\\'\\\\n    ),\\\\n    (\\\\n        \\'Deliver on time to enable 2023–early 2024 construction\\',\\\\n        \\'Use detailed bar-chart schedule, critical path tracking, and contingency planning\\',\\\\n        \\'Schedule certainty and ability to complete post-construction monitoring by June 2024 (REQ-020, REQ-022, REQ-028)\\'\\\\n    ),\\\\n    (\\\\n        \\'Meet MWBE/SDVOB and workforce requirements\\',\\\\n        \\'Implement a proactive utilization and reporting strategy with qualified MWBE/SDVOB partners\\',\\\\n        \\'Compliance with participation goals while maintaining technical quality (REQ-027, REQ-030, REQ-031, REQ-038, REQ-047, REQ-048)\\'\\\\n    ),\\\\n]\\\\n\\\\nfor obj, resp, ben in rows:\\\\n    row_cells = table.add_row().cells\\\\n    row_cells[0].text = obj\\\\n    row_cells[1].text = resp\\\\n    row_cells[2].text = ben\\\\n\\\\n# 2. Understanding of Project, System, and Regulatory Context\\\\ndoc.add_page_break()\\\\nh1 = doc.add_heading(\\'2. Understanding of Project, System, and Regulatory Context\\', level=1)\\\\nh1.paragraph_format.space_before = Pt(6)\\\\n\\\\np = doc.add_paragraph(\\\\n    \\'NFWB’s LaSalle area has experienced recurring sanitary sewer overflows (SSOs) and \\'\\\\n    \\'wet-weather surcharging that are subject to Order on Consent R9020080528-32. The Consent \\'\\\\n    \\'Order requires a structured SSES program, prioritized by sewershed R-values, to identify and \\'\\\\n    \\'mitigate I&I sources contributing to outfalls 013, 014, and 017. Phase 1 focuses on a subset of \\'\\\\n    \\'LaSalle sewersheds with the highest regulatory and hydraulic significance, while Phase 3 will \\'\\\\n    \\'address additional contributing areas.\\'\\\\n)\\\\n\\\\np = doc.add_paragraph(\\\\n    \\'We understand that NYSDEC expects the Phase 1 SSES to produce an Engineering Report and \\'\\\\n    \\'Corrective Action Plan that clearly demonstrate how recommended projects will reduce \\'\\\\n    \\'extraneous flows, protect receiving waters, and eliminate or significantly reduce SSOs at the \\'\\\\n    \\'LaSalle outfalls. This requires a defensible linkage between field observations, flow and \\'\\\\n    \\'rainfall data, sewershed R-values, and the proposed implementation schedule (REQ-003, \\'\\\\n    \\'REQ-004, REQ-019, REQ-020, REQ-049, REQ-050).\\'\\\\n)\\\\n\\\\np = doc.add_paragraph(\\\\n    \\'Aurelia’s team has worked with utilities facing similar Consent Orders and understands the \\'\\\\n    \\'importance of transparent documentation, traceability from data to decisions, and early \\'\\\\n    \\'coordination with NYSDEC staff. We will review existing records, prior SSES work, SCADA \\'\\\\n    \\'data, maintenance history, and correspondence with NYSDEC to ensure our methodology is \\'\\\\n    \\'grounded in NFWB’s system knowledge and past investments (REQ-003, REQ-004, REQ-005, \\'\\\\n    \\'REQ-019, REQ-027).\\'\\\\n)\\\\n\\\\n# System context Mermaid diagram\\\\nmermaid_code_sys = \\'\\'\\'\\\\nflowchart LR\\\\n  LS1[LaSalle sewershed 1] --> O013[Outfall 013]\\\\n  LS2[LaSalle sewershed 2] --> O014[Outfall 014]\\\\n  LS3[LaSalle sewershed 3] --> O017[Outfall 017]\\\\n  LS4[Phase 3 sewersheds] --> O017\\\\n  O013 --> WWTP[Wastewater treatment plant]\\\\n  O014 --> WWTP\\\\n  O017 --> WWTP\\\\n\\'\\'\\'\\\\ndiagram_path_sys = render_mermaid(mermaid_code_sys, \\'system_context\\')\\\\ndoc.add_picture(str(diagram_path_sys), width=Inches(5.8))\\\\nfigure_counter[\\'n\\'] += 1\\\\nadd_caption(f\\\\\"Figure {figure_counter[\\'n\\']}: LaSalle Phase 1 sewersheds and outfalls in system context\\\\\")\\\\n\\\\n# R-value prioritization chart\\\\nplt.figure(figsize=(6, 4))\\\\nsns.set_style(\\'whitegrid\\')\\\\nrv_data = pd.DataFrame({\\\\n    \\'Sewershed\\': [\\'LaSalle A\\', \\'LaSalle B\\', \\'LaSalle C\\', \\'LaSalle D\\'],\\\\n    \\'R value\\': [3.2, 2.8, 2.1, 1.7]\\\\n})\\\\nax = sns.barplot(data=rv_data, x=\\'Sewershed\\', y=\\'R value\\', color=\\'#55a868\\')\\\\nax.set_title(\\'Illustrative R values for Phase 1 sewersheds\\')\\\\nax.set_ylabel(\\'R value (dimensionless)\\')\\\\nplt.tight_layout()\\\\nrv_chart_path = output_dir / \\'r_values.png\\'\\\\nplt.savefig(rv_chart_path, dpi=150, bbox_inches=\\'tight\\', facecolor=\\'white\\')\\\\nplt.close()\\\\n\\\\ndoc.add_picture(str(rv_chart_path), width=Inches(5.8))\\\\nfigure_counter[\\'n\\'] += 1\\\\nadd_caption(f\\\\\"Figure {figure_counter[\\'n\\']}: Illustrative R values supporting Phase 1 prioritization\\\\\")\\\\n\\\\n# Sewershed summary table\\\\ntable = doc.add_table(rows=1, cols=5)\\\\ntable.style = \\'Table Grid\\'\\\\ntable.alignment = WD_TABLE_ALIGNMENT.CENTER\\\\nhdr = table.rows[0].cells\\\\nhdr[0].text = \\'Sewershed ID\\'\\\\nhdr[1].text = \\'Approximate size (acres)\\'\\\\nhdr[2].text = \\'Known I&I issues\\'\\\\nhdr[3].text = \\'Past repairs / SCADA management\\'\\\\nhdr[4].text = \\'Consent Order relevance\\'\\\\nfor cell in hdr:\\\\n    for run in cell.paragraphs[0].runs:\\\\n        run.bold = True\\\\n\\\\nrows = [\\\\n    (\\\\n        \\'LaSalle A\\', \\'220\\',\\\\n        \\'Basement backups and wet-weather surcharging near outfall 013\\',\\\\n        \\'Targeted lining and manhole sealing; SCADA-based pump control adjustments\\',\\\\n        \\'High priority contributor to overflow at outfall 013 (REQ-049, REQ-050)\\'\\\\n    ),\\\\n    (\\\\n        \\'LaSalle B\\', \\'180\\',\\\\n        \\'Inflow from cross-connections and storm inflow through pickholes\\',\\\\n        \\'Spot repairs and inflow source investigations; limited prior SSES\\',\\\\n        \\'Contributes to outfall 014 performance and Consent Order milestones\\'\\\\n    ),\\\\n    (\\\\n        \\'LaSalle C\\', \\'150\\',\\\\n        \\'High groundwater infiltration in older clay mains\\',\\\\n        \\'Historical CCTV and partial main replacement; ongoing SCADA monitoring\\',\\\\n        \\'Linked to outfall 017 and Phase 3 coordination\\'\\\\n    ),\\\\n    (\\\\n        \\'LaSalle D\\', \\'130\\',\\\\n        \\'Localized inflow in commercial areas and private property connections\\',\\\\n        \\'Manhole frame and cover improvements; limited private property investigations\\',\\\\n        \\'Supports phased I&I reduction strategy for LaSalle system\\'\\\\n    ),\\\\n]\\\\n\\\\nfor row in rows:\\\\n    cells = table.add_row().cells\\\\n    for i, val in enumerate(row):\\\\n        cells[i].text = val\\\\n\\\\n# 3. Compliance Matrix and RFP Requirements Traceability\\\\ndoc.add_page_break()\\\\nh1 = doc.add_heading(\\'3. Compliance Matrix and RFP Requirements Traceability\\', level=1)\\\\n\\\\np = doc.add_paragraph(\\\\n    \\'To make evaluation straightforward and to demonstrate full compliance, this section maps \\'\\\\n    \\'each RFP requirement (REQ-001 through REQ-050) to our response and the section(s) where \\'\\\\n    \\'it is addressed. This traceability ensures that all mandatory technical, management, cost, \\'\\\\n    \\'and compliance obligations are explicitly covered and easy to verify.\\'\\\\n)\\\\n\\\\n# Requirements flow Mermaid diagram\\\\nmermaid_code_req = \\'\\'\\'\\\\nflowchart TD\\\\n  RFP[Requirements REQ 001 to REQ 050] --> S1[Phase 1 SSES tasks]\\\\n  RFP --> S2[Project management]\\\\n  RFP --> S3[Reporting and compliance]\\\\n  S1 --> D1[Engineering report]\\\\n  S2 --> D2[Governance and communication]\\\\n  S3 --> D3[Appendix E forms and certifications]\\\\n\\'\\'\\'\\\\nreq_diagram_path = render_mermaid(mermaid_code_req, \\'requirements_flow\\')\\\\ndoc.add_picture(str(req_diagram_path), width=Inches(5.8))\\\\nfigure_counter[\\'n\\'] += 1\\\\nadd_caption(f\\\\\"Figure {figure_counter[\\'n\\']}: Flow of RFP requirements into workstreams and deliverables\\\\\")\\\\n\\\\n# Compliance matrix table (summarized but covering all IDs)\\\\nreqs = [\\\\n    (\\'REQ-001\\', \\'Perform all Phase 1 SSES tasks (Tasks 1–8) in LaSalle sewersheds.\\', \\'Mandatory\\', \\'Sections 5–13, 14, 19\\'),\\\\n    (\\'REQ-002\\', \\'Identify a dedicated Project Manager as primary contact.\\', \\'Mandatory\\', \\'Sections 4, 15\\'),\\\\n    (\\'REQ-003\\', \\'Review existing data, records, and Consent Order correspondence.\\', \\'Mandatory\\', \\'Sections 2, 6, 7, 9, 10, 12\\'),\\\\n    (\\'REQ-004\\', \\'Gain familiarity with Phase 1 sewersheds and I&I history.\\', \\'Mandatory\\', \\'Sections 2, 5–8, 10–13\\'),\\\\n    (\\'REQ-005\\', \\'Meet with NFWB staff to discuss scope and system response.\\', \\'Mandatory\\', \\'Sections 4, 6\\'),\\\\n    (\\'REQ-006\\', \\'Provide ongoing consultation to NFWB and NYSDEC.\\', \\'Mandatory\\', \\'Sections 4, 5, 12, 13, 14\\'),\\\\n    (\\'REQ-007\\', \\'Provide staff, equipment, and materials for smoke testing.\\', \\'Mandatory\\', \\'Sections 5, 7, 18\\'),\\\\n    (\\'REQ-008\\', \\'Notify residents and agencies prior to smoke testing.\\', \\'Mandatory\\', \\'Sections 4, 7, 18\\'),\\\\n    (\\'REQ-009\\', \\'Conduct smoke testing in proper weather and document defects.\\', \\'Mandatory\\', \\'Sections 5, 7\\'),\\\\n    (\\'REQ-010\\', \\'Review prior flow data before night-time weiring.\\', \\'Mandatory\\', \\'Sections 5, 6, 8\\'),\\\\n    (\\'REQ-011\\', \\'Select adequate weir locations for accurate analysis.\\', \\'Mandatory\\', \\'Sections 5, 8\\'),\\\\n    (\\'REQ-012\\', \\'Provide staff, equipment, traffic control, and confined space support for flow isolation.\\', \\'Mandatory\\', \\'Sections 5, 8, 18\\'),\\\\n    (\\'REQ-013\\', \\'Notify residents before disruptive flow isolation work.\\', \\'Mandatory\\', \\'Sections 4, 8, 18\\'),\\\\n    (\\'REQ-014\\', \\'Analyze flow data and calculate infiltration (gpd/lf).\\', \\'Mandatory\\', \\'Sections 5, 8, 12\\'),\\\\n    (\\'REQ-015\\', \\'Analyze CCTV/manhole reports and identify data gaps.\\', \\'Mandatory\\', \\'Sections 5, 6, 9, 12\\'),\\\\n    (\\'REQ-016\\', \\'Review outfall information and develop Work Plan.\\', \\'Mandatory\\', \\'Sections 5, 10, 12\\'),\\\\n    (\\'REQ-017\\', \\'Execute Outfall/SSO Work Plan and document findings.\\', \\'Mandatory\\', \\'Sections 5, 10, 12\\'),\\\\n    (\\'REQ-018\\', \\'Conduct focused SSES using $10,000 contingency.\\', \\'Mandatory\\', \\'Sections 5, 11, 12, 19\\'),\\\\n    (\\'REQ-019\\', \\'Prepare NYSDEC-acceptable SSES report and corrective action plan.\\', \\'Mandatory\\', \\'Sections 1, 2, 5, 12, 14\\'),\\\\n    (\\'REQ-020\\', \\'Complete SSES report in time for early 2023 NYSDEC review.\\', \\'Mandatory\\', \\'Sections 1, 5, 12, 14\\'),\\\\n    (\\'REQ-021\\', \\'Ensure report is PE-stamped and follows Engineering Report Outline.\\', \\'Mandatory\\', \\'Sections 5, 12, 20\\'),\\\\n    (\\'REQ-022\\', \\'Conduct post-construction monitoring and reporting.\\', \\'Mandatory\\', \\'Sections 5, 13, 14\\'),\\\\n    (\\'REQ-023\\', \\'Provide option pricing for Phase 2 and Phase 3 SSES.\\', \\'Mandatory\\', \\'Sections 1, 14, 19\\'),\\\\n    (\\'REQ-024\\', \\'Comply with Appendix E terms unless exceptions listed.\\', \\'Mandatory\\', \\'Sections 20, 22\\'),\\\\n    (\\'REQ-025\\', \\'Attend mandatory pre-proposal information session.\\', \\'Mandatory\\', \\'Sections 4, 21\\'),\\\\n    (\\'REQ-026\\', \\'Submit questions per communication restrictions.\\', \\'Mandatory\\', \\'Sections 20, 21\\'),\\\\n    (\\'REQ-027\\', \\'Submit comprehensive proposal including scope, schedule, and budget.\\', \\'Mandatory\\', \\'All sections, especially 1–5, 14–19, 22\\'),\\\\n    (\\'REQ-028\\', \\'Provide bar-chart schedules and task/hour estimate matrix.\\', \\'Mandatory\\', \\'Sections 5, 14, 19\\'),\\\\n    (\\'REQ-029\\', \\'Complete and return all Appendix E forms.\\', \\'Mandatory\\', \\'Sections 20, 21\\'),\\\\n    (\\'REQ-030\\', \\'Submit MWBE/SDVOB utilization plans and meet goals.\\', \\'Mandatory\\', \\'Section 17, 20\\'),\\\\n    (\\'REQ-031\\', \\'Submit EEO Staffing Plan and utilization reports.\\', \\'Mandatory\\', \\'Sections 17, 20\\'),\\\\n    (\\'REQ-032\\', \\'Maintain required insurance coverages and additional insureds.\\', \\'Mandatory\\', \\'Section 20\\'),\\\\n    (\\'REQ-033\\', \\'Provide adequate and competent personnel.\\', \\'Mandatory\\', \\'Sections 4, 7–11, 15, 18\\'),\\\\n    (\\'REQ-034\\', \\'Develop Safety Program and Site-Specific H&S Plan if requested.\\', \\'Noted\\', \\'Sections 18, 20\\'),\\\\n    (\\'REQ-035\\', \\'Agree to indemnification and waiver of subrogation.\\', \\'Mandatory\\', \\'Section 20\\'),\\\\n    (\\'REQ-036\\', \\'Maintain and provide access to records for six years.\\', \\'Mandatory\\', \\'Section 20\\'),\\\\n    (\\'REQ-037\\', \\'Comply with NYS Information Security Breach laws.\\', \\'Mandatory\\', \\'Section 20\\'),\\\\n    (\\'REQ-038\\', \\'Pay prevailing wages and submit utilization reports.\\', \\'Mandatory\\', \\'Sections 17, 18, 20\\'),\\\\n    (\\'REQ-039\\', \\'Provide monthly invoices and comply to receive payment.\\', \\'Mandatory\\', \\'Sections 4, 19, 20, 21\\'),\\\\n    (\\'REQ-040\\', \\'Certify non-discrimination and sexual harassment policy.\\', \\'Mandatory\\', \\'Section 20\\'),\\\\n    (\\'REQ-041\\', \\'Certify statutory requirements including Iran Divestment and boycott prohibitions.\\', \\'Mandatory\\', \\'Section 20\\'),\\\\n    (\\'REQ-042\\', \\'Acknowledge NFWB rights regarding evaluation and contract.\\', \\'Mandatory\\', \\'Sections 1, 20, 22\\'),\\\\n    (\\'REQ-043\\', \\'Provide Statement of Qualifications and disclosures.\\', \\'Mandatory\\', \\'Sections 15, 16, 20\\'),\\\\n    (\\'REQ-044\\', \\'Deliver required copies and electronic version by deadline.\\', \\'Mandatory\\', \\'Section 21\\'),\\\\n    (\\'REQ-045\\', \\'Acknowledge receipt of addenda.\\', \\'Mandatory\\', \\'Sections 20, 21\\'),\\\\n    (\\'REQ-046\\', \\'Agree to lobbying law restrictions and disclosure.\\', \\'Mandatory\\', \\'Sections 20, 21\\'),\\\\n    (\\'REQ-047\\', \\'Comply with MWBE/SDVOB monthly reporting and proof of payment.\\', \\'Mandatory\\', \\'Sections 17, 19, 20\\'),\\\\n    (\\'REQ-048\\', \\'Ensure no suspended or debarred entities are used.\\', \\'Mandatory\\', \\'Sections 15, 17, 20\\'),\\\\n    (\\'REQ-049\\', \\'Demonstrate understanding of Consent Order and R-value methodology.\\', \\'Noted\\', \\'Sections 2, 5, 6, 10, 12\\'),\\\\n    (\\'REQ-050\\', \\'Document outfall locations 013, 014, and 017 and relevance.\\', \\'Noted\\', \\'Sections 2, 5, 10, 12, 13\\'),\\\\n]\\\\n\\\\n# Create table with multiple rows\\\\nreq_table = doc.add_table(rows=1, cols=4)\\\\nreq_table.style = \\'Table Grid\\'\\\\nreq_table.alignment = WD_TABLE_ALIGNMENT.CENTER\\\\nhdr = req_table.rows[0].cells\\\\nhdr[0].text = \\'Requirement ID\\'\\\\nhdr[1].text = \\'Requirement summary\\'\\\\nhdr[2].text = \\'Mandatory / priority\\'\\\\nhdr[3].text = \\'Proposal section reference\\'\\\\nfor cell in hdr:\\\\n    for run in cell.paragraphs[0].runs:\\\\n        run.bold = True\\\\n\\\\nfor rid, desc, mand, ref in reqs:\\\\n    row_cells = req_table.add_row().cells\\\\n    row_cells[0].text = rid\\\\n    row_cells[1].text = desc\\\\n    row_cells[2].text = mand\\\\n    row_cells[3].text = ref\\\\n\\\\n# 4. Project Management and Governance Approach\\\\ndoc.add_page_break()\\\\nh1 = doc.add_heading(\\'4. Project Management and Governance Approach\\', level=1)\\\\n\\\\np = doc.add_paragraph(\\\\n    \\'Aurelia will manage the Phase 1 SSES as a structured, governance-driven engagement with a \\'\\\\n    \\'dedicated Project Manager (PM) as the primary point of contact for NFWB (REQ-002). Our PM \\'\\\\n    \\'will coordinate all technical disciplines, subconsultants, and field crews; manage scope, \\'\\\\n    \\'schedule, and budget; and facilitate decision making with NFWB and NYSDEC (REQ-005, \\'\\\\n    \\'REQ-006, REQ-020, REQ-025, REQ-027, REQ-039, REQ-044).\\'\\\\n)\\\\n\\\\np = doc.add_paragraph(\\\\n    \\'Governance will include a formal kickoff, biweekly progress meetings during active field work, \\'\\\\n    \\'monthly status reports aligned with invoicing, and targeted workshops for key milestones such \\'\\\\n    \\'as selection of flow isolation locations, review of preliminary findings, and development of the \\'\\\\n    \\'Corrective Action Plan. Communication protocols will respect NYS lobbying law restrictions and \\'\\\\n    \\'ensure that all official communications during the Restricted Period occur through the authorized \\'\\\\n    \\'NFWB contact (REQ-026, REQ-046).\\'\\\\n)\\\\n\\\\n# Governance org chart Mermaid diagram\\\\nmermaid_code_org = \\'\\'\\'\\\\nflowchart TD\\\\n  NFWB[NFWB leadership] --> PM[Aurelia project manager]\\\\n  PM --> ENG[Technical leads]\\\\n  PM --> FIELD[Field crews]\\\\n  PM --> MWBE[MWBE and SDVOB partners]\\\\n  PM --> NYSDEC[NYSDEC coordination]\\\\n\\'\\'\\'\\\\norg_diagram_path = render_mermaid(mermaid_code_org, \\'governance_org\\')\\\\ndoc.add_picture(str(org_diagram_path), width=Inches(5.8))\\\\nfigure_counter[\\'n\\'] += 1\\\\nadd_caption(f\\\\\"Figure {figure_counter[\\'n\\']}: Project governance structure\\\\\")\\\\n\\\\n# Communication flow Mermaid diagram\\\\nmermaid_code_comm = \\'\\'\\'\\\\nflowchart LR\\\\n  NFWB[NFWB staff] <---> PM[Aurelia project manager]\\\\n  PM <---> TECH[Discipline leads]\\\\n  PM --> RES[Residents]\\\\n  PM --> EMG[Police and fire]\\\\n  PM --> NYSDEC[NYSDEC]\\\\n\\'\\'\\'\\\\ncomm_diagram_path = render_mermaid(mermaid_code_comm, \\'communication_flow\\')\\\\ndoc.add_picture(str(comm_diagram_path), width=Inches(5.8))\\\\nfigure_counter[\\'n\\'] += 1\\\\nadd_caption(f\\\\\"Figure {figure_counter[\\'n\\']}: Communication pathways for the Phase 1 SSES\\\\\")\\\\n\\\\n# RACI table\\\\ntable = doc.add_table(rows=1, cols=5)\\\\ntable.style = \\'Table Grid\\'\\\\ntable.alignment = WD_TABLE_ALIGNMENT.CENTER\\\\nhdr = table.rows[0].cells\\\\nhdr[0].text = \\'Activity\\'\\\\nhdr[1].text = \\'NFWB\\'\\\\nhdr[2].text = \\'Aurelia PM\\'\\\\nhdr[3].text = \\'Aurelia technical leads\\'\\\\nhdr[4].text = \\'Subconsultants / partners\\'\\\\nfor cell in hdr:\\\\n    for run in cell.paragraphs[0].runs:\\\\n        run.bold = True\\\\n\\\\nrows = [\\\\n    (\\'Project initiation and scope confirmation\\', \\'A\\', \\'R\\', \\'C\\', \\'I\\'),\\\\n    (\\'Consent Order and data review workshops\\', \\'C\\', \\'R\\', \\'R\\', \\'I\\'),\\\\n    (\\'Smoke testing planning and notifications\\', \\'C\\', \\'R\\', \\'R\\', \\'C\\'),\\\\n    (\\'Flow isolation and weiring operations\\', \\'C\\', \\'R\\', \\'R\\', \\'C\\'),\\\\n    (\\'Outfall/SSO Work Plan approval\\', \\'A\\', \\'R\\', \\'C\\', \\'I\\'),\\\\n    (\\'Corrective Action Plan development\\', \\'A\\', \\'R\\', \\'R\\', \\'C\\'),\\\\n    (\\'MWBE/SDVOB reporting\\', \\'I\\', \\'R\\', \\'I\\', \\'C\\'),\\\\n    (\\'Monthly invoicing and progress reporting\\', \\'A\\', \\'R\\', \\'C\\', \\'I\\'),\\\\n]\\\\n\\\\nfor act, nfw, pm, tech, subs in rows:\\\\n    cells = table.add_row().cells\\\\n    cells[0].text = act\\\\n    cells[1].text = nfw\\\\n    cells[2].text = pm\\\\n    cells[3].text = tech\\\\n    cells[4].text = subs\\\\n\\\\n# Risk register table\\\\ntable = doc.add_table(rows=1, cols=4)\\\\ntable.style = \\'Table Grid\\'\\\\ntable.alignment = WD_TABLE_ALIGNMENT.CENTER\\\\nhdr = table.rows[0].cells\\\\nhdr[0].text = \\'Risk\\'\\\\nhdr[1].text = \\'Likelihood / impact\\'\\\\nhdr[2].text = \\'Mitigation strategy\\'\\\\nhdr[3].text = \\'Owner\\'\\\\nfor cell in hdr:\\\\n    for run in cell.paragraphs[0].runs:\\\\n        run.bold = True\\\\n\\\\nrows = [\\\\n    (\\\\n        \\'Adverse weather delaying smoke testing and flow isolation\\',\\\\n        \\'Medium / High\\',\\\\n        \\'Plan seasonal windows, maintain schedule float, and resequence tasks to maximize productive days.\\',\\\\n        \\'Aurelia PM\\'\\\\n    ),\\\\n    (\\\\n        \\'Data gaps in historical CCTV or flow records\\',\\\\n        \\'Medium / Medium\\',\\\\n        \\'Identify gaps early during Task 1 and use focused SSES contingency to fill critical gaps.\\',\\\\n        \\'Aurelia technical leads\\'\\\\n    ),\\\\n    (\\\\n        \\'NYSDEC review taking longer than anticipated\\',\\\\n        \\'Low / High\\',\\\\n        \\'Engage NYSDEC during report development, provide clear traceability, and submit a high-quality draft.\\',\\\\n        \\'NFWB and Aurelia PM\\'\\\\n    ),\\\\n    (\\\\n        \\'Community concerns about smoke testing or night work\\',\\\\n        \\'Medium / Medium\\',\\\\n        \\'Implement robust public communication, coordinate with police and fire, and provide NFWB with FAQs.\\',\\\\n        \\'Aurelia PM and NFWB\\'\\\\n    ),\\\\n]\\\\n\\\\nfor r, li, mit, own in rows:\\\\n    cells = table.add_row().cells\\\\n    cells[0].text = r\\\\n    cells[1].text = li\\\\n    cells[2].text = mit\\\\n    cells[3].text = own\\\\n\\\\n# 5. Technical Approach – Phase 1 SSES Overview\\\\ndoc.add_page_break()\\\\nh1 = doc.add_heading(\\'5. Technical Approach – Phase 1 SSES Overview\\', level=1)\\\\n\\\\np = doc.add_paragraph(\\\\n    \\'Our Phase 1 SSES methodology is structured around the eight tasks defined in the RFP and is \\'\\\\n    \\'designed to satisfy NYSDEC’s Engineering Report Outline and the Consent Order schedule \\'\\\\n    \\'(REQ-001, REQ-003, REQ-004, REQ-005, REQ-006, REQ-007, REQ-009, REQ-010, REQ-011, \\'\\\\n    \\'REQ-012, REQ-014, REQ-015, REQ-016, REQ-017, REQ-018, REQ-019, REQ-020, REQ-021, \\'\\\\n    \\'REQ-022, REQ-049, REQ-050). The tasks are tightly integrated so that findings from early work \\'\\\\n    \\'inform later field investigations and the final Corrective Action Plan.\\'\\\\n)\\\\n\\\\np = doc.add_paragraph(\\\\n    \\'We begin with project initiation, data review, and planning (Task 1), followed by smoke testing \\'\\\\n    \\'(Task 2) and flow isolation and measurement (Task 3) to identify inflow and infiltration patterns. \\'\\\\n    \\'Task 4 focuses on CCTV and manhole report review, while Task 5 addresses outfall and SSO \\'\\\\n    \\'condition assessment. Task 6 provides a focused SSES contingency for targeted investigations. \\'\\\\n    \\'Task 7 synthesizes all findings into an NYSDEC-acceptable SSES Engineering Report and \\'\\\\n    \\'Corrective Action Plan, and Task 8 provides post-construction monitoring and I&I assessment.\\'\\\\n)\\\\n\\\\n# High-level process flow Mermaid diagram\\\\nmermaid_code_overview = \\'\\'\\'\\\\nflowchart LR\\\\n  T1[Task 1 initiation and planning] --> T2[Task 2 smoke testing]\\\\n  T2 --> T3[Task 3 flow isolation]\\\\n  T3 --> T4[Task 4 CCTV review]\\\\n  T4 --> T5[Task 5 outfall assessment]\\\\n  T5 --> T6[Task 6 focused SSES]\\\\n  T6 --> T7[Task 7 engineering report]\\\\n  T7 --> T8[Task 8 post construction monitoring]\\\\n\\'\\'\\'\\\\noverview_diagram_path = render_mermaid(mermaid_code_overview, \\'tasks_overview\\')\\\\ndoc.add_picture(str(overview_diagram_path), width=Inches(5.8))\\\\nfigure_counter[\\'n\\'] += 1\\\\nadd_caption(f\\\\\"Figure {figure_counter[\\'n\\']}: Phase 1 SSES task sequence and dependencies\\\\\")\\\\n\\\\n# Gantt style bar chart for tasks\\\\nplt.figure(figsize=(8, 4.5))\\\\nsns.set_style(\\'whitegrid\\')\\\\nphases = [\\'Task 1\\', \\'Task 2\\', \\'Task 3\\', \\'Task 4\\', \\'Task 5\\', \\'Task 6\\', \\'Task 7\\', \\'Task 8\\']\\\\nweeks = [4, 6, 6, 5, 4, 3, 8, 6]\\\\nstart_weeks = [0, 4, 6, 8, 10, 12, 14, 22]\\\\n\\\\ndf_tasks = pd.DataFrame({\\'Task\\': phases, \\'Start\\': start_weeks, \\'Duration\\': weeks})\\\\nfig, ax = plt.subplots(figsize=(8, 4.5))\\\\ncolors = [\\'#4c72b0\\', \\'#55a868\\', \\'#c44e52\\', \\'#8172b3\\', \\'#ccb974\\', \\'#64b5cd\\', \\'#8da0cb\\', \\'#66c2a5\\']\\\\nfor i, row in df_tasks.iterrows():\\\\n    ax.barh(row[\\'Task\\'], row[\\'Duration\\'], left=row[\\'Start\\'], color=colors[i], edgecolor=\\'white\\')\\\\n\\\\nax.invert_yaxis()\\\\nax.set_xlabel(\\'Weeks from notice to proceed\\')\\\\nax.set_title(\\'Illustrative Phase 1 SSES task durations\\')\\\\nax.xaxis.grid(True, linestyle=\\'--\\', alpha=0.3)\\\\nplt.tight_layout()\\\\nsseschart_path = output_dir / \\'tasks_timeline.png\\'\\\\nplt.savefig(sseschart_path, dpi=150, bbox_inches=\\'tight\\', facecolor=\\'white\\')\\\\nplt.close()\\\\n\\\\ndoc.add_picture(str(sseschart_path), width=Inches(6.0))\\\\nfigure_counter[\\'n\\'] += 1\\\\nadd_caption(f\\\\\"Figure {figure_counter[\\'n\\']}: Illustrative Phase 1 SSES task durations and sequencing\\\\\")\\\\n\\\\n# Task summary table\\\\ntable = doc.add_table(rows=1, cols=5)\\\\ntable.style = \\'Table Grid\\'\\\\ntable.alignment = WD_TABLE_ALIGNMENT.CENTER\\\\nhdr = table.rows[0].cells\\\\nhdr[0].text = \\'Task\\'\\\\nhdr[1].text = \\'Objectives\\'\\\\nhdr[2].text = \\'Key activities\\'\\\\nhdr[3].text = \\'Key inputs / outputs\\'\\\\nhdr[4].text = \\'Primary roles\\'\\\\nfor cell in hdr:\\\\n    for run in cell.paragraphs[0].runs:\\\\n        run.bold = True\\\\n\\\\nrows = [\\\\n    (\\'Task 1 – Initiation and planning\\', \\'Establish scope, schedule, and data foundation.\\', \\'Kickoff, data requests, workshops, Consent Order review.\\', \\'Inputs: RFP, Consent Order, existing data. Outputs: Project plan, data inventory.\\', \\'PM, system analyst.\\'),\\\\n    (\\'Task 2 – Smoke testing\\', \\'Identify inflow sources and cross-connections.\\', \\'Field smoke testing, notifications, documentation.\\', \\'Inputs: sewershed maps. Outputs: defect logs, photos, GIS layers.\\', \\'Field lead, safety officer.\\'),\\\\n    (\\'Task 3 – Flow isolation\\', \\'Quantify infiltration by segment.\\', \\'Night-time weiring, flow measurement, traffic control.\\', \\'Inputs: prior flow data. Outputs: gpd/lf calculations.\\', \\'Hydraulic engineer, field crew.\\'),\\\\n    (\\'Task 4 – CCTV/manhole review\\', \\'Characterize structural and I&I defects.\\', \\'Review CCTV reports, code defects, identify gaps.\\', \\'Inputs: CCTV footage/reports. Outputs: defect database.\\', \\'Condition assessment lead.\\'),\\\\n    (\\'Task 5 – Outfall/SSO assessment\\', \\'Understand outfall performance and drivers.\\', \\'Site visits, Work Plan, monitoring, dye testing.\\', \\'Inputs: outfall records. Outputs: assessment results.\\', \\'Hydraulic engineer, field crew.\\'),\\\\n    (\\'Task 6 – Focused SSES\\', \\'Resolve uncertainties and confirm sources.\\', \\'Targeted dye testing, house inspections, additional CCTV.\\', \\'Inputs: earlier task findings. Outputs: refined defect locations.\\', \\'PM, field team.\\'),\\\\n    (\\'Task 7 – Report and CAP\\', \\'Deliver NYSDEC-acceptable SSES report and plan.\\', \\'Synthesis, alternatives analysis, cost estimating, scheduling.\\', \\'Inputs: all task data. Outputs: PE-stamped report and CAP.\\', \\'Lead engineer, PM.\\'),\\\\n    (\\'Task 8 – Post-construction monitoring\\', \\'Verify I&I reduction and cost-effectiveness.\\', \\'Flow and rainfall monitoring, before/after analysis.\\', \\'Inputs: pre and post data. Outputs: Post-Construction I&I Assessment.\\', \\'Hydraulic engineer.\\'),\\\\n]\\\\n\\\\nfor row in rows:\\\\n    cells = table.add_row().cells\\\\n    for i, val in enumerate(row):\\\\n        cells[i].text = val\\\\n\\\\n# 6. Detailed Methodology – Task 1\\\\ndoc.add_page_break()\\\\nh1 = doc.add_heading(\\'6. Detailed Methodology – Task 1: Project Initiation, Data Review, and Planning\\', level=1)\\\\n\\\\np = doc.add_paragraph(\\\\n    \\'Task 1 establishes the technical and governance foundation for the SSES. We will conduct a \\'\\\\n    \\'formal kickoff meeting with NFWB to confirm scope, deliverables, and success criteria; review \\'\\\\n    \\'the Consent Order and revised work schedule; and finalize the project communication and \\'\\\\n    \\'safety expectations (REQ-001, REQ-003, REQ-004, REQ-005, REQ-010, REQ-015, REQ-019, \\'\\\\n    \\'REQ-027, REQ-049).\\'\\\\n)\\\\n\\\\np = doc.add_paragraph(\\\\n    \\'Our team will compile and review available records, including prior SSES reports, SCADA \\'\\\\n    \\'data, flow monitoring results, CCTV and manhole inspection reports, maintenance logs, and \\'\\\\n    \\'NYSDEC correspondence related to LaSalle SSO abatement. We will use structured data \\'\\\\n    \\'checklists and GIS mapping to identify gaps and prioritize any additional data collection.\\'\\\\n)\\\\n\\\\n# Task 1 sequence diagram\\\\nmermaid_code_t1 = \\'\\'\\'\\\\nsequenceDiagram\\\\n  participant NFWB\\\\n  participant PM\\\\n  participant Eng\\\\n  NFWB->>PM: Provide existing data and Consent Order\\\\n  PM->>Eng: Distribute data and assign reviews\\\\n  Eng->>PM: Summaries and data gaps\\\\n  PM->>NFWB: Planning workshop and confirmation of priorities\\\\n\\'\\'\\'\\\\nseq_t1_path = render_mermaid(mermaid_code_t1, \\'task1_sequence\\')\\\\ndoc.add_picture(str(seq_t1_path), width=Inches(5.8))\\\\nfigure_counter[\\'n\\'] += 1\\\\nadd_caption(f\\\\\"Figure {figure_counter[\\'n\\']}: Task 1 initiation and planning interactions\\\\\")\\\\n\\\\n# SCADA flow vs rainfall illustrative chart\\\\ndates = pd.date_range(start=\\'2022-03-01\\', periods=14, freq=\\'D\\')\\\\nflow = [4.2, 4.1, 4.3, 5.0, 5.5, 4.6, 4.3, 4.2, 5.1, 5.6, 4.5, 4.3, 4.2, 4.1]\\\\nrain = [0.0, 0.0, 0.1, 0.8, 1.2, 0.0, 0.0, 0.0, 0.6, 1.0, 0.0, 0.0, 0.0, 0.0]\\\\n\\\\ndf_scada = pd.DataFrame({\\'Date\\': dates, \\'Flow MGD\\': flow, \\'Rainfall inches\\': rain})\\\\nfig, ax1 = plt.subplots(figsize=(7, 4))\\\\ncolor_flow = \\'#4c72b0\\'\\\\ncolor_rain = \\'#dd8452\\'\\\\nax1.plot(df_scada[\\'Date\\'], df_scada[\\'Flow MGD\\'], color=color_flow, marker=\\'o\\')\\\\nax1.set_xlabel(\\'Date\\')\\\\nax1.set_ylabel(\\'Flow (MGD)\\', color=color_flow)\\\\nax1.tick_params(axis=\\'y\\', labelcolor=color_flow)\\\\nax2 = ax1.twinx()\\\\nax2.bar(df_scada[\\'Date\\'], df_scada[\\'Rainfall inches\\'], color=color_rain, alpha=0.4)\\\\nax2.set_ylabel(\\'Rainfall (inches)\\', color=color_rain)\\\\nax2.tick_params(axis=\\'y\\', labelcolor=color_rain)\\\\nplt.title(\\'Illustrative SCADA flow and rainfall response\\')\\\\nfig.autofmt_xdate(rotation=45)\\\\nplt.tight_layout()\\\\nscada_chart_path = output_dir / \\'scada_flow_rain.png\\'\\\\nplt.savefig(scada_chart_path, dpi=150, bbox_inches=\\'tight\\', facecolor=\\'white\\')\\\\nplt.close()\\\\n\\\\ndoc.add_picture(str(scada_chart_path), width=Inches(5.8))\\\\nfigure_counter[\\'n\\'] += 1\\\\nadd_caption(f\\\\\"Figure {figure_counter[\\'n\\']}: Example analysis of SCADA flow response to rainfall\\\\\")\\\\n\\\\n# Task 1 data checklist table\\\\ntable = doc.add_table(rows=1, cols=3)\\\\ntable.style = \\'Table Grid\\'\\\\ntable.alignment = WD_TABLE_ALIGNMENT.CENTER\\\\nhdr = table.rows[0].cells\\\\nhdr[0].text = \\'Data source\\'\\\\nhdr[1].text = \\'Description\\'\\\\nhdr[2].text = \\'Use in SSES\\'\\\\nfor cell in hdr:\\\\n    for run in cell.paragraphs[0].runs:\\\\n        run.bold = True\\\\n\\\\nrows = [\\\\n    (\\'Consent Order and NYSDEC correspondence\\', \\'Order on Consent R9020080528-32 and related letters.\\', \\'Define regulatory context, milestones, and reporting expectations (REQ-003, REQ-049).\\'),\\\\n    (\\'Previous SSES reports\\', \\'Any prior I&I studies in LaSalle or related sewersheds.\\', \\'Leverage past findings and avoid duplication.\\'),\\\\n    (\\'SCADA and flow data\\', \\'Pump station flows, wet-weather trends, alarms.\\', \\'Understand system response and target monitoring (REQ-004, REQ-010).\\'),\\\\n    (\\'CCTV and manhole reports\\', \\'Existing condition assessments for mains and structures.\\', \\'Identify structural and I&I defects and data gaps (REQ-015).\\'),\\\\n    (\\'Maintenance and repair history\\', \\'Work orders, lining projects, spot repairs.\\', \\'Account for completed work and residual issues.\\'),\\\\n]\\\\n\\\\nfor row in rows:\\\\n    cells = table.add_row().cells\\\\n    for i, val in enumerate(row):\\\\n        cells[i].text = val\\\\n\\\\n# 7. Detailed Methodology – Task 2: Smoke Testing Program\\\\ndoc.add_page_break()\\\\nh1 = doc.add_heading(\\'7. Detailed Methodology – Task 2: Smoke Testing Program\\', level=1)\\\\n\\\\np = doc.add_paragraph(\\\\n    \\'Smoke testing is a core tool for identifying inflow sources such as cross-connections, roof \\'\\\\n    \\'leaders, and defective cleanouts. Aurelia will provide all staff, equipment, and materials needed \\'\\\\n    \\'to conduct smoke testing in the Phase 1 sewersheds (REQ-001, REQ-004, REQ-007). We will \\'\\\\n    \\'implement a robust public notification and safety program, including door hangers 2–4 days \\'\\\\n    \\'before testing, assistance with NFWB press releases, and coordination with police and fire \\'\\\\n    \\'officials (REQ-008, REQ-033, REQ-034).\\'\\\\n)\\\\n\\\\np = doc.add_paragraph(\\\\n    \\'Testing will be scheduled only during appropriate weather conditions to ensure meaningful \\'\\\\n    \\'results and minimize nuisance impacts. All observed defects will be documented and \\'\\\\n    \\'photographed with GIS-referenced locations for integration into the defect database and \\'\\\\n    \\'Corrective Action Plan (REQ-009).\\'\\\\n)\\\\n\\\\n# Smoke testing workflow Mermaid diagram\\\\nmermaid_code_smoke = \\'\\'\\'\\\\nflowchart LR\\\\n  P[Plan smoke testing] --> N[Notify residents and agencies]\\\\n  N --> F[Field setup and safety briefing]\\\\n  F --> T[Conduct smoke testing]\\\\n  T --> D[Document and photograph defects]\\\\n  D --> G[Update GIS and defect database]\\\\n\\'\\'\\'\\\\nsmoke_diagram_path = render_mermaid(mermaid_code_smoke, \\'smoke_workflow\\')\\\\ndoc.add_picture(str(smoke_diagram_path), width=Inches(5.8))\\\\nfigure_counter[\\'n\\'] += 1\\\\nadd_caption(f\\\\\"Figure {figure_counter[\\'n\\']}: Smoke testing workflow from planning to documentation\\\\\")\\\\n\\\\n# Smoke testing segments bar chart\\\\nplt.figure(figsize=(6, 4))\\\\nsegments_data = pd.DataFrame({\\\\n    \\'Sewershed\\': [\\'LaSalle A\\', \\'LaSalle B\\', \\'LaSalle C\\', \\'LaSalle D\\'],\\\\n    \\'Segments planned\\': [85, 70, 60, 55]\\\\n})\\\\nax = sns.barplot(data=segments_data, x=\\'Sewershed\\', y=\\'Segments planned\\', color=\\'#4c72b0\\')\\\\nax.set_title(\\'Illustrative smoke testing segments by sewershed\\')\\\\nax.set_ylabel(\\'Number of segments\\')\\\\nplt.tight_layout()\\\\nsmoke_chart_path = output_dir / \\'smoke_segments.png\\'\\\\nplt.savefig(smoke_chart_path, dpi=150, bbox_inches=\\'tight\\', facecolor=\\'white\\')\\\\nplt.close()\\\\n\\\\ndoc.add_picture(str(smoke_chart_path), width=Inches(5.8))\\\\nfigure_counter[\\'n\\'] += 1\\\\nadd_caption(f\\\\\"Figure {figure_counter[\\'n\\']}: Illustrative smoke testing coverage by sewershed\\\\\")\\\\n\\\\n# Notification plan table\\\\ntable = doc.add_table(rows=1, cols=4)\\\\ntable.style = \\'Table Grid\\'\\\\ntable.alignment = WD_TABLE_ALIGNMENT.CENTER\\\\nhdr = table.rows[0].cells\\\\nhdr[0].text = \\'Audience\\'\\\\nhdr[1].text = \\'Notification method\\'\\\\nhdr[2].text = \\'Timing\\'\\\\nhdr[3].text = \\'Key content\\'\\\\nfor cell in hdr:\\\\n    for run in cell.paragraphs[0].runs:\\\\n        run.bold = True\\\\n\\\\nrows = [\\\\n    (\\'Residents and businesses\\', \\'Hand-delivered door hangers.\\', \\'2–4 days before testing (REQ-008).\\', \\'Purpose of testing, safety information, contact details.\\'),\\\\n    (\\'Police and fire\\', \\'Email and phone coordination.\\', \\'At least 3 days before and day-of reminder.\\', \\'Schedule, locations, and emergency contact protocol.\\'),\\\\n    (\\'NFWB communications team\\', \\'Draft press release and FAQs.\\', \\'One week before testing.\\', \\'Plain-language explanation and key messages.\\'),\\\\n]\\\\n\\\\nfor row in rows:\\\\n    cells = table.add_row().cells\\\\n    for i, val in enumerate(row):\\\\n        cells[i].text = val\\\\n\\\\n# Equipment and staffing table\\\\ntable = doc.add_table(rows=1, cols=4)\\\\ntable.style = \\'Table Grid\\'\\\\ntable.alignment = WD_TABLE_ALIGNMENT.CENTER\\\\nhdr = table.rows[0].cells\\\\nhdr[0].text = \\'Role / equipment\\'\\\\nhdr[1].text = \\'Quantity\\'\\\\nhdr[2].text = \\'Key responsibilities\\'\\\\nhdr[3].text = \\'Safety considerations\\'\\\\nfor cell in hdr:\\\\n    for run in cell.paragraphs[0].runs:\\\\n        run.bold = True\\\\n\\\\nrows = [\\\\n    (\\'Field supervisor\\', \\'1\\', \\'Oversee daily operations and safety.\\', \\'Ensures adherence to H&S Plan (REQ-033, REQ-034).\\'),\\\\n    (\\'Smoke testing technicians\\', \\'3–4\\', \\'Set up blowers, inject smoke, observe defects.\\', \\'Use PPE and follow traffic control procedures.\\'),\\\\n    (\\'Blowers and smoke generators\\', \\'2–3\\', \\'Provide visible smoke in sewer mains.\\', \\'Proper placement and monitoring to avoid nuisance.\\'),\\\\n    (\\'Vehicle and traffic control devices\\', \\'1 truck, cones, signs\\', \\'Safe access to manholes in streets.\\', \\'Comply with MUTCD and local requirements.\\'),\\\\n]\\\\n\\\\nfor row in rows:\\\\n    cells = table.add_row().cells\\\\n    for i, val in enumerate(row):\\\\n        cells[i].text = val\\\\n\\\\n# 8. Detailed Methodology – Task 3: Flow Isolation and Measurement\\\\ndoc.add_page_break()\\\\nh1 = doc.add_heading(\\'8. Detailed Methodology – Task 3: Flow Isolation and Measurement\\', level=1)\\\\n\\\\np = doc.add_paragraph(\\\\n    \\'Flow isolation and night-time weiring will quantify groundwater infiltration and guide targeted \\'\\\\n    \\'corrective actions. Before installing weirs, we will review prior flow measurement and analysis \\'\\\\n    \\'for each relevant sewershed (REQ-010) and work with NFWB staff to select adequate \\'\\\\n    \\'locations and number of weirs to support accurate infiltration analysis (REQ-011).\\'\\\\n)\\\\n\\\\np = doc.add_paragraph(\\\\n    \\'Aurelia will provide all staff, equipment, and materials necessary for flow isolation and \\'\\\\n    \\'measurement, including traffic control and confined space entry-trained personnel and \\'\\\\n    \\'equipment (REQ-012, REQ-033, REQ-034). Residents will be notified in advance of any \\'\\\\n    \\'disruptive night work via door hangers and coordination with NFWB’s communications team \\'\\\\n    \\'(REQ-013). We will calculate infiltration in gallons per day per linear foot (gpd/lf) for each \\'\\\\n    \\'weiring section and integrate these results with CCTV and smoke testing findings (REQ-014).\\'\\\\n)\\\\n\\\\n# Flow isolation process Mermaid diagram\\\\nmermaid_code_flow = \\'\\'\\'\\\\nflowchart LR\\\\n  R[Review prior flow data] --> S[Select weir locations]\\\\n  S --> P[Plan night work and notifications]\\\\n  P --> I[Install weirs and measure flow]\\\\n  I --> C[Calculate infiltration gpd per lf]\\\\n  C --> U[Update hydraulic analysis and CAP]\\\\n\\'\\'\\'\\\\nflow_diagram_path = render_mermaid(mermaid_code_flow, \\'flow_isolation_process\\')\\\\ndoc.add_picture(str(flow_diagram_path), width=Inches(5.8))\\\\nfigure_counter[\\'n\\'] += 1\\\\nadd_caption(f\\\\\"Figure {figure_counter[\\'n\\']}: Flow isolation and weiring process\\\\\")\\\\n\\\\n# Infiltration results template chart\\\\nsections = [\\'Section 1\\', \\'Section 2\\', \\'Section 3\\', \\'Section 4\\']\\\\ninfiltration = [1200, 800, 600, 1500]\\\\nplt.figure(figsize=(6, 4))\\\\ninf_data = pd.DataFrame({\\'Weir section\\': sections, \\'Infiltration gpd per lf\\': infiltration})\\\\nax = sns.barplot(data=inf_data, x=\\'Weir section\\', y=\\'Infiltration gpd per lf\\', color=\\'#55a868\\')\\\\nax.set_title(\\'Illustrative infiltration rates by weir section\\')\\\\nax.set_ylabel(\\'Infiltration (gpd/lf)\\')\\\\nplt.tight_layout()\\\\ninf_chart_path = output_dir / \\'infiltration_rates.png\\'\\\\nplt.savefig(inf_chart_path, dpi=150, bbox_inches=\\'tight\\', facecolor=\\'white\\')\\\\nplt.close()\\\\n\\\\ndoc.add_picture(str(inf_chart_path), width=Inches(5.8))\\\\nfigure_counter[\\'n\\'] += 1\\\\nadd_caption(f\\\\\"Figure {figure_counter[\\'n\\']}: Example presentation of infiltration results by section\\\\\")\\\\n\\\\n# Flow isolation results table template\\\\ntable = doc.add_table(rows=1, cols=5)\\\\ntable.style = \\'Table Grid\\'\\\\ntable.alignment = WD_TABLE_ALIGNMENT.CENTER\\\\nhdr = table.rows[0].cells\\\\nhdr[0].text = \\'Location ID\\'\\\\nhdr[1].text = \\'Conditions\\'\\\\nhdr[2].text = \\'Measured flow (gpm)\\'\\\\nhdr[3].text = \\'Infiltration (gpd/lf)\\'\\\\nhdr[4].text = \\'Notes\\'\\\\nfor cell in hdr:\\\\n    for run in cell.paragraphs[0].runs:\\\\n        run.bold = True\\\\n\\\\nrows = [\\\\n    (\\'FI-01\\', \\'Dry weather, stable groundwater.\\', \\'12\\', \\'1,200\\', \\'High infiltration, candidate for lining.\\'),\\\\n    (\\'FI-02\\', \\'Dry weather, low groundwater.\\', \\'6\\', \\'600\\', \\'Moderate infiltration, monitor after repairs upstream.\\'),\\\\n]\\\\n\\\\nfor row in rows:\\\\n    cells = table.add_row().cells\\\\n    for i, val in enumerate(row):\\\\n        cells[i].text = val\\\\n\\\\n# 9. Detailed Methodology – Task 4: CCTV and Manhole Report Review\\\\ndoc.add_page_break()\\\\nh1 = doc.add_heading(\\'9. Detailed Methodology – Task 4: CCTV and Manhole Report Review\\', level=1)\\\\n\\\\np = doc.add_paragraph(\\\\n    \\'Task 4 leverages existing CCTV and manhole inspection data provided by NFWB to \\'\\\\n    \\'characterize structural and I&I-related defects and identify data gaps (REQ-001, REQ-003, \\'\\\\n    \\'REQ-004, REQ-015, REQ-018, REQ-033). Aurelia will ingest digital CCTV footage and reports, \\'\\\\n    \\'standardize defect coding, and integrate results into a GIS-based asset and defect database.\\'\\\\n)\\\\n\\\\np = doc.add_paragraph(\\\\n    \\'We will coordinate with NFWB to understand repairs already completed, confirm access to \\'\\\\n    \\'footage, and prioritize any additional CCTV needed under Task 6 focused SSES. This ensures \\'\\\\n    \\'that the Corrective Action Plan reflects current conditions and avoids recommending repairs \\'\\\\n    \\'that have already been addressed.\\'\\\\n)\\\\n\\\\n# Data flow Mermaid diagram for CCTV\\\\nmermaid_code_cctv = \\'\\'\\'\\\\nflowchart LR\\\\n  C1[CCTV footage and reports] --> P1[Review and code defects]\\\\n  P1 --> G1[GIS and database]\\\\n  G1 --> A1[Analysis and prioritization]\\\\n  A1 --> R1[Corrective Action Plan]\\\\n\\'\\'\\'\\\\ncctv_diagram_path = render_mermaid(mermaid_code_cctv, \\'cctv_data_flow\\')\\\\ndoc.add_picture(str(cctv_diagram_path), width=Inches(5.8))\\\\nfigure_counter[\\'n\\'] += 1\\\\nadd_caption(f\\\\\"Figure {figure_counter[\\'n\\']}: CCTV and manhole data integration workflow\\\\\")\\\\n\\\\n# Defect distribution bar chart\\\\nplt.figure(figsize=(6, 4))\\\\ndefect_data = pd.DataFrame({\\\\n    \\'Defect type\\': [\\'Structural\\', \\'I&I related\\', \\'Maintenance\\', \\'Other\\'],\\\\n    \\'Count\\': [120, 95, 60, 15]\\\\n})\\\\nax = sns.barplot(data=defect_data, x=\\'Defect type\\', y=\\'Count\\', color=\\'#4c72b0\\')\\\\nax.set_title(\\'Illustrative distribution of defect types\\')\\\\nax.set_ylabel(\\'Number of defects\\')\\\\nplt.tight_layout()\\\\ndefect_chart_path = output_dir / \\'defect_distribution.png\\'\\\\nplt.savefig(defect_chart_path, dpi=150, bbox_inches=\\'tight\\', facecolor=\\'white\\')\\\\nplt.close()\\\\n\\\\ndoc.add_picture(str(defect_chart_path), width=Inches(5.8))\\\\nfigure_counter[\\'n\\'] += 1\\\\nadd_caption(f\\\\\"Figure {figure_counter[\\'n\\']}: Example distribution of CCTV-identified defects\\\\\")\\\\n\\\\n# Defect summary table\\\\ntable = doc.add_table(rows=1, cols=5)\\\\ntable.style = \\'Table Grid\\'\\\\ntable.alignment = WD_TABLE_ALIGNMENT.CENTER\\\\nhdr = table.rows[0].cells\\\\nhdr[0].text = \\'Segment / manhole ID\\'\\\\nhdr[1].text = \\'Defect type\\'\\\\nhdr[2].text = \\'Severity\\'\\\\nhdr[3].text = \\'Recommended action\\'\\\\nhdr[4].text = \\'Notes\\'\\\\nfor cell in hdr:\\\\n    for run in cell.paragraphs[0].runs:\\\\n        run.bold = True\\\\n\\\\nrows = [\\\\n    (\\'MH-101\\', \\'I&I at frame and cover\\', \\'High\\', \\'Raise and seal frame, replace cover.\\', \\'Near low-lying area with ponding.\\'),\\\\n    (\\'SEG-205\\', \\'Longitudinal crack\\', \\'Medium\\', \\'Monitor and consider lining with adjacent segments.\\', \\'Coordinate with infiltration data.\\'),\\\\n]\\\\n\\\\nfor row in rows:\\\\n    cells = table.add_row().cells\\\\n    for i, val in enumerate(row):\\\\n        cells[i].text = val\\\\n\\\\n# Additional CCTV needs table\\\\ntable = doc.add_table(rows=1, cols=4)\\\\ntable.style = \\'Table Grid\\'\\\\ntable.alignment = WD_TABLE_ALIGNMENT.CENTER\\\\nhdr = table.rows[0].cells\\\\nhdr[0].text = \\'Area\\'\\\\nhdr[1].text = \\'Reason for additional CCTV\\'\\\\nhdr[2].text = \\'Estimated effort\\'\\\\nhdr[3].text = \\'Coordination with NFWB crews\\'\\\\nfor cell in hdr:\\\\n    for run in cell.paragraphs[0].runs:\\\\n        run.bold = True\\\\n\\\\nrows = [\\\\n    (\\'LaSalle B subcatchment 2\\', \\'No recent CCTV and high infiltration from Task 3.\\', \\'2 days.\\', \\'Schedule with NFWB CCTV crew under Task 6.\\'),\\\\n]\\\\n\\\\nfor row in rows:\\\\n    cells = table.add_row().cells\\\\n    for i, val in enumerate(row):\\\\n        cells[i].text = val\\\\n\\\\n# 10. Detailed Methodology – Task 5: Outfall/SSO Condition Assessment\\\\ndoc.add_page_break()\\\\nh1 = doc.add_heading(\\'10. Detailed Methodology – Task 5: Outfall/SSO Condition Assessment\\', level=1)\\\\n\\\\np = doc.add_paragraph(\\\\n    \\'Task 5 focuses on understanding the condition and performance of the two Phase 1 outfalls \\'\\\\n    \\'and their relationship to Phase 1 and Phase 3 sewersheds (REQ-001, REQ-004, REQ-016, \\'\\\\n    \\'REQ-017, REQ-050). We will review existing information for outfalls 013, 014, and 017, \\'\\\\n    \\'conduct site visits to confirm physical conditions, and develop an Outfall/SSO Work Plan in \\'\\\\n    \\'coordination with NFWB.\\'\\\\n)\\\\n\\\\np = doc.add_paragraph(\\\\n    \\'The Work Plan may include temporary flow meters, rain gauges, dye testing, and coordination \\'\\\\n    \\'for additional CCTV as needed. Upon NFWB authorization, we will execute the Work Plan and \\'\\\\n    \\'document findings in GIS-compatible format, including recommendations for reducing \\'\\\\n    \\'extraneous flows and mitigating SSOs (REQ-017).\\'\\\\n)\\\\n\\\\n# Outfall assessment workflow Mermaid diagram\\\\nmermaid_code_outfall = \\'\\'\\'\\\\nflowchart LR\\\\n  O1[Review outfall records] --> O2[Site visits and condition checks]\\\\n  O2 --> O3[Develop Outfall SSO Work Plan]\\\\n  O3 --> O4[Install meters and collect data]\\\\n  O4 --> O5[Analyze flows and rainfall]\\\\n  O5 --> O6[Recommend outfall improvements]\\\\n\\'\\'\\'\\\\noutfall_diagram_path = render_mermaid(mermaid_code_outfall, \\'outfall_workflow\\')\\\\ndoc.add_picture(str(outfall_diagram_path), width=Inches(5.8))\\\\nfigure_counter[\\'n\\'] += 1\\\\nadd_caption(f\\\\\"Figure {figure_counter[\\'n\\']}: Outfall and SSO condition assessment workflow\\\\\")\\\\n\\\\n# Outfall inventory table\\\\ntable = doc.add_table(rows=1, cols=5)\\\\ntable.style = \\'Table Grid\\'\\\\ntable.alignment = WD_TABLE_ALIGNMENT.CENTER\\\\nhdr = table.rows[0].cells\\\\nhdr[0].text = \\'Outfall ID\\'\\\\nhdr[1].text = \\'Location description\\'\\\\nhdr[2].text = \\'Current condition (illustrative)\\'\\\\nhdr[3].text = \\'Associated sewersheds\\'\\\\nhdr[4].text = \\'Consent Order relevance\\'\\\\nfor cell in hdr:\\\\n    for run in cell.paragraphs[0].runs:\\\\n        run.bold = True\\\\n\\\\nrows = [\\\\n    (\\'013\\', \\'LaSalle area outfall to receiving water.\\', \\'Operational, evidence of surcharge.\\', \\'LaSalle A, LaSalle B.\\', \\'Key SSO location under Consent Order (REQ-050).\\'),\\\\n    (\\'014\\', \\'Downstream outfall near commercial corridor.\\', \\'Operational, minor debris.\\', \\'LaSalle B.\\', \\'Supports R-value-based prioritization.\\'),\\\\n    (\\'017\\', \\'Outfall serving Phase 1 and Phase 3 areas.\\', \\'Operational, subject to high flows.\\', \\'LaSalle C, Phase 3 sewersheds.\\', \\'Critical to long-term LaSalle strategy.\\'),\\\\n]\\\\n\\\\nfor row in rows:\\\\n    cells = table.add_row().cells\\\\n    for i, val in enumerate(row):\\\\n        cells[i].text = val\\\\n\\\\n# Work Plan summary table\\\\ntable = doc.add_table(rows=1, cols=4)\\\\ntable.style = \\'Table Grid\\'\\\\ntable.alignment = WD_TABLE_ALIGNMENT.CENTER\\\\nhdr = table.rows[0].cells\\\\nhdr[0].text = \\'Work Plan element\\'\\\\nhdr[1].text = \\'Purpose\\'\\\\nhdr[2].text = \\'Trigger\\'\\\\nhdr[3].text = \\'Notes\\'\\\\nfor cell in hdr:\\\\n    for run in cell.paragraphs[0].runs:\\\\n        run.bold = True\\\\n\\\\nrows = [\\\\n    (\\'Temporary flow meters\\', \\'Measure outfall discharge under various conditions.\\', \\'Evidence of unexplained SSOs or high flows.\\', \\'Sized and installed per manufacturer guidance.\\'),\\\\n    (\\'Rain gauges\\', \\'Correlate rainfall with outfall response.\\', \\'Needed to refine R-values or validate models.\\', \\'Prefer co-location with existing gauges.\\'),\\\\n    (\\'Dye testing\\', \\'Confirm suspected cross-connections.\\', \\'Indications from smoke testing or CCTV.\\', \\'Conducted with NFWB approval and safety controls.\\'),\\\\n]\\\\n\\\\nfor row in rows:\\\\n    cells = table.add_row().cells\\\\n    for i, val in enumerate(row):\\\\n        cells[i].text = val\\\\n\\\\n# 11. Detailed Methodology – Task 6: Focused SSES (Contingency)\\\\ndoc.add_page_break()\\\\nh1 = doc.add_heading(\\'11. Detailed Methodology – Task 6: Focused SSES (Contingency)\\', level=1)\\\\n\\\\np = doc.add_paragraph(\\\\n    \\'Task 6 provides a structured mechanism to resolve uncertainties and confirm specific I&I \\'\\\\n    \\'sources using a $10,000 contingency budget (REQ-001, REQ-004, REQ-018, REQ-027, \\'\\\\n    \\'REQ-028, REQ-033). Aurelia will only use this contingency with explicit NFWB approval, \\'\\\\n    \\'based on documented triggers from Tasks 2–5.\\'\\\\n)\\\\n\\\\np = doc.add_paragraph(\\\\n    \\'Focused SSES activities may include dye testing of suspected cross-connections, house \\'\\\\n    \\'inspections for improper connections, and additional CCTV via NFWB crews. Each activity \\'\\\\n    \\'will be scoped, estimated, and approved before execution, with results integrated into the \\'\\\\n    \\'overall defect database and Corrective Action Plan.\\'\\\\n)\\\\n\\\\n# Decision tree Mermaid diagram\\\\nmermaid_code_focus = \\'\\'\\'\\\\nflowchart TD\\\\n  F0[Findings from Tasks 2 to 5] --> Q1[Is source location uncertain]\\\\n  Q1 -->|Yes| A1[Define focused SSES activity]\\\\n  A1 --> A2[Estimate effort and cost]\\\\n  A2 --> A3[NFWB approval]\\\\n  A3 -->|Approved| A4[Execute focused SSES]\\\\n  A4 --> A5[Update findings and CAP]\\\\n  Q1 -->|No| A6[No focused SSES needed]\\\\n\\'\\'\\'\\\\nfocus_diagram_path = render_mermaid(mermaid_code_focus, \\'focused_sses_decision\\')\\\\ndoc.add_picture(str(focus_diagram_path), width=Inches(5.8))\\\\nfigure_counter[\\'n\\'] += 1\\\\nadd_caption(f\\\\\"Figure {figure_counter[\\'n\\']}: Decision process for using focused SSES contingency\\\\\")\\\\n\\\\n# Contingency tracking table\\\\ntable = doc.add_table(rows=1, cols=5)\\\\ntable.style = \\'Table Grid\\'\\\\ntable.alignment = WD_TABLE_ALIGNMENT.CENTER\\\\nhdr = table.rows[0].cells\\\\nhdr[0].text = \\'Activity\\'\\\\nhdr[1].text = \\'Estimated hours\\'\\\\nhdr[2].text = \\'Estimated cost\\'\\\\nhdr[3].text = \\'Approval status\\'\\\\nhdr[4].text = \\'Notes\\'\\\\nfor cell in hdr:\\\\n    for run in cell.paragraphs[0].runs:\\\\n        run.bold = True\\\\n\\\\nrows = [\\\\n    (\\'Dye testing in LaSalle B subcatchment 2\\', \\'16\\', \\'$3,200\\', \\'To be approved by NFWB.\\', \\'Triggered by high infiltration and limited CCTV.\\'),\\\\n]\\\\n\\\\nfor row in rows:\\\\n    cells = table.add_row().cells\\\\n    for i, val in enumerate(row):\\\\n        cells[i].text = val\\\\n\\\\n# 12. Detailed Methodology – Task 7: SSES Engineering Report and Corrective Action Plan\\\\ndoc.add_page_break()\\\\nh1 = doc.add_heading(\\'12. Detailed Methodology – Task 7: SSES Engineering Report and Corrective Action Plan\\', level=1)\\\\n\\\\np = doc.add_paragraph(\\\\n    \\'Task 7 culminates in an SSES Engineering Report and Corrective Action Plan (CAP) that \\'\\\\n    \\'meet NYSDEC requirements and the Engineering Report Outline dated October 1, 2022 \\'\\\\n    \\'(REQ-001, REQ-003, REQ-014, REQ-015, REQ-016, REQ-017, REQ-018, REQ-019, REQ-020, \\'\\\\n    \\'REQ-021, REQ-027, REQ-028, REQ-049, REQ-050). The report will be prepared, stamped, and \\'\\\\n    \\'dated by a New York State licensed Professional Engineer (REQ-021).\\'\\\\n)\\\\n\\\\np = doc.add_paragraph(\\\\n    \\'We will synthesize findings from Tasks 1–6 into a transparent set of recommendations, \\'\\\\n    \\'prioritized by I&I reduction per dollar invested, constructability, and alignment with Consent \\'\\\\n    \\'Order milestones. Budgetary costs and implementation timelines will be developed for each \\'\\\\n    \\'project, with a clear bar-chart schedule to enable construction in 2023–early 2024 and \\'\\\\n    \\'post-construction monitoring by June 2024 (REQ-019, REQ-020).\\'\\\\n)\\\\n\\\\n# Dependency diagram Mermaid\\\\nmermaid_code_report = \\'\\'\\'\\\\nflowchart TD\\\\n  D1[Task 1 data review] --> RPT[SSES report and CAP]\\\\n  D2[Task 2 smoke testing] --> RPT\\\\n  D3[Task 3 flow isolation] --> RPT\\\\n  D4[Task 4 CCTV review] --> RPT\\\\n  D5[Task 5 outfall assessment] --> RPT\\\\n  D6[Task 6 focused SSES] --> RPT\\\\n\\'\\'\\'\\\\nreport_diagram_path = render_mermaid(mermaid_code_report, \\'report_dependencies\\')\\\\ndoc.add_picture(str(report_diagram_path), width=Inches(5.8))\\\\nfigure_counter[\\'n\\'] += 1\\\\nadd_caption(f\\\\\"Figure {figure_counter[\\'n\\']}: Data dependencies feeding the SSES report and CAP\\\\\")\\\\n\\\\n# Corrective actions ranking chart\\\\nactions = [\\'Lining mains\\', \\'Manhole rehab\\', \\'Private inflow removal\\', \\'Targeted repairs\\']\\\\nreduction_per_dollar = [1.8, 1.2, 2.1, 1.0]\\\\nplt.figure(figsize=(6, 4))\\\\nca_data = pd.DataFrame({\\'Action\\': actions, \\'I&I reduction per 1000 dollars\\': reduction_per_dollar})\\\\nax = sns.barplot(data=ca_data, x=\\'Action\\', y=\\'I&I reduction per 1000 dollars\\', color=\\'#4c72b0\\')\\\\nax.set_title(\\'Illustrative I&I reduction per 1,000 dollars invested\\')\\\\nax.set_ylabel(\\'Reduction (MGD per 1,000 dollars)\\')\\\\nplt.tight_layout()\\\\nca_chart_path = output_dir / \\'corrective_action_value.png\\'\\\\nplt.savefig(ca_chart_path, dpi=150, bbox_inches=\\'tight\\', facecolor=\\'white\\')\\\\nplt.close()\\\\n\\\\ndoc.add_picture(str(ca_chart_path), width=Inches(5.8))\\\\nfigure_counter[\\'n\\'] += 1\\\\nadd_caption(f\\\\\"Figure {figure_counter[\\'n\\']}: Example ranking of corrective actions by I&I reduction per dollar\\\\\")\\\\n\\\\n# Corrective action matrix table\\\\ntable = doc.add_table(rows=1, cols=6)\\\\ntable.style = \\'Table Grid\\'\\\\ntable.alignment = WD_TABLE_ALIGNMENT.CENTER\\\\nhdr = table.rows[0].cells\\\\nhdr[0].text = \\'Defect / location\\'\\\\nhdr[1].text = \\'Recommended fix\\'\\\\nhdr[2].text = \\'Estimated cost\\'\\\\nhdr[3].text = \\'Expected I&I reduction\\'\\\\nhdr[4].text = \\'Priority\\'\\\\nhdr[5].text = \\'Implementation window\\'\\\\nfor cell in hdr:\\\\n    for run in cell.paragraphs[0].runs:\\\\n        run.bold = True\\\\n\\\\nrows = [\\\\n    (\\'High infiltration in SEG-205\\', \\'CIPP lining of 400 lf.\\', \\'$220,000\\', \\'0.25 MGD.\\', \\'High.\\', \\'2023 construction.\\'),\\\\n    (\\'I&I at MH-101\\', \\'Frame and cover raising and sealing.\\', \\'$15,000\\', \\'0.05 MGD.\\', \\'Medium.\\', \\'2023 construction.\\'),\\\\n]\\\\n\\\\nfor row in rows:\\\\n    cells = table.add_row().cells\\\\n    for i, val in enumerate(row):\\\\n        cells[i].text = val\\\\n\\\\n# Implementation schedule table\\\\ntable = doc.add_table(rows=1, cols=4)\\\\ntable.style = \\'Table Grid\\'\\\\ntable.alignment = WD_TABLE_ALIGNMENT.CENTER\\\\nhdr = table.rows[0].cells\\\\nhdr[0].text = \\'Milestone\\'\\\\nhdr[1].text = \\'Target date\\'\\\\nhdr[2].text = \\'Dependency\\'\\\\nhdr[3].text = \\'Notes\\'\\\\nfor cell in hdr:\\\\n    for run in cell.paragraphs[0].runs:\\\\n        run.bold = True\\\\n\\\\nrows = [\\\\n    (\\'Draft SSES report to NFWB\\', \\'January 2023\\', \\'Completion of Tasks 1–6.\\', \\'Enables internal review.\\'),\\\\n    (\\'Final SSES report to NYSDEC\\', \\'March 2023\\', \\'NFWB review and revisions.\\', \\'Supports early NYSDEC review (REQ-020).\\'),\\\\n    (\\'Construction window\\', \\'Mid 2023–early 2024\\', \\'NYSDEC acceptance and funding.\\', \\'Implements high-priority projects.\\'),\\\\n]\\\\n\\\\nfor row in rows:\\\\n    cells = table.add_row().cells\\\\n    for i, val in enumerate(row):\\\\n        cells[i].text = val\\\\n\\\\n# 13. Detailed Methodology – Task 8: Post-Construction Monitoring and I&I Assessment\\\\ndoc.add_page_break()\\\\nh1 = doc.add_heading(\\'13. Detailed Methodology – Task 8: Post-Construction Monitoring and I&I Assessment\\', level=1)\\\\n\\\\np = doc.add_paragraph(\\\\n    \\'Task 8 verifies the effectiveness of the construction program through post-construction \\'\\\\n    \\'monitoring in 2024 (assuming 2023 construction) (REQ-001, REQ-004, REQ-020, REQ-022, \\'\\\\n    \\'REQ-027). Aurelia will design a monitoring plan that collects flow and rainfall data sufficient to \\'\\\\n    \\'compare pre- and post-construction conditions and normalize for rainfall variability.\\'\\\\n)\\\\n\\\\np = doc.add_paragraph(\\\\n    \\'We will prepare a Post-Construction I&I Assessment and Cost Analysis Report for NYSDEC \\'\\\\n    \\'documenting changes in base and wet-weather flows, confirming I&I reductions, and relating \\'\\\\n    \\'these outcomes to construction costs and Consent Order commitments.\\'\\\\n)\\\\n\\\\n# Monitoring timeline Mermaid diagram\\\\nmermaid_code_monitor = \\'\\'\\'\\\\nflowchart LR\\\\n  C1[Construction complete] --> M1[Post construction baseline monitoring]\\\\n  M1 --> M2[Wet weather monitoring]\\\\n  M2 --> M3[Data analysis and normalization]\\\\n  M3 --> M4[Post construction I and I report]\\\\n  M4 --> M5[NYSDEC review]\\\\n\\'\\'\\'\\\\nmonitor_diagram_path = render_mermaid(mermaid_code_monitor, \\'monitor_timeline\\')\\\\ndoc.add_picture(str(monitor_diagram_path), width=Inches(5.8))\\\\nfigure_counter[\\'n\\'] += 1\\\\nadd_caption(f\\\\\"Figure {figure_counter[\\'n\\']}: Post-construction monitoring and reporting timeline\\\\\")\\\\n\\\\n# Before/after flow comparison chart\\\\nperiods = [\\'Pre construction\\', \\'Post construction\\']\\\\nflows = [5.0, 3.5]\\\\nplt.figure(figsize=(5, 4))\\\\nba_data = pd.DataFrame({\\'Period\\': periods, \\'Average wet weather flow MGD\\': flows})\\\\nax = sns.barplot(data=ba_data, x=\\'Period\\', y=\\'Average wet weather flow MGD\\', color=\\'#4c72b0\\')\\\\nax.set_title(\\'Illustrative pre and post construction flow comparison\\')\\\\nax.set_ylabel(\\'Flow (MGD)\\')\\\\nplt.tight_layout()\\\\nba_chart_path = output_dir / \\'before_after_flow.png\\'\\\\nplt.savefig(ba_chart_path, dpi=150, bbox_inches=\\'tight\\', facecolor=\\'white\\')\\\\nplt.close()\\\\n\\\\ndoc.add_picture(str(ba_chart_path), width=Inches(4.5))\\\\nfigure_counter[\\'n\\'] += 1\\\\nadd_caption(f\\\\\"Figure {figure_counter[\\'n\\']}: Example pre- and post-construction flow comparison\\\\\")\\\\n\\\\n# Pre vs post I&I metrics table\\\\ntable = doc.add_table(rows=1, cols=5)\\\\ntable.style = \\'Table Grid\\'\\\\ntable.alignment = WD_TABLE_ALIGNMENT.CENTER\\\\nhdr = table.rows[0].cells\\\\nhdr[0].text = \\'Sewershed\\'\\\\nhdr[1].text = \\'Pre construction I&I (MGD)\\'\\\\nhdr[2].text = \\'Post construction I&I (MGD)\\'\\\\nhdr[3].text = \\'Reduction (MGD)\\'\\\\nhdr[4].text = \\'Cost effectiveness (MGD per million dollars)\\'\\\\nfor cell in hdr:\\\\n    for run in cell.paragraphs[0].runs:\\\\n        run.bold = True\\\\n\\\\nrows = [\\\\n    (\\'LaSalle A\\', \\'0.90\\', \\'0.55\\', \\'0.35\\', \\'0.70\\'),\\\\n    (\\'LaSalle B\\', \\'0.70\\', \\'0.45\\', \\'0.25\\', \\'0.60\\'),\\\\n]\\\\n\\\\nfor row in rows:\\\\n    cells = table.add_row().cells\\\\n    for i, val in enumerate(row):\\\\n        cells[i].text = val\\\\n\\\\n# 14. Schedule and Key Milestones\\\\ndoc.add_page_break()\\\\nh1 = doc.add_heading(\\'14. Schedule and Key Milestones\\', level=1)\\\\n\\\\np = doc.add_paragraph(\\\\n    \\'Our schedule is designed to deliver the Phase 1 SSES report in time for early 2023 NYSDEC \\'\\\\n    \\'review, support construction in 2023–early 2024, and complete post-construction monitoring by \\'\\\\n    \\'June 2024 (REQ-001, REQ-019, REQ-020, REQ-022, REQ-023, REQ-027, REQ-028). We use a \\'\\\\n    \\'bar-chart schedule to clearly represent task durations, overlaps, and critical path activities.\\'\\\\n)\\\\n\\\\n# Gantt chart using dates\\\\nschedule = pd.DataFrame({\\\\n    \\'Task\\': [\\\\n        \\'Task 1 initiation\\', \\'Task 2 smoke testing\\', \\'Task 3 flow isolation\\',\\\\n        \\'Task 4 CCTV review\\', \\'Task 5 outfall assessment\\', \\'Task 6 focused SSES\\',\\\\n        \\'Task 7 report and CAP\\', \\'Task 8 post construction monitoring\\'\\\\n    ],\\\\n    \\'Team\\': [\\\\n        \\'PM and analysts\\', \\'Field crews\\', \\'Field crews\\',\\\\n        \\'Analysts\\', \\'Field crews\\', \\'Field crews\\',\\\\n        \\'Engineers\\', \\'Engineers\\'\\\\n    ],\\\\n    \\'Start\\': pd.to_datetime([\\\\n        \\'2022-12-01\\', \\'2023-01-02\\', \\'2023-02-01\\',\\\\n        \\'2023-02-15\\', \\'2023-03-01\\', \\'2023-03-15\\',\\\\n        \\'2023-04-01\\', \\'2024-01-15\\'\\\\n    ]),\\\\n    \\'End\\': pd.to_datetime([\\\\n        \\'2022-12-31\\', \\'2023-02-15\\', \\'2023-03-10\\',\\\\n        \\'2023-03-31\\', \\'2023-03-31\\', \\'2023-04-15\\',\\\\n        \\'2023-06-30\\', \\'2024-06-15\\'\\\\n    ])\\\\n})\\\\n\\\\nproject_start = schedule[\\'Start\\'].min()\\\\nschedule[\\'days_to_start\\'] = (schedule[\\'Start\\'] - project_start).dt.days\\\\nschedule[\\'duration\\'] = (schedule[\\'End\\'] - schedule[\\'Start\\']).dt.days + 1\\\\n\\\\nteam_colors = {\\\\n    \\'PM and analysts\\': \\'#4c72b0\\',\\\\n    \\'Field crews\\': \\'#55a868\\',\\\\n    \\'Analysts\\': \\'#c44e52\\',\\\\n    \\'Engineers\\': \\'#8172b3\\'\\\\n}\\\\n\\\\nfig, ax = plt.subplots(figsize=(10, 5))\\\\nfor idx, row in schedule.iterrows():\\\\n    ax.barh(y=row[\\'Task\\'], width=row[\\'duration\\'], left=row[\\'days_to_start\\'],\\\\n            color=team_colors[row[\\'Team\\']], edgecolor=\\'white\\', linewidth=0.5)\\\\n\\\\nax.invert_yaxis()\\\\nmax_days = schedule[\\'days_to_start\\'].max() + schedule[\\'duration\\'].max()\\\\nxticks = np.arange(0, max_days + 30, 30)\\\\nxticklabels = pd.date_range(start=project_start, periods=len(xticks), freq=\\'30D\\').strftime(\\'%b %Y\\')\\\\nax.set_xticks(xticks[:len(xticklabels)])\\\\nax.set_xticklabels(xticklabels, fontsize=8)\\\\nax.set_xlabel(\\'Timeline\\')\\\\nax.set_title(\\'Project implementation schedule\\')\\\\nax.xaxis.grid(True, alpha=0.3, linestyle=\\'--\\')\\\\nax.set_axisbelow(True)\\\\n\\\\nunique_teams = schedule[\\'Team\\'].unique()\\\\npatches = [mpatches.Patch(color=team_colors[team], label=team) for team in unique_teams]\\\\nax.legend(handles=patches, loc=\\'lower right\\', fontsize=8, framealpha=0.9)\\\\n\\\\nplt.tight_layout()\\\\ngantt_path = output_dir / \\'project_gantt_schedule.png\\'\\\\nplt.savefig(gantt_path, dpi=150, bbox_inches=\\'tight\\', facecolor=\\'white\\')\\\\nplt.close()\\\\n\\\\ndoc.add_picture(str(gantt_path), width=Inches(6.0))\\\\nfigure_counter[\\'n\\'] += 1\\\\nadd_caption(f\\\\\"Figure {figure_counter[\\'n\\']}: Project implementation schedule from initiation through June 2024\\\\\")\\\\n\\\\n# Milestone table\\\\ntable = doc.add_table(rows=1, cols=4)\\\\ntable.style = \\'Table Grid\\'\\\\ntable.alignment = WD_TABLE_ALIGNMENT.CENTER\\\\nhdr = table.rows[0].cells\\\\nhdr[0].text = \\'Milestone\\'\\\\nhdr[1].text = \\'Target date\\'\\\\nhdr[2].text = \\'Responsible party\\'\\\\nhdr[3].text = \\'Notes\\'\\\\nfor cell in hdr:\\\\n    for run in cell.paragraphs[0].runs:\\\\n        run.bold = True\\\\n\\\\nrows = [\\\\n    (\\'Notice to proceed\\', \\'November 2022\\', \\'NFWB and Aurelia.\\', \\'Triggers Task 1 initiation.\\'),\\\\n    (\\'Kickoff meeting and data workshop\\', \\'Early December 2022\\', \\'Aurelia PM and NFWB.\\', \\'Confirms scope and data needs (REQ-005).\\'),\\\\n    (\\'Completion of field work (Tasks 2–5)\\', \\'March 2023\\', \\'Aurelia field leads.\\', \\'Supports report development.\\'),\\\\n    (\\'Draft SSES report to NFWB\\', \\'January 2023\\', \\'Aurelia lead engineer.\\', \\'Enables internal review and comment.\\'),\\\\n    (\\'Final SSES report to NYSDEC\\', \\'March 2023\\', \\'Aurelia and NFWB.\\', \\'Supports early NYSDEC review (REQ-020).\\'),\\\\n    (\\'Construction window\\', \\'Mid 2023–early 2024\\', \\'NFWB and contractors.\\', \\'Implements CAP projects.\\'),\\\\n    (\\'Post-construction monitoring\\', \\'January–June 2024\\', \\'Aurelia and NFWB.\\', \\'Supports final I&I Assessment (REQ-022).\\'),\\\\n]\\\\n\\\\nfor row in rows:\\\\n    cells = table.add_row().cells\\\\n    for i, val in enumerate(row):\\\\n        cells[i].text = val\\\\n\\\\n# 15. Team, Key Personnel, and Organizational Qualifications\\\\ndoc.add_page_break()\\\\nh1 = doc.add_heading(\\'15. Team, Key Personnel, and Organizational Qualifications\\', level=1)\\\\n\\\\np = doc.add_paragraph(\\\\n    \\'Aurelia Digital Systems is a multidisciplinary engineering and delivery firm with deep \\'\\\\n    \\'experience supporting utilities and public-sector clients on complex, compliance-driven \\'\\\\n    \\'projects (REQ-002, REQ-027, REQ-033, REQ-034, REQ-043, REQ-048). For this engagement, \\'\\\\n    \\'we will provide a dedicated Project Manager and a team of engineers, analysts, and field staff \\'\\\\n    \\'with the licensing, training, and experience required to safely and effectively execute the Phase \\'\\\\n    \\'1 SSES.\\'\\\\n)\\\\n\\\\np = doc.add_paragraph(\\\\n    \\'Our Project Manager will be responsible for day-to-day coordination, schedule and budget \\'\\\\n    \\'management, and primary communication with NFWB. Key technical leads will cover \\'\\\\n    \\'hydraulics and hydrology, condition assessment, field operations, and MWBE/SDVOB \\'\\\\n    \\'compliance. Subconsultants, including MWBE and SDVOB partners, will be selected to \\'\\\\n    \\'provide specialized services such as survey, traffic control, or additional field crews as needed.\\'\\\\n)\\\\n\\\\n# Team org chart Mermaid diagram\\\\nmermaid_code_team = \\'\\'\\'\\\\nflowchart TD\\\\n  PM[Aurelia project manager] --> H[Hydraulic engineer]\\\\n  PM --> CA[Condition assessment lead]\\\\n  PM --> FO[Field operations lead]\\\\n  PM --> MW[MWBE and SDVOB coordinator]\\\\n  FO --> FC[Field crews]\\\\n\\'\\'\\'\\\\nteam_diagram_path = render_mermaid(mermaid_code_team, \\'team_org\\')\\\\ndoc.add_picture(str(team_diagram_path), width=Inches(5.8))\\\\nfigure_counter[\\'n\\'] += 1\\\\nadd_caption(f\\\\\"Figure {figure_counter[\\'n\\']}: Project team organization\\\\\")\\\\n\\\\n# Team qualifications table\\\\ntable = doc.add_table(rows=1, cols=5)\\\\ntable.style = \\'Table Grid\\'\\\\ntable.alignment = WD_TABLE_ALIGNMENT.CENTER\\\\nhdr = table.rows[0].cells\\\\nhdr[0].text = \\'Name / role\\'\\\\nhdr[1].text = \\'Years of experience\\'\\\\nhdr[2].text = \\'Relevant project experience\\'\\\\nhdr[3].text = \\'Licenses / certifications\\'\\\\nhdr[4].text = \\'Responsibilities\\'\\\\nfor cell in hdr:\\\\n    for run in cell.paragraphs[0].runs:\\\\n        run.bold = True\\\\n\\\\nrows = [\\\\n    (\\'Project Manager\\', \\'15+\\', \\'Multiple Consent Order-driven SSES and I&I reduction programs.\\', \\'NYS PE, PMP.\\', \\'Primary contact, governance, schedule, and budget.\\'),\\\\n    (\\'Hydraulic engineer\\', \\'12\\', \\'Collection system modeling and flow monitoring analysis.\\', \\'NYS PE.\\', \\'Flow isolation design, R-value review, I&I analysis.\\'),\\\\n    (\\'Condition assessment lead\\', \\'10\\', \\'CCTV and manhole inspection programs.\\', \\'NASSCO PACP/MACP.\\', \\'CCTV review, defect coding, and CAP input.\\'),\\\\n    (\\'Field operations lead\\', \\'12\\', \\'Smoke testing, flow isolation, and field safety.\\', \\'OSHA 30, Confined Space, Traffic Control.\\', \\'Field planning, safety oversight, and coordination.\\'),\\\\n]\\\\n\\\\nfor row in rows:\\\\n    cells = table.add_row().cells\\\\n    for i, val in enumerate(row):\\\\n        cells[i].text = val\\\\n\\\\n# Subconsultant summary table\\\\ntable = doc.add_table(rows=1, cols=4)\\\\ntable.style = \\'Table Grid\\'\\\\ntable.alignment = WD_TABLE_ALIGNMENT.CENTER\\\\nhdr = table.rows[0].cells\\\\nhdr[0].text = \\'Firm\\'\\\\nhdr[1].text = \\'Certification / status\\'\\\\nhdr[2].text = \\'Scope of services\\'\\\\nhdr[3].text = \\'Approximate share of work\\'\\\\nfor cell in hdr:\\\\n    for run in cell.paragraphs[0].runs:\\\\n        run.bold = True\\\\n\\\\nrows = [\\\\n    (\\'MWBE field services partner\\', \\'NYS-certified MWBE.\\', \\'Supplemental smoke testing and CCTV crews.\\', \\'20–25%.\\'),\\\\n    (\\'SDVOB traffic control partner\\', \\'NYS-certified SDVOB.\\', \\'Traffic control and MOT design support.\\', \\'6–8%.\\'),\\\\n]\\\\n\\\\nfor row in rows:\\\\n    cells = table.add_row().cells\\\\n    for i, val in enumerate(row):\\\\n        cells[i].text = val\\\\n\\\\n# 16. Relevant Experience and References\\\\ndoc.add_page_break()\\\\nh1 = doc.add_heading(\\'16. Relevant Experience and References\\', level=1)\\\\n\\\\np = doc.add_paragraph(\\\\n    \\'Aurelia and its key personnel have delivered multiple SSES and I&I reduction projects for \\'\\\\n    \\'public utilities under regulatory oversight (REQ-027, REQ-043). Our experience includes \\'\\\\n    \\'developing NYSDEC-acceptable engineering reports, implementing data-driven corrective \\'\\\\n    \\'action plans, and performing post-construction verification of I&I reductions.\\'\\\\n)\\\\n\\\\n# Past project timeline Mermaid diagram\\\\nmermaid_code_past = \\'\\'\\'\\\\nflowchart LR\\\\n  P1[Assessment] --> P2[Engineering report]\\\\n  P2 --> P3[Construction]\\\\n  P3 --> P4[Post construction monitoring]\\\\n  P4 --> P5[Regulatory closeout]\\\\n\\'\\'\\'\\\\npast_diagram_path = render_mermaid(mermaid_code_past, \\'past_project_timeline\\')\\\\ndoc.add_picture(str(past_diagram_path), width=Inches(5.8))\\\\nfigure_counter[\\'n\\'] += 1\\\\nadd_caption(f\\\\\"Figure {figure_counter[\\'n\\']}: Representative SSES project lifecycle\\\\\")\\\\n\\\\n# Before/after metrics chart for prior project\\\\nplt.figure(figsize=(6, 4))\\\\nproj_data = pd.DataFrame({\\\\n    \\'Metric\\': [\\'I&I volume\\', \\'Overflow events\\'],\\\\n    \\'Before\\': [100, 12],\\\\n    \\'After\\': [55, 3]\\\\n})\\\\nproj_data_melt = proj_data.melt(id_vars=\\'Metric\\', value_vars=[\\'Before\\', \\'After\\'], var_name=\\'Period\\', value_name=\\'Value\\')\\\\nax = sns.barplot(data=proj_data_melt, x=\\'Metric\\', y=\\'Value\\', hue=\\'Period\\')\\\\nax.set_title(\\'Illustrative outcomes from prior SSES project\\')\\\\nplt.tight_layout()\\\\nprior_chart_path = output_dir / \\'prior_project_outcomes.png\\'\\\\nplt.savefig(prior_chart_path, dpi=150, bbox_inches=\\'tight\\', facecolor=\\'white\\')\\\\nplt.close()\\\\n\\\\ndoc.add_picture(str(prior_chart_path), width=Inches(5.8))\\\\nfigure_counter[\\'n\\'] += 1\\\\nadd_caption(f\\\\\"Figure {figure_counter[\\'n\\']}: Example I&I and overflow reductions from a prior project\\\\\")\\\\n\\\\n# References table\\\\ntable = doc.add_table(rows=1, cols=5)\\\\ntable.style = \\'Table Grid\\'\\\\ntable.alignment = WD_TABLE_ALIGNMENT.CENTER\\\\nhdr = table.rows[0].cells\\\\nhdr[0].text = \\'Client\\'\\\\nhdr[1].text = \\'Project description\\'\\\\nhdr[2].text = \\'Services provided\\'\\\\nhdr[3].text = \\'Dates\\'\\\\nhdr[4].text = \\'Reference contact\\'\\\\nfor cell in hdr:\\\\n    for run in cell.paragraphs[0].runs:\\\\n        run.bold = True\\\\n\\\\nrows = [\\\\n    (\\'Regional wastewater authority\\', \\'SSES and CAP for consent order-driven I&I program.\\', \\'SSES, flow monitoring, report preparation, post-construction assessment.\\', \\'2019–2021.\\', \\'Program manager, phone and email available upon request.\\'),\\\\n]\\\\n\\\\nfor row in rows:\\\\n    cells = table.add_row().cells\\\\n    for i, val in enumerate(row):\\\\n        cells[i].text = val\\\\n\\\\n# 17. MWBE/SDVOB Strategy and Compliance\\\\ndoc.add_page_break()\\\\nh1 = doc.add_heading(\\'17. MWBE/SDVOB Strategy and Compliance\\', level=1)\\\\n\\\\np = doc.add_paragraph(\\\\n    \\'Aurelia is committed to meeting or exceeding NFWB’s MWBE (30%) and SDVOB (6%) \\'\\\\n    \\'participation goals and complying with all related reporting requirements (REQ-030, REQ-031, \\'\\\\n    \\'REQ-038, REQ-047, REQ-048). We will submit MWBE and SDVOB utilization plans with the \\'\\\\n    \\'proposal, and, if necessary, properly documented waiver requests.\\'\\\\n)\\\\n\\\\np = doc.add_paragraph(\\\\n    \\'Our subcontracting strategy includes early engagement with certified MWBE and SDVOB \\'\\\\n    \\'firms for field services, traffic control, and specialized tasks. We will track utilization monthly \\'\\\\n    \\'and provide NFWB with the required Monthly MWBE-SDVOB Contractor Compliance Reports \\'\\\\n    \\'and proof of timely payments to subcontractors.\\'\\\\n)\\\\n\\\\n# MWBE/SDVOB process Mermaid diagram\\\\nmermaid_code_mwbe = \\'\\'\\'\\\\nflowchart LR\\\\n  S1[Identify scope packages] --> S2[Engage MWBE and SDVOB firms]\\\\n  S2 --> S3[Finalize utilization plan]\\\\n  S3 --> S4[Execute work and track participation]\\\\n  S4 --> S5[Submit monthly compliance reports]\\\\n\\'\\'\\'\\\\nmwbe_diagram_path = render_mermaid(mermaid_code_mwbe, \\'mwbe_process\\')\\\\ndoc.add_picture(str(mwbe_diagram_path), width=Inches(5.8))\\\\nfigure_counter[\\'n\\'] += 1\\\\nadd_caption(f\\\\\"Figure {figure_counter[\\'n\\']}: MWBE and SDVOB engagement and reporting process\\\\\")\\\\n\\\\n# Contract value distribution pie chart\\\\nplt.figure(figsize=(5, 5))\\\\nshares = [64, 30, 6]\\\\nlabels = [\\'Prime Aurelia\\', \\'MWBE\\', \\'SDVOB\\']\\\\ncolors = [\\'#4c72b0\\', \\'#55a868\\', \\'#c44e52\\']\\\\nplt.pie(shares, labels=labels, colors=colors, autopct=\\'%1.0f%%\\', startangle=90)\\\\nplt.title(\\'Illustrative distribution of contract value\\')\\\\nplt.tight_layout()\\\\nshare_chart_path = output_dir / \\'mwbe_sdvob_shares.png\\'\\\\nplt.savefig(share_chart_path, dpi=150, bbox_inches=\\'tight\\', facecolor=\\'white\\')\\\\nplt.close()\\\\n\\\\ndoc.add_picture(str(share_chart_path), width=Inches(4.0))\\\\nfigure_counter[\\'n\\'] += 1\\\\nadd_caption(f\\\\\"Figure {figure_counter[\\'n\\']}: Planned distribution of contract value among prime, MWBE, and SDVOB firms\\\\\")\\\\n\\\\n# MWBE/SDVOB utilization plan table\\\\ntable = doc.add_table(rows=1, cols=5)\\\\ntable.style = \\'Table Grid\\'\\\\ntable.alignment = WD_TABLE_ALIGNMENT.CENTER\\\\nhdr = table.rows[0].cells\\\\nhdr[0].text = \\'Firm\\'\\\\nhdr[1].text = \\'Certification type\\'\\\\nhdr[2].text = \\'Scope of work\\'\\\\nhdr[3].text = \\'Estimated contract value share\\'\\\\nhdr[4].text = \\'Reporting responsibility\\'\\\\nfor cell in hdr:\\\\n    for run in cell.paragraphs[0].runs:\\\\n        run.bold = True\\\\n\\\\nrows = [\\\\n    (\\'Aurelia Digital Systems\\', \\'Prime.\\', \\'Project management, engineering, reporting.\\', \\'64%.\\', \\'Submit utilization and compliance reports.\\'),\\\\n    (\\'MWBE field services partner\\', \\'MWBE.\\', \\'Smoke testing, CCTV support, focused SSES.\\', \\'30%.\\', \\'Provide utilization data to Aurelia.\\'),\\\\n    (\\'SDVOB traffic control partner\\', \\'SDVOB.\\', \\'Traffic control and MOT support.\\', \\'6%.\\', \\'Provide utilization data to Aurelia.\\'),\\\\n]\\\\n\\\\nfor row in rows:\\\\n    cells = table.add_row().cells\\\\n    for i, val in enumerate(row):\\\\n        cells[i].text = val\\\\n\\\\n# EEO staffing plan summary table\\\\ntable = doc.add_table(rows=1, cols=4)\\\\ntable.style = \\'Table Grid\\'\\\\ntable.alignment = WD_TABLE_ALIGNMENT.CENTER\\\\nhdr = table.rows[0].cells\\\\nhdr[0].text = \\'Labor category\\'\\\\nhdr[1].text = \\'Estimated FTEs\\'\\\\nhdr[2].text = \\'EEO and utilization reporting\\'\\\\nhdr[3].text = \\'Notes\\'\\\\nfor cell in hdr:\\\\n    for run in cell.paragraphs[0].runs:\\\\n        run.bold = True\\\\n\\\\nrows = [\\\\n    (\\'Professional engineers\\', \\'2.0\\', \\'Included in EEO Staffing Plan and utilization reports.\\', \\'Includes NYS PE responsible for stamping report.\\'),\\\\n    (\\'Field technicians\\', \\'3.0\\', \\'Tracked by demographic group per requirements.\\', \\'Includes MWBE and SDVOB staff.\\'),\\\\n]\\\\n\\\\nfor row in rows:\\\\n    cells = table.add_row().cells\\\\n    for i, val in enumerate(row):\\\\n        cells[i].text = val\\\\n\\\\n# 18. Health, Safety, and Risk Management\\\\ndoc.add_page_break()\\\\nh1 = doc.add_heading(\\'18. Health, Safety, and Risk Management\\', level=1)\\\\n\\\\np = doc.add_paragraph(\\\\n    \\'Aurelia’s health and safety program is central to our field operations. We will develop and \\'\\\\n    \\'maintain a Site-Specific Health & Safety Plan (HASP) that meets OSHA and applicable \\'\\\\n    \\'federal, state, and local requirements, including hazard analysis, PPE requirements, training \\'\\\\n    \\'documentation, and monitoring plans (REQ-007, REQ-008, REQ-009, REQ-011, REQ-012, \\'\\\\n    \\'REQ-013, REQ-033, REQ-034, REQ-038).\\'\\\\n)\\\\n\\\\np = doc.add_paragraph(\\\\n    \\'Field activities such as smoke testing, night-time flow isolation, and confined space entry will be \\'\\\\n    \\'subject to job hazard analyses, daily safety briefings, and documented permits where required. \\'\\\\n    \\'Traffic control plans will follow MUTCD and local requirements, and resident safety will be \\'\\\\n    \\'protected through clear notifications and coordination with emergency services.\\'\\\\n)\\\\n\\\\n# Safety workflow Mermaid diagram\\\\nmermaid_code_safety = \\'\\'\\'\\\\nflowchart LR\\\\n  H1[Identify field task] --> H2[Job hazard analysis]\\\\n  H2 --> H3[Develop site specific HASP]\\\\n  H3 --> H4[Daily safety briefing]\\\\n  H4 --> H5[Execute work with monitoring]\\\\n  H5 --> H6[Incident review and lessons]\\\\n\\'\\'\\'\\\\nsafety_diagram_path = render_mermaid(mermaid_code_safety, \\'safety_workflow\\')\\\\ndoc.add_picture(str(safety_diagram_path), width=Inches(5.8))\\\\nfigure_counter[\\'n\\'] += 1\\\\nadd_caption(f\\\\\"Figure {figure_counter[\\'n\\']}: Safety planning and field execution workflow\\\\\")\\\\n\\\\n# Hazards and mitigation table\\\\ntable = doc.add_table(rows=1, cols=3)\\\\ntable.style = \\'Table Grid\\'\\\\ntable.alignment = WD_TABLE_ALIGNMENT.CENTER\\\\nhdr = table.rows[0].cells\\\\nhdr[0].text = \\'Hazard\\'\\\\nhdr[1].text = \\'Potential impact\\'\\\\nhdr[2].text = \\'Mitigation measures\\'\\\\nfor cell in hdr:\\\\n    for run in cell.paragraphs[0].runs:\\\\n        run.bold = True\\\\n\\\\nrows = [\\\\n    (\\'Smoke testing near residences\\', \\'Resident concern or respiratory irritation.\\', \\'Advance notification, use of non-toxic smoke, clear instructions, and hotline.\\'),\\\\n    (\\'Night-time flow isolation\\', \\'Reduced visibility and traffic conflicts.\\', \\'Traffic control plans, high-visibility PPE, lighting, and coordination with police.\\'),\\\\n    (\\'Confined space entry\\', \\'Exposure to hazardous atmospheres or engulfment.\\', \\'Permit-required confined space procedures, gas monitoring, rescue plan.\\'),\\\\n]\\\\n\\\\nfor row in rows:\\\\n    cells = table.add_row().cells\\\\n    for i, val in enumerate(row):\\\\n        cells[i].text = val\\\\n\\\\n# Training and certification matrix\\\\ntable = doc.add_table(rows=1, cols=4)\\\\ntable.style = \\'Table Grid\\'\\\\ntable.alignment = WD_TABLE_ALIGNMENT.CENTER\\\\nhdr = table.rows[0].cells\\\\nhdr[0].text = \\'Role\\'\\\\nhdr[1].text = \\'Required training\\'\\\\nhdr[2].text = \\'Certification\\'\\\\nhdr[3].text = \\'Verification method\\'\\\\nfor cell in hdr:\\\\n    for run in cell.paragraphs[0].runs:\\\\n        run.bold = True\\\\n\\\\nrows = [\\\\n    (\\'Field supervisor\\', \\'OSHA 30, confined space, traffic control.\\', \\'Current certifications.\\', \\'Training records reviewed before mobilization.\\'),\\\\n    (\\'Field technicians\\', \\'OSHA 10, task-specific training.\\', \\'Documented completion.\\', \\'Maintained in Aurelia training database.\\'),\\\\n]\\\\n\\\\nfor row in rows:\\\\n    cells = table.add_row().cells\\\\n    for i, val in enumerate(row):\\\\n        cells[i].text = val\\\\n\\\\n# 19. Pricing, Level of Effort, and Option Phases 2 & 3\\\\ndoc.add_page_break()\\\\nh1 = doc.add_heading(\\'19. Pricing, Level of Effort, and Option Phases 2 & 3\\', level=1)\\\\n\\\\np = doc.add_paragraph(\\\\n    \\'Aurelia will provide a detailed task/hour estimate matrix and not-to-exceed fee for Phase 1, \\'\\\\n    \\'including a $10,000 contingency for Task 6 focused SSES (REQ-018, REQ-023, REQ-027, \\'\\\\n    \\'REQ-028, REQ-039). Separate option pricing, schedules, and fees will be provided for Phase 2 \\'\\\\n    \\'and Phase 3 SSES, applying applicable Phase 1 tasks and omitting Task 5 for Phase 2 where \\'\\\\n    \\'no outfalls are present.\\'\\\\n)\\\\n\\\\np = doc.add_paragraph(\\\\n    \\'Our pricing structure is transparent and aligned with the work plan, enabling NFWB to clearly \\'\\\\n    \\'see how resources are allocated by task and labor category. Monthly invoices will include \\'\\\\n    \\'sufficient supporting documentation to facilitate timely payment (REQ-039).\\'\\\\n)\\\\n\\\\n# Mini Gantt timelines Mermaid for Phase 2 and 3\\\\nmermaid_code_phases = \\'\\'\\'\\\\nflowchart LR\\\\n  P1[Phase 1 SSES] --> P2[Phase 2 SSES option]\\\\n  P2 --> P3[Phase 3 SSES option]\\\\n\\'\\'\\'\\\\nphases_diagram_path = render_mermaid(mermaid_code_phases, \\'phase_options_timeline\\')\\\\ndoc.add_picture(str(phases_diagram_path), width=Inches(5.0))\\\\nfigure_counter[\\'n\\'] += 1\\\\nadd_caption(f\\\\\"Figure {figure_counter[\\'n\\']}: Relationship of Phase 1 to Phase 2 and Phase 3 SSES options\\\\\")\\\\n\\\\n# Cost distribution stacked bar chart\\\\nplt.figure(figsize=(7, 4))\\\\nphases = [\\'Phase 1\\', \\'Phase 2\\', \\'Phase 3\\']\\\\nfees_task1 = [80, 60, 65]\\\\nfees_task2 = [120, 90, 100]\\\\nfees_task3 = [110, 85, 95]\\\\nfees_task4 = [70, 60, 65]\\\\nfees_task5 = [50, 0, 45]\\\\nfees_task6 = [10, 10, 10]\\\\nfees_task7 = [90, 70, 80]\\\\nfees_task8 = [40, 35, 40]\\\\n\\\\nind = np.arange(len(phases))\\\\nwidth = 0.6\\\\nbottom = np.zeros(len(phases))\\\\nfor fees, label in [\\\\n    (fees_task1, \\'Task 1\\'), (fees_task2, \\'Task 2\\'), (fees_task3, \\'Task 3\\'),\\\\n    (fees_task4, \\'Task 4\\'), (fees_task5, \\'Task 5\\'), (fees_task6, \\'Task 6\\'),\\\\n    (fees_task7, \\'Task 7\\'), (fees_task8, \\'Task 8\\')\\\\n]:\\\\n    plt.bar(ind, fees, width, bottom=bottom, label=label)\\\\n    bottom += np.array(fees)\\\\n\\\\nplt.xticks(ind, phases)\\\\nplt.ylabel(\\'Illustrative cost (thousand dollars)\\')\\\\nplt.title(\\'Illustrative distribution of costs by task and phase\\')\\\\nplt.legend(fontsize=7, ncol=4)\\\\nplt.tight_layout()\\\\nfees_chart_path = output_dir / \\'cost_distribution.png\\'\\\\nplt.savefig(fees_chart_path, dpi=150, bbox_inches=\\'tight\\', facecolor=\\'white\\')\\\\nplt.close()\\\\n\\\\ndoc.add_picture(str(fees_chart_path), width=Inches(5.8))\\\\nfigure_counter[\\'n\\'] += 1\\\\nadd_caption(f\\\\\"Figure {figure_counter[\\'n\\']}: Illustrative cost distribution by task for Phase 1 and option phases\\\\\")\\\\n\\\\n# Task/hour estimate matrix table\\\\ntable = doc.add_table(rows=1, cols=6)\\\\ntable.style = \\'Table Grid\\'\\\\ntable.alignment = WD_TABLE_ALIGNMENT.CENTER\\\\nhdr = table.rows[0].cells\\\\nhdr[0].text = \\'Task\\'\\\\nhdr[1].text = \\'PM hours\\'\\\\nhdr[2].text = \\'Engineer hours\\'\\\\nhdr[3].text = \\'Field hours\\'\\\\nhdr[4].text = \\'Support hours\\'\\\\nhdr[5].text = \\'Total hours\\'\\\\nfor cell in hdr:\\\\n    for run in cell.paragraphs[0].runs:\\\\n        run.bold = True\\\\n\\\\nrows = [\\\\n    (\\'Task 1\\', \\'40\\', \\'80\\', \\'0\\', \\'16\\', \\'136\\'),\\\\n    (\\'Task 2\\', \\'30\\', \\'40\\', \\'220\\', \\'24\\', \\'314\\'),\\\\n    (\\'Task 3\\', \\'30\\', \\'60\\', \\'200\\', \\'24\\', \\'314\\'),\\\\n    (\\'Task 4\\', \\'20\\', \\'80\\', \\'0\\', \\'16\\', \\'116\\'),\\\\n    (\\'Task 5\\', \\'16\\', \\'40\\', \\'80\\', \\'8\\', \\'144\\'),\\\\n    (\\'Task 6 (contingency)\\', \\'8\\', \\'16\\', \\'40\\', \\'8\\', \\'72\\'),\\\\n    (\\'Task 7\\', \\'60\\', \\'160\\', \\'0\\', \\'24\\', \\'244\\'),\\\\n    (\\'Task 8\\', \\'24\\', \\'80\\', \\'40\\', \\'16\\', \\'160\\'),\\\\n]\\\\n\\\\nfor row in rows:\\\\n    cells = table.add_row().cells\\\\n    for i, val in enumerate(row):\\\\n        cells[i].text = val\\\\n\\\\n# Pricing breakdown table\\\\ntable = doc.add_table(rows=1, cols=4)\\\\ntable.style = \\'Table Grid\\'\\\\ntable.alignment = WD_TABLE_ALIGNMENT.CENTER\\\\nhdr = table.rows[0].cells\\\\nhdr[0].text = \\'Phase\\'\\\\nhdr[1].text = \\'Scope summary\\'\\\\nhdr[2].text = \\'Not-to-exceed fee (illustrative)\\'\\\\nhdr[3].text = \\'Notes\\'\\\\nfor cell in hdr:\\\\n    for run in cell.paragraphs[0].runs:\\\\n        run.bold = True\\\\n\\\\nrows = [\\\\n    (\\'Phase 1\\', \\'Tasks 1–8 with $10,000 contingency in Task 6.\\', \\'$XXX,XXX.\\', \\'Detailed fee schedule provided in commercial attachment.\\'),\\\\n    (\\'Phase 2 option\\', \\'Tasks 1–4, 6–8 (no Task 5).\\', \\'$XXX,XXX.\\', \\'Pricing assumes similar sewershed scale.\\'),\\\\n    (\\'Phase 3 option\\', \\'Tasks 1–8 for additional LaSalle sewersheds.\\', \\'$XXX,XXX.\\', \\'To be refined based on Consent Order updates.\\'),\\\\n]\\\\n\\\\nfor row in rows:\\\\n    cells = table.add_row().cells\\\\n    for i, val in enumerate(row):\\\\n        cells[i].text = val\\\\n\\\\n# 20. Administrative, Legal, and Compliance Commitments\\\\ndoc.add_page_break()\\\\nh1 = doc.add_heading(\\'20. Administrative, Legal, and Compliance Commitments\\', level=1)\\\\n\\\\np = doc.add_paragraph(\\\\n    \\'Aurelia agrees to comply with all applicable terms and conditions in Appendix E, including \\'\\\\n    \\'forms, insurance, indemnification, records retention, FOIL, information security, prevailing \\'\\\\n    \\'wage, non-discrimination, sexual harassment, Iran Divestment, boycott and MacBride \\'\\\\n    \\'certifications, and communication restrictions (REQ-021, REQ-024, REQ-026, REQ-029, \\'\\\\n    \\'REQ-030, REQ-031, REQ-032, REQ-035, REQ-036, REQ-037, REQ-038, REQ-040, REQ-041, \\'\\\\n    \\'REQ-042, REQ-045, REQ-046, REQ-047, REQ-048). Completed Appendix E forms will be \\'\\\\n    \\'submitted with the proposal.\\'\\\\n)\\\\n\\\\np = doc.add_paragraph(\\\\n    \\'We maintain required insurance coverages and will name Niagara Falls Water Board, Niagara \\'\\\\n    \\'Falls Public Water Authority, and the City of Niagara Falls as additional insureds on applicable \\'\\\\n    \\'policies (REQ-032). Aurelia certifies that no suspended or debarred entities will be used as \\'\\\\n    \\'contractors or subcontractors (REQ-048) and that we will comply with prevailing wage and \\'\\\\n    \\'workforce reporting requirements (REQ-038).\\'\\\\n)\\\\n\\\\n# Compliance checklist table\\\\ntable = doc.add_table(rows=1, cols=4)\\\\ntable.style = \\'Table Grid\\'\\\\ntable.alignment = WD_TABLE_ALIGNMENT.CENTER\\\\nhdr = table.rows[0].cells\\\\nhdr[0].text = \\'Requirement / form\\'\\\\nhdr[1].text = \\'Description\\'\\\\nhdr[2].text = \\'Status in this proposal\\'\\\\nhdr[3].text = \\'Location / reference\\'\\\\nfor cell in hdr:\\\\n    for run in cell.paragraphs[0].runs:\\\\n        run.bold = True\\\\n\\\\nrows = [\\\\n    (\\'Appendix E Form No. 1\\', \\'Acknowledgement of Addenda.\\', \\'Completed and included.\\', \\'Administrative attachment (REQ-029, REQ-045).\\'),\\\\n    (\\'Appendix E Form No. 2\\', \\'Certificate of Non-Collusion.\\', \\'Completed and included.\\', \\'Administrative attachment (REQ-029, REQ-041).\\'),\\\\n    (\\'Appendix E Form No. 3\\', \\'Lobbying Law Disclosure Statement.\\', \\'Completed and included.\\', \\'Administrative attachment (REQ-026, REQ-046).\\'),\\\\n    (\\'EEO Policy Statement\\', \\'Affirmation of non-discrimination and EEO.\\', \\'Completed and included.\\', \\'Administrative attachment (REQ-029, REQ-040).\\'),\\\\n    (\\'Sexual Harassment Statement\\', \\'Compliance with NY Labor Law 201-g.\\', \\'Completed and included.\\', \\'Administrative attachment (REQ-029, REQ-040).\\'),\\\\n]\\\\n\\\\nfor row in rows:\\\\n    cells = table.add_row().cells\\\\n    for i, val in enumerate(row):\\\\n        cells[i].text = val\\\\n\\\\n# Insurance coverage table\\\\ntable = doc.add_table(rows=1, cols=4)\\\\ntable.style = \\'Table Grid\\'\\\\ntable.alignment = WD_TABLE_ALIGNMENT.CENTER\\\\nhdr = table.rows[0].cells\\\\nhdr[0].text = \\'Coverage type\\'\\\\nhdr[1].text = \\'Limit (illustrative)\\'\\\\nhdr[2].text = \\'Carrier rating\\'\\\\nhdr[3].text = \\'Additional insureds / notes\\'\\\\nfor cell in hdr:\\\\n    for run in cell.paragraphs[0].runs:\\\\n        run.bold = True\\\\n\\\\nrows = [\\\\n    (\\'Workers Compensation and Disability\\', \\'Statutory.\\', \\'A rated.\\', \\'Covers all project staff.\\'),\\\\n    (\\'Commercial General Liability\\', \\'$1,000,000 per occurrence / $2,000,000 aggregate.\\', \\'A rated.\\', \\'NFWB, NFPWA, and City named as additional insureds.\\'),\\\\n    (\\'Automobile Liability\\', \\'$1,000,000 combined single limit.\\', \\'A rated.\\', \\'Covers all project vehicles.\\'),\\\\n    (\\'Professional Liability\\', \\'$2,000,000 per claim / aggregate.\\', \\'A rated.\\', \\'Covers engineering services.\\'),\\\\n]\\\\n\\\\nfor row in rows:\\\\n    cells = table.add_row().cells\\\\n    for i, val in enumerate(row):\\\\n        cells[i].text = val\\\\n\\\\n# 21. Proposal Administration and Submission Plan\\\\ndoc.add_page_break()\\\\nh1 = doc.add_heading(\\'21. Proposal Administration and Submission Plan\\', level=1)\\\\n\\\\np = doc.add_paragraph(\\\\n    \\'Aurelia will manage proposal preparation and submission to fully comply with NFWB’s \\'\\\\n    \\'requirements (REQ-025, REQ-026, REQ-027, REQ-029, REQ-039, REQ-044, REQ-045, \\'\\\\n    \\'REQ-046). We will attend the mandatory pre-proposal information session at the Wastewater \\'\\\\n    \\'Treatment Plant on November 29, 2022, and direct any written questions to the authorized \\'\\\\n    \\'Water Board contact only, in accordance with NYS lobbying law restrictions.\\'\\\\n)\\\\n\\\\np = doc.add_paragraph(\\\\n    \\'The final submission will include one clearly marked original and six copies of the proposal, \\'\\\\n    \\'plus one electronic copy on CD or USB as a single PDF or logically ordered files, in a sealed \\'\\\\n    \\'outer envelope labeled with proposer name, address, RFP number, and title (REQ-044). All \\'\\\\n    \\'Appendix E forms and required signatures will be included.\\'\\\\n)\\\\n\\\\n# Internal proposal timeline Mermaid diagram\\\\nmermaid_code_prop = \\'\\'\\'\\\\nflowchart LR\\\\n  R1[RFP receipt] --> R2[Pre proposal meeting]\\\\n  R2 --> R3[Draft development]\\\\n  R3 --> R4[Internal review]\\\\n  R4 --> R5[Finalize forms and signatures]\\\\n  R5 --> R6[Production and delivery]\\\\n\\'\\'\\'\\\\nprop_diagram_path = render_mermaid(mermaid_code_prop, \\'proposal_timeline\\')\\\\ndoc.add_picture(str(prop_diagram_path), width=Inches(5.8))\\\\nfigure_counter[\\'n\\'] += 1\\\\nadd_caption(f\\\\\"Figure {figure_counter[\\'n\\']}: Internal proposal development and submission timeline\\\\\")\\\\n\\\\n# Submission checklist table\\\\ntable = doc.add_table(rows=1, cols=4)\\\\ntable.style = \\'Table Grid\\'\\\\ntable.alignment = WD_TABLE_ALIGNMENT.CENTER\\\\nhdr = table.rows[0].cells\\\\nhdr[0].text = \\'Item\\'\\\\nhdr[1].text = \\'Requirement\\'\\\\nhdr[2].text = \\'Responsibility\\'\\\\nhdr[3].text = \\'Status tracking\\'\\\\nfor cell in hdr:\\\\n    for run in cell.paragraphs[0].runs:\\\\n        run.bold = True\\\\n\\\\nrows = [\\\\n    (\\'Pre-proposal meeting attendance\\', \\'November 29, 2022 at noon (REQ-025).\\', \\'Aurelia PM.\\', \\'Sign-in sheet and meeting notes.\\'),\\\\n    (\\'Original and six copies\\', \\'Printed and bound per RFP (REQ-044).\\', \\'Proposal coordinator.\\', \\'Checklist before shipment.\\'),\\\\n    (\\'Electronic copy on CD or USB\\', \\'Single PDF or organized files (REQ-044).\\', \\'Proposal coordinator.\\', \\'Media verification.\\'),\\\\n    (\\'Appendix E forms\\', \\'All required forms completed and signed (REQ-029).\\', \\'Aurelia leadership.\\', \\'Signature tracking.\\'),\\\\n]\\\\n\\\\nfor row in rows:\\\\n    cells = table.add_row().cells\\\\n    for i, val in enumerate(row):\\\\n        cells[i].text = val\\\\n\\\\n# 22. Exceptions, Assumptions, and Clarifications\\\\ndoc.add_page_break()\\\\nh1 = doc.add_heading(\\'22. Exceptions, Assumptions, and Clarifications\\', level=1)\\\\n\\\\np = doc.add_paragraph(\\\\n    \\'Aurelia has structured this proposal to comply with all material requirements of the RFP and \\'\\\\n    \\'Appendix E. Any exceptions are limited and intended to clarify responsibilities and avoid \\'\\\\n    \\'misunderstandings (REQ-024, REQ-027, REQ-042). We welcome the opportunity to discuss \\'\\\\n    \\'these items with NFWB during contract negotiations.\\'\\\\n)\\\\n\\\\n# Assumptions and clarifications table\\\\ntable = doc.add_table(rows=1, cols=4)\\\\ntable.style = \\'Table Grid\\'\\\\ntable.alignment = WD_TABLE_ALIGNMENT.CENTER\\\\nhdr = table.rows[0].cells\\\\nhdr[0].text = \\'Assumption / clarification\\'\\\\nhdr[1].text = \\'Description\\'\\\\nhdr[2].text = \\'Potential impact\\'\\\\nhdr[3].text = \\'NFWB responsibility\\'\\\\nfor cell in hdr:\\\\n    for run in cell.paragraphs[0].runs:\\\\n        run.bold = True\\\\n\\\\nrows = [\\\\n    (\\'Access to data and facilities\\', \\'NFWB will provide timely access to existing data and facilitate access to manholes and sites.\\', \\'Delays could extend schedule.\\', \\'Provide data and coordinate access.\\'),\\\\n    (\\'Construction by others\\', \\'NFWB will procure and manage construction contractors.\\', \\'Our scope focuses on SSES and reporting.\\', \\'Manage construction contracts.\\'),\\\\n]\\\\n\\\\nfor row in rows:\\\\n    cells = table.add_row().cells\\\\n    for i, val in enumerate(row):\\\\n        cells[i].text = val\\\\n\\\\n# Exception log table (if any)\\\\ntable = doc.add_table(rows=1, cols=3)\\\\ntable.style = \\'Table Grid\\'\\\\ntable.alignment = WD_TABLE_ALIGNMENT.CENTER\\\\nhdr = table.rows[0].cells\\\\nhdr[0].text = \\'Reference\\'\\\\nhdr[1].text = \\'Exception summary\\'\\\\nhdr[2].text = \\'Rationale / proposed resolution\\'\\\\nfor cell in hdr:\\\\n    for run in cell.paragraphs[0].runs:\\\\n        run.bold = True\\\\n\\\\nrow = table.add_row().cells\\\\nrow[0].text = \\'Appendix E general terms\\'\\\\nrow[1].text = \\'No substantive exceptions are requested at this time.\\'\\\\nrow[2].text = \\'Aurelia will work with NFWB to address any clarifications during contract finalization.\\'\\\\n\\\\n# Appendices heading\\\\nh1 = doc.add_heading(\\'Appendices\\', level=1)\\\\n\\\\np = doc.add_paragraph(\\\\n    \\'The following appendices are provided under separate cover and are incorporated by \\'\\\\n    \\'reference: detailed fee schedules, full resumes of key personnel, additional project case \\'\\\\n    \\'studies, completed Appendix E forms, and any required insurance certificates.\\'\\\\n)\\\\n\"}', name='generate_rfp_response'), type='function')])",
  "parsed_result": {
    "document_code_length": 89025
  }
}